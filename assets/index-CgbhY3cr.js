(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Xt=["low","medium","high"];let Qt=null,K=[],$=null,he="medium",Pe=null,H=null,_e=null,je=null;function Bn(o){Qt=o}function jt(o){Pe=o}function gs(o){H=o}function Ei(o){_e=o}function xi(o){je=o}function In(o){$=o}function Si(o){he=o}function en(o){K=o}function Z(o){return K.find(e=>e.id===o)}function yt(o){const e=K.findIndex(t=>t.id===o.id);e>-1?K[e]=o:K.unshift(o)}function Gn(o,e){const t=Z(o);t&&(t.readingProgress=e,t.updatedAt=Date.now(),yt(t))}function ys(o,e,t){if(!$)return;const n=Z($);n&&(n.analyzedSentences[o]||(n.analyzedSentences[o]={}),n.analyzedSentences[o][t]=e,n.updatedAt=Date.now(),yt(n))}function vs(o){K=K.filter(e=>e.id!==o)}function Cs(){K=[]}function Ts(){if(!("speechSynthesis"in window)){document.body.classList.remove("tts-available");return}const o=()=>{const e=window.speechSynthesis.getVoices().filter(s=>s.lang==="ja-JP");if(e.length===0){Bn(null),document.body.classList.remove("tts-available");return}const t=e.find(s=>s.name.includes("Google")),n=e.find(s=>!s.localService),i=t||n||e[0]||null;Bn(i),document.body.classList.toggle("tts-available",!!i)};o(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=o)}function _s(o){if(!("speechSynthesis"in window)||!Qt){console.warn("Speech synthesis not available or no Japanese voice found.");return}window.speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(o);e.voice=Qt,e.lang="ja-JP",e.rate=.9,e.pitch=1,window.speechSynthesis.speak(e)}const Me=document.getElementById("generate-button"),fe=document.getElementById("sentence-input"),Te=document.getElementById("text-title-input"),le=document.getElementById("result-container"),De=document.querySelector(".input-area"),Bt=document.getElementById("main-view"),z=document.getElementById("reader-view"),G=document.getElementById("analysis-view"),q=document.getElementById("reading-mode-view"),Ze=document.getElementById("theme-checkbox"),Le=document.getElementById("furigana-checkbox"),be=document.getElementById("color-coding-checkbox"),et=document.getElementById("pitch-accent-checkbox"),W=document.getElementById("tooltip"),tn=document.getElementById("settings-button"),ze=document.getElementById("settings-menu"),vt=document.getElementById("analysis-depth-slider"),An=document.getElementById("analysis-depth-label"),Ct=document.getElementById("font-size-slider"),wn=document.getElementById("font-size-label"),Mn=document.getElementById("app-header"),Ii=document.getElementById("new-text-button"),Ai=document.getElementById("history-button"),nn=document.getElementById("history-panel"),ct=document.getElementById("history-panel-overlay"),wi=document.getElementById("close-history-button"),kn=document.getElementById("clear-history-button"),Tt=document.getElementById("history-list"),Mi=document.getElementById("history-empty-message"),ki=document.getElementById("export-data-button"),Es=document.getElementById("import-data-button"),dt=document.getElementById("import-file-input"),Re=document.getElementById("api-key-input"),Ri=document.getElementById("save-api-key-button"),de=document.getElementById("api-key-status"),Ve=document.getElementById("modal-overlay"),Gt=document.getElementById("modal-box"),Rn=document.getElementById("modal-message"),pe=document.getElementById("modal-confirm-button"),tt=document.getElementById("modal-cancel-button");if(!Me||!fe||!Te||!le||!De||!Bt||!z||!G||!q||!Ze||!Le||!be||!et||!W||!tn||!ze||!Ii||!Ai||!nn||!wi||!kn||!Tt||!Mi||!ct||!vt||!An||!Ct||!wn||!ki||!Es||!dt||!Re||!Ri||!de||!Ve||!Gt||!Rn||!pe||!tt||!Mn)throw new Error("Required HTML elements not found at startup.");let ae=null,Ni;function Ue(){W.classList.add("opacity-0","invisible","pointer-events-none"),ae&&(ae.classList.remove("tooltip-active"),ae=null)}const Pi=()=>clearTimeout(Ni),On=()=>{Ni=window.setTimeout(Ue,300)};function Di(o){Pi();const{reading:e,english:t,patterns:n,category:i,wordUrl:s}=o.dataset;let l="",u="";if(i){const h=i.replace(/_/g," ").split("-").map(g=>g.charAt(0).toUpperCase()+g.slice(1).toLowerCase()).join(", ");u+=`<p class="text-xs text-neutral-600 dark:text-neutral-400"><strong class="font-medium text-neutral-800 dark:text-neutral-200">Category:</strong> ${h}</p>`}if(u+=`<p class="text-xs text-neutral-600 dark:text-neutral-400 mt-1"><strong class="font-medium text-neutral-800 dark:text-neutral-200">Reading:</strong> ${e||"N/A"}</p>`,u+=`<p class="text-xs text-neutral-600 dark:text-neutral-400 mt-1"><strong class="font-medium text-neutral-800 dark:text-neutral-200">English:</strong> ${t||"N/A"}</p>`,s&&s.includes("http")&&(u+=`<div class="mt-2"><a href="${s}" target="_blank" rel="noopener noreferrer" class="text-xs font-semibold text-sky-600 dark:text-sky-400 hover:underline inline-flex items-center gap-1">Search on Jisho <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div>`),u&&(l+=`<div class="mb-3"><h4 class="text-sm font-semibold border-b border-neutral-200 dark:border-neutral-700 pb-1 mb-1">Word Info</h4>${u}</div>`),n)try{JSON.parse(n).forEach(h=>{l+=`<div class="mb-2 last:mb-0"><div class="flex items-center gap-2 mb-1"><span class="flex-shrink-0 w-3 h-3 rounded-sm ${h.colorClass}"></span><h4 class="font-semibold text-sky-600 dark:text-sky-400">${h.name}</h4></div><p class="text-xs text-neutral-600 dark:text-neutral-400">${h.explanation}</p></div>`})}catch(h){console.error("Failed to parse patterns JSON",h)}if(!l){Ue();return}W.innerHTML=l,W.style.visibility="hidden",W.classList.remove("opacity-0","invisible","pointer-events-none");const d=o.getBoundingClientRect(),c=W.getBoundingClientRect(),f=10;let p=d.left+d.width/2-c.width/2;p<f&&(p=f),p+c.width>window.innerWidth-f&&(p=window.innerWidth-c.width-f);let m=d.top-c.height-10;m<f&&(m=d.bottom+10),W.style.left=`${p}px`,W.style.top=`${m}px`,W.style.visibility="visible"}function xs(o){ae&&ae.classList.remove("tooltip-active"),ae=o,ae.classList.add("tooltip-active"),Di(o)}function Ss(o){return ae===o}function at(){return ae!==null}function Is(){le.addEventListener("mouseover",o=>{if(at())return;const e=o.target.closest(".segment");e&&Di(e)}),le.addEventListener("mouseout",o=>{at()||o.target.closest(".segment")&&On()}),document.addEventListener("click",o=>{if(!at())return;const e=o.target.closest(".segment"),t=W.contains(o.target);!e&&!t&&Ue()}),W.addEventListener("mouseover",Pi),W.addEventListener("mouseout",()=>{at()||On()})}let Ne=null,ft=null;function Li(){Ve.classList.add("opacity-0","invisible"),Gt.classList.add("scale-95","opacity-0"),Ne=null,ft=null}function As(){Ne==null||Ne(),Li()}function qn(){ft==null||ft(),Li()}function ws(){pe.addEventListener("click",As),tt.addEventListener("click",qn),Ve.addEventListener("click",o=>{o.target===Ve&&qn()})}function on(o,e,t={}){var n;Rn.textContent=o,Ne=e,pe.textContent=t.confirmText||"Confirm",pe.className="px-4 py-2 rounded-md text-sm font-medium text-white transition ",pe.classList.add(...((n=t.confirmClass)==null?void 0:n.split(" "))||["bg-red-600","hover:bg-red-700"]),tt.textContent=t.cancelText||"Cancel",tt.classList.remove("hidden"),Ve.classList.remove("opacity-0","invisible"),Gt.classList.remove("scale-95","opacity-0")}function Hn(o,e){Rn.textContent=o,Ne=null,pe.textContent="OK",pe.className="px-4 py-2 rounded-md text-sm font-medium text-white transition ",pe.classList.add("bg-sky-600","hover:bg-sky-700"),tt.classList.add("hidden"),Ve.classList.remove("opacity-0","invisible"),Gt.classList.remove("scale-95","opacity-0")}const Kt=[{light:"#2563eb",dark:"#60a5fa"},{light:"#059669",dark:"#34d399"},{light:"#d97706",dark:"#fbbf24"},{light:"#7c3aed",dark:"#a78bfa"},{light:"#db2777",dark:"#f472b6"},{light:"#0d9488",dark:"#2dd4bf"},{light:"#dc2626",dark:"#f87171"},{light:"#4338ca",dark:"#818cf8"},{light:"#0891b2",dark:"#22d3ee"},{light:"#c026d3",dark:"#e879f9"},{light:"#ea580c",dark:"#fb923c"},{light:"#475569",dark:"#94a3b8"}];function Ms(o){const e=(o||"unknown").split(/[-_]/)[0].toLowerCase(),t={noun:"bg-indigo-100 dark:bg-indigo-900/60 text-indigo-800 dark:text-indigo-200",verb:"bg-sky-100 dark:bg-sky-900/60 text-sky-800 dark:text-sky-200",particle:"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300",adjective:"bg-violet-100 dark:bg-violet-900/60 text-violet-800 dark:text-violet-200",adverb:"bg-teal-100 dark:bg-teal-900/60 text-teal-800 dark:text-teal-200",auxiliary:"bg-cyan-100 dark:bg-cyan-900/60 text-cyan-800 dark:text-cyan-200",grammatical:"bg-cyan-100 dark:bg-cyan-900/60 text-cyan-800 dark:text-cyan-200",conjunction:"bg-fuchsia-100 dark:bg-fuchsia-900/60 text-fuchsia-800 dark:text-fuchsia-200",punctuation:"bg-transparent",unknown:"bg-neutral-100 dark:bg-neutral-700"};return t[e]||t.unknown}function $n(o){return o.split("").map(e=>/[一-龯]/.test(e)?`<a href="https://jisho.org/search/${encodeURIComponent(e)}%20%23kanji" target="_blank" rel="noopener noreferrer" class="underline decoration-neutral-400/50 decoration-1 underline-offset-2 hover:text-sky-500 hover:decoration-sky-500 transition">${e}</a>`:e).join("")}function bi(o,e,t){if(!e||o===e)return t?$n(o):o;const n=o.match(/([一-龯]+|[^一-龯]+)/g)||[];let i=0,s="";for(let l=0;l<n.length;l++){const u=n[l];if(/[一-龯]/.test(u)){let c="";const f=l+1<n.length&&!/[一-龯]/.test(n[l+1])?n[l+1]:"",p=f?e.indexOf(f,i):-1;p!==-1?(c=e.substring(i,p),i=p):(c=e.substring(i),i=e.length);const m=t?$n(u):u;s+=c&&c!==u?`<ruby>${m}<rt class="text-xs text-neutral-500 select-none">${c}</rt></ruby>`:m}else s+=u,e.substring(i).startsWith(u)&&(i+=u.length)}return s}function ks(o,e){if(!o||!e||o.length!==e.length)return null;const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("class","pitch-accent-svg absolute top-0 left-0 w-full h-[14px] overflow-visible pointer-events-none");const i=e.split("").map((s,l)=>({x:100/o.length*(l+.5),y:s==="H"?2:8}));if(i.length>1){const s=document.createElementNS(t,"polyline");s.setAttribute("points",i.map(l=>`${l.x},${l.y}`).join(" ")),s.setAttribute("class","fill-none stroke-neutral-500 dark:stroke-neutral-400"),s.setAttribute("stroke-width","1.5"),s.setAttribute("stroke-linecap","round"),s.setAttribute("stroke-linejoin","round"),n.appendChild(s)}return i.forEach(s=>{const l=document.createElementNS(t,"circle");l.setAttribute("cx",String(s.x)),l.setAttribute("cy",String(s.y)),l.setAttribute("r","1.2"),l.setAttribute("class","fill-neutral-500 dark:fill-neutral-400"),n.appendChild(l)}),n.setAttribute("viewBox","0 0 100 10"),n.setAttribute("preserveAspectRatio","none"),n}function Rs(o,e){return`
    <div role="alert" class="p-4 bg-red-50 dark:bg-red-900/30 border-l-4 border-red-500 dark:border-red-600 rounded-r-lg shadow-md my-4 transition-all duration-300">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-red-500 dark:text-red-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3 flex-1">
          <p class="text-sm font-semibold text-red-800 dark:text-red-200">${o}</p>
          ${e?`<div class="mt-2 text-sm text-red-700 dark:text-red-300"><p>${e}</p></div>`:""}
        </div>
      </div>
    </div>
  `}function nt(o,e,t={}){var u,d;const{stickyTopClass:n="top-0"}=t;o.innerHTML="";const i=[],s=document.createElement("div");s.className=`sticky ${n} z-10 bg-white dark:bg-slate-900 transition-colors duration-300 pt-2 rounded-b-lg`,o.appendChild(s);const l=document.createElement("div");if(l.className="px-4 pt-14 md:pt-8 pb-4",o.appendChild(l),((u=e.analysis)==null?void 0:u.length)>0){const c=document.createElement("div");c.className="p-4 bg-slate-100 dark:bg-slate-800 rounded-lg max-h-[50vh] overflow-y-auto";const f=document.createElement("div");f.className="flex-grow flex flex-wrap items-center gap-x-1.5 gap-y-1 text-2xl",e.analysis.forEach(g=>{const y=document.createElement("span");if(y.className=`segment relative inline-block rounded-md px-2 py-1 cursor-pointer transition-transform duration-200 hover:-translate-y-0.5 leading-loose ${Ms(g.category)}`,y.dataset.reading=g.reading,y.dataset.english=g.english_equivalent,y.dataset.category=g.category,y.dataset.wordUrl=`https://jisho.org/search/${encodeURIComponent(g.japanese_segment)}`,g.category!=="PUNCTUATION"){const x=ks(g.reading,g.pitch_accent);x&&y.appendChild(x)}const C=document.createElement("div");C.innerHTML=bi(g.japanese_segment,g.reading,!0),y.appendChild(C),f.appendChild(y),i.push(y)});const p=document.createElement("div");p.className="flex items-center gap-1.5 ml-2 self-center";const m=document.createElement("button");m.className="tts-button inline-flex items-center justify-center w-8 h-8 rounded-full bg-white dark:bg-neutral-700 text-sky-600 dark:text-sky-400 hover:bg-sky-100 dark:hover:bg-sky-600 dark:hover:text-white transition align-middle",m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg>',m.title="Read sentence aloud (S)",m.onclick=g=>{g.preventDefault(),_s(e.original_japanese_sentence)};const h=document.createElement("kbd");h.className="hidden sm:inline font-sans text-xs font-semibold text-neutral-500 dark:text-neutral-400 border border-neutral-300 dark:border-neutral-600 rounded px-1.5 py-0.5",h.textContent="S",p.append(m,h),f.appendChild(p),c.appendChild(f),s.appendChild(c)}if(e.english_translation){const c=document.createElement("div"),f=document.createElement("div");f.className="bg-slate-50 dark:bg-slate-800/60 p-4 rounded-lg";const p=document.createElement("div");p.className="flex justify-between items-center";const m=document.createElement("h3");m.className="text-base font-semibold text-neutral-800 dark:text-neutral-200",m.textContent="English Translation";const h=document.createElement("button");h.id="toggle-translation-button",h.className="text-xs font-semibold px-2 py-1 rounded-md border border-neutral-400 dark:border-neutral-500 text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition inline-flex items-center gap-1.5",h.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
          <span class="button-text">Show</span>
          <kbd class="ml-1 font-sans text-xs font-semibold text-neutral-500 dark:text-neutral-400 border border-neutral-300 dark:border-neutral-600 rounded px-1.5 py-0.5">T</kbd>
      `,h.setAttribute("aria-controls","translation-content"),h.setAttribute("aria-expanded","false"),h.title="Toggle translation visibility (Hotkey: T)",p.append(m,h);const g=document.createElement("div");g.id="translation-content",g.className="hidden mt-3 pt-3 border-t border-dashed border-neutral-200 dark:border-neutral-700",g.innerHTML=`<p class="text-base italic text-neutral-700 dark:text-neutral-300">${e.english_translation}</p>`,f.append(p,g),c.appendChild(f),l.appendChild(c)}if(((d=e.grammar_patterns)==null?void 0:d.length)>0){const c=document.createElement("div");c.className="mt-6",c.innerHTML='<h3 class="text-base font-semibold border-b border-neutral-200 dark:border-neutral-700 pb-2 mb-3">Grammar & Vocabulary Notes</h3>';const f=document.createElement("ul");f.className="flex flex-col gap-3";const p=new Map,m=document.documentElement.classList.contains("dark");e.grammar_patterns.forEach((g,y)=>{var R;const C=y%Kt.length,x=`p-${C}`,w={name:g.pattern_name,explanation:g.explanation,colorClass:`bg-pattern-${C}`,idClass:x,underlineColor:m?Kt[C].dark:Kt[C].light};(R=g.constituent_indices)==null||R.forEach(N=>{p.has(N)||p.set(N,[]),p.get(N).push(w)});const M=document.createElement("li");M.className="flex gap-4 p-4 rounded-lg bg-slate-50 dark:bg-slate-800/60 cursor-pointer transition-all duration-200",M.dataset.patternId=x,M.innerHTML=`
          <span class="flex-shrink-0 w-1.5 rounded-full bg-pattern-${C}"></span>
          <div class="flex-grow">
              <strong class="font-semibold text-sky-700 dark:text-sky-400">${g.pattern_name}</strong>
              <p class="text-sm text-neutral-600 dark:text-neutral-400 mt-1">${g.explanation}</p>
              <button class="show-examples-button mt-3 text-xs font-semibold px-2 py-1 rounded-md border border-sky-500 text-sky-600 dark:text-sky-400 hover:bg-sky-500 hover:text-white dark:hover:text-neutral-900 transition inline-flex items-center gap-2 disabled:opacity-50" data-pattern-name="${g.pattern_name}">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
                </svg>
                <span class="button-text">Examples</span>
              </button>
          </div>
      `,f.appendChild(M)}),p.forEach((g,y)=>{const C=i[y];if(C&&g.length>0){C.dataset.patterns=JSON.stringify(g.map(({name:R,explanation:N,colorClass:F})=>({name:R,explanation:N,colorClass:F})));const x=2,w=3;C.style.paddingBottom=`${4+g.length*x+(g.length-1)*w}px`;const M=g.map(R=>`linear-gradient(to top, ${R.underlineColor} 0%, ${R.underlineColor} 100%)`);C.style.backgroundImage=M.join(", "),C.style.backgroundSize=g.map(()=>`100% ${x}px`).join(", "),C.style.backgroundPosition=g.map((R,N)=>`0 calc(100% - ${N*(x+w)}px)`).join(", "),C.style.backgroundRepeat="no-repeat",C.classList.add("grammar-pattern",...g.map(R=>R.idClass))}}),c.appendChild(f);const h=document.createElement("p");h.className="text-xs text-center text-neutral-500 dark:text-neutral-400 mt-4 px-4",h.innerHTML='Tip: Use <kbd class="font-sans border rounded px-1.5 py-0.5">J</kbd>/<kbd class="font-sans border rounded px-1.5 py-0.5">K</kbd> to navigate patterns, <kbd class="font-sans border rounded px-1.5 py-0.5">E</kbd> for examples, and <kbd class="font-sans border rounded px-1.5 py-0.5">Esc</kbd> to clear focus.',c.appendChild(h),l.appendChild(c)}}function Ot(o){z.innerHTML="",H&&(H.classList.add("opacity-0","invisible","translate-y-5"),H.classList.remove("transform")),_e&&(_e.disconnect(),Ei(null)),je&&(window.removeEventListener("scroll",je),xi(null));const t=o.text.split(`
`).map(c=>{var f;return((f=c.match(/[^。？！\s]+[。？！]?/g))==null?void 0:f.filter(p=>p==null?void 0:p.trim()))||[]}),n=t.flat();if(!(n.length>0))return;const s=document.createElement("div");z.appendChild(s);const l=document.createElement("div");l.className="flex justify-between items-center mb-4";const u=document.createElement("h2");if(u.className="text-xl font-bold text-neutral-800 dark:text-neutral-200",u.textContent=o.title,l.appendChild(u),n.length>0){const c=document.createElement("div");c.className="flex items-center gap-2";const f=document.createElement("button");f.id="edit-text-button",f.className="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-neutral-900 focus:ring-sky-500 transition-colors",f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-neutral-600 dark:text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>',f.title="Edit this text",c.appendChild(f);const p=document.createElement("button");p.id="start-reading-button",p.title="Start Reading Mode",p.className="inline-flex items-center justify-center p-2.5 rounded-full text-white bg-sky-600 hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-neutral-900 focus:ring-sky-500 dark:bg-sky-500 dark:hover:bg-sky-600 dark:text-neutral-900 shadow-sm",p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>',c.appendChild(p),l.appendChild(c)}s.appendChild(l);const d=document.createElement("div");d.className="bg-neutral-50 dark:bg-neutral-800/40 border border-neutral-200 dark:border-neutral-700 rounded-lg p-4 sm:p-6 max-h-80 overflow-y-auto",t.forEach(c=>{const f=document.createElement("p");f.className="text-lg sm:text-xl leading-relaxed",c.length>0?c.forEach(p=>{var g;const m=document.createElement("span");m.className="clickable-sentence cursor-pointer rounded p-1 -m-1 transition-colors duration-200 hover:bg-sky-100 dark:hover:bg-sky-500/20",!!((g=o.analyzedSentences[p])!=null&&g[he])?(m.classList.add("text-sky-700","dark:text-sky-400"),m.title="Analyzed. Click to view."):m.title="Click to analyze.",m.textContent=p,m.dataset.sentence=p,f.append(m," ")}):f.innerHTML="&nbsp;",d.appendChild(f)}),s.appendChild(d)}function Ns(o,e,t){q.innerHTML="",q.className="";const i=o.text.split(`
`).flatMap(d=>{var c;return((c=d.match(/[^。？！\s]+[。？！]?/g))==null?void 0:c.filter(f=>f==null?void 0:f.trim()))||[]}).length,s=document.createElement("header");s.className="fixed top-0 left-0 right-0 z-20 border-b border-slate-200 dark:border-slate-800 bg-gradient-to-r from-slate-50 to-white dark:from-slate-900 dark:to-slate-800 duration-300";const l=document.createElement("div");l.className="max-w-4xl mx-auto flex items-center justify-between p-2",l.innerHTML=`
        <button id="reading-mode-exit" title="Exit Reading Mode" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-600 dark:text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
        </button>
        <div class="font-medium text-neutral-700 dark:text-neutral-300 flex items-center gap-1">
            <input type="number" id="reading-mode-sentence-input" value="${e+1}" min="1" max="${i}" title="Enter sentence number and press Enter" class="w-12 text-center bg-neutral-200 dark:bg-neutral-700 rounded-md p-1 focus:ring-2 focus:ring-sky-500 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
            <span>/ ${i}</span>
        </div>
        <div class="flex items-center gap-2">
            <button id="reading-nav-prev" title="Previous Sentence (←)" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 disabled:opacity-30 disabled:cursor-not-allowed" ${e===0?"disabled":""}>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <button id="reading-nav-next" title="Next Sentence (→)" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 disabled:opacity-30 disabled:cursor-not-allowed" ${e>=i-1?"disabled":""}>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>
    `,s.appendChild(l),q.appendChild(s);const u=document.createElement("div");nt(u,t,{stickyTopClass:"top-14"}),q.appendChild(u)}function Ps(o,e,t="Loading analysis..."){q.innerHTML="",q.className="";const n=document.createElement("header");n.className="fixed top-0 left-0 right-0 z-20 border-b border-neutral-200/50 dark:border-neutral-700/50 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-sm transition-colors duration-300";const i=document.createElement("div");i.className="max-w-4xl mx-auto flex items-center justify-between p-4",i.innerHTML=`
        <button id="reading-mode-exit" title="Exit Reading Mode" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-600 dark:text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
        </button>
        <div class="font-medium text-neutral-700 dark:text-neutral-300 flex items-center gap-1">
            <input type="number" id="reading-mode-sentence-input" value="${o+1}" min="1" max="${e}" title="Enter sentence number and press Enter" class="w-12 text-center bg-neutral-200 dark:bg-neutral-700 rounded-md p-1 focus:ring-2 focus:ring-sky-500 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none" disabled>
            <span>/ ${e}</span>
        </div>
        <div class="flex items-center gap-2">
            <button id="reading-nav-prev" title="Previous Sentence (←)" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 disabled:opacity-30 disabled:cursor-not-allowed" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <button id="reading-nav-next" title="Next Sentence (→)" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-800 disabled:opacity-30 disabled:cursor-not-allowed" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>
    `,n.appendChild(i),q.appendChild(n);const s=document.createElement("div");s.style.paddingTop="4.5625rem",s.innerHTML=`
        <div class="flex flex-col items-center justify-center p-16 text-neutral-500">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-neutral-500 mb-4"></div>
            <p>${t}</p>
        </div>
    `,q.appendChild(s)}function Fe(){Tt.innerHTML="";const o=K;Mi.classList.toggle("hidden",o.length>0),kn.classList.toggle("hidden",o.length===0),o.forEach(e=>{const t=document.createElement("li");t.className="text-entry-item group p-4 hover:bg-neutral-100 dark:hover:bg-neutral-700/50 transition-colors flex justify-between items-center";const n=document.createElement("div");n.className="flex-grow pr-4 truncate cursor-pointer",n.dataset.action="load",n.dataset.entryId=e.id;const i=document.createElement("span");i.className="font-medium text-sm pointer-events-none",i.textContent=e.title,i.title=e.title;const s=document.createElement("span");s.className="block text-xs text-neutral-500 dark:text-neutral-400 mt-1 pointer-events-none",s.textContent=`Updated: ${new Date(e.updatedAt).toLocaleString()}`,n.append(i,s);const l=document.createElement("div");l.className="flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0";const u=document.createElement("button");u.className="p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-800 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200",u.title="Delete Text",u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>',u.dataset.action="delete",u.dataset.entryId=e.id,l.append(u),t.append(n,l),Tt.appendChild(t)})}function oe(){const o=!Le.checked,e=!et.checked,t=!be.checked;le.classList.toggle("color-coding-disabled",t),document.querySelectorAll("#result-container rt").forEach(n=>n.classList.toggle("hidden",o)),document.querySelectorAll("#result-container .pitch-accent-svg").forEach(n=>n.classList.toggle("hidden",e)),document.querySelectorAll("#result-container .segment").forEach(n=>{n.classList.toggle("pt-[18px]",!e),n.classList.toggle("pt-1",e)})}function it(){const o=fe.value.trim().length>0,e=!!Pe;Me.disabled=!o||!e,e?o?Me.title="":Me.title="Please enter some text to process.":Me.title="Please set your Gemini API key in the settings menu."}function Vi(){Bt.classList.remove("hidden"),q.classList.add("hidden"),Mn.classList.remove("hidden")}function Ds(){Bt.classList.add("hidden"),q.classList.remove("hidden"),Mn.classList.add("hidden")}function Nn(o){const e=o.message||"";return e.includes("429")||e.includes("RESOURCE_EXHAUSTED")?{main:"The request to the AI model was rate-limited.",detail:"This can happen if you process very large texts or make many requests in a short period. The app tried to retry automatically but was unsuccessful. Please wait a moment before trying again."}:e.includes("API key not valid")?{main:"The Gemini API key is not valid.",detail:"Please check the key in the settings menu. Make sure it has been copied correctly and is enabled for use."}:e.includes("timed out")?{main:"The request to the AI model timed out.",detail:"This could be due to a temporary network issue or the model taking too long to respond. Please try again in a moment."}:e.includes("GoogleGenAI")||e.includes("Request failed with status code")?{main:"An unexpected API error occurred.",detail:e}:{main:e}}function _t(){Te.value="",fe.value="",Vi(),De.classList.remove("hidden"),z.innerHTML="",G.innerHTML="",In(null),Ue(),it()}var L;(function(o){o.assertEqual=i=>{};function e(i){}o.assertIs=e;function t(i){throw new Error}o.assertNever=t,o.arrayToEnum=i=>{const s={};for(const l of i)s[l]=l;return s},o.getValidEnumValues=i=>{const s=o.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),l={};for(const u of s)l[u]=i[u];return o.objectValues(l)},o.objectValues=i=>o.objectKeys(i).map(function(s){return i[s]}),o.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&s.push(l);return s},o.find=(i,s)=>{for(const l of i)if(s(l))return l},o.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(s)}o.joinValues=n,o.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(L||(L={}));var Jn;(function(o){o.mergeShapes=(e,t)=>({...e,...t})})(Jn||(Jn={}));const _=L.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ce=o=>{switch(typeof o){case"undefined":return _.undefined;case"string":return _.string;case"number":return Number.isNaN(o)?_.nan:_.number;case"boolean":return _.boolean;case"function":return _.function;case"bigint":return _.bigint;case"symbol":return _.symbol;case"object":return Array.isArray(o)?_.array:o===null?_.null:o.then&&typeof o.then=="function"&&o.catch&&typeof o.catch=="function"?_.promise:typeof Map<"u"&&o instanceof Map?_.map:typeof Set<"u"&&o instanceof Set?_.set:typeof Date<"u"&&o instanceof Date?_.date:_.object;default:return _.unknown}},v=L.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ue extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const l of s.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)n._errors.push(t(l));else{let u=n,d=0;for(;d<l.path.length;){const c=l.path[d];d===l.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(t(l))):u[c]=u[c]||{_errors:[]},u=u[c],d++}}};return i(this),n}static assert(e){if(!(e instanceof ue))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,L.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ue.create=o=>new ue(o);const sn=(o,e)=>{let t;switch(o.code){case v.invalid_type:o.received===_.undefined?t="Required":t=`Expected ${o.expected}, received ${o.received}`;break;case v.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(o.expected,L.jsonStringifyReplacer)}`;break;case v.unrecognized_keys:t=`Unrecognized key(s) in object: ${L.joinValues(o.keys,", ")}`;break;case v.invalid_union:t="Invalid input";break;case v.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${L.joinValues(o.options)}`;break;case v.invalid_enum_value:t=`Invalid enum value. Expected ${L.joinValues(o.options)}, received '${o.received}'`;break;case v.invalid_arguments:t="Invalid function arguments";break;case v.invalid_return_type:t="Invalid function return type";break;case v.invalid_date:t="Invalid date";break;case v.invalid_string:typeof o.validation=="object"?"includes"in o.validation?(t=`Invalid input: must include "${o.validation.includes}"`,typeof o.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${o.validation.position}`)):"startsWith"in o.validation?t=`Invalid input: must start with "${o.validation.startsWith}"`:"endsWith"in o.validation?t=`Invalid input: must end with "${o.validation.endsWith}"`:L.assertNever(o.validation):o.validation!=="regex"?t=`Invalid ${o.validation}`:t="Invalid";break;case v.too_small:o.type==="array"?t=`Array must contain ${o.exact?"exactly":o.inclusive?"at least":"more than"} ${o.minimum} element(s)`:o.type==="string"?t=`String must contain ${o.exact?"exactly":o.inclusive?"at least":"over"} ${o.minimum} character(s)`:o.type==="number"?t=`Number must be ${o.exact?"exactly equal to ":o.inclusive?"greater than or equal to ":"greater than "}${o.minimum}`:o.type==="date"?t=`Date must be ${o.exact?"exactly equal to ":o.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(o.minimum))}`:t="Invalid input";break;case v.too_big:o.type==="array"?t=`Array must contain ${o.exact?"exactly":o.inclusive?"at most":"less than"} ${o.maximum} element(s)`:o.type==="string"?t=`String must contain ${o.exact?"exactly":o.inclusive?"at most":"under"} ${o.maximum} character(s)`:o.type==="number"?t=`Number must be ${o.exact?"exactly":o.inclusive?"less than or equal to":"less than"} ${o.maximum}`:o.type==="bigint"?t=`BigInt must be ${o.exact?"exactly":o.inclusive?"less than or equal to":"less than"} ${o.maximum}`:o.type==="date"?t=`Date must be ${o.exact?"exactly":o.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(o.maximum))}`:t="Invalid input";break;case v.custom:t="Invalid input";break;case v.invalid_intersection_types:t="Intersection results could not be merged";break;case v.not_multiple_of:t=`Number must be a multiple of ${o.multipleOf}`;break;case v.not_finite:t="Number must be finite";break;default:t=e.defaultError,L.assertNever(o)}return{message:t}};let Ls=sn;function bs(){return Ls}const Vs=o=>{const{data:e,path:t,errorMaps:n,issueData:i}=o,s=[...t,...i.path||[]],l={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let u="";const d=n.filter(c=>!!c).slice().reverse();for(const c of d)u=c(l,{data:e,defaultError:u}).message;return{...i,path:s,message:u}};function T(o,e){const t=bs(),n=Vs({issueData:e,data:o.data,path:o.path,errorMaps:[o.common.contextualErrorMap,o.schemaErrorMap,t,t===sn?void 0:sn].filter(i=>!!i)});o.common.issues.push(n)}class J{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if(i.status==="aborted")return A;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const i of t){const s=await i.key,l=await i.value;n.push({key:s,value:l})}return J.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:s,value:l}=i;if(s.status==="aborted"||l.status==="aborted")return A;s.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(n[s.value]=l.value)}return{status:e.value,value:n}}}const A=Object.freeze({status:"aborted"}),Ke=o=>({status:"dirty",value:o}),X=o=>({status:"valid",value:o}),Yn=o=>o.status==="aborted",zn=o=>o.status==="dirty",Be=o=>o.status==="valid",Et=o=>typeof Promise<"u"&&o instanceof Promise;var E;(function(o){o.errToObj=e=>typeof e=="string"?{message:e}:e||{},o.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(E||(E={}));class se{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Kn=(o,e)=>{if(Be(e))return{success:!0,data:e.value};if(!o.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ue(o.common.issues);return this._error=t,this._error}}};function k(o){if(!o)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:i}=o;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(l,u)=>{const{message:d}=o;return l.code==="invalid_enum_value"?{message:d??u.defaultError}:typeof u.data>"u"?{message:d??n??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:d??t??u.defaultError}},description:i}}class P{get description(){return this._def.description}_getType(e){return ce(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new J,ctx:{common:e.parent.common,data:e.data,parsedType:ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Et(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ce(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Kn(n,i)}"~validate"(e){var n,i;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ce(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:t});return Be(s)?{value:s.value}:{issues:t.common.issues}}catch(s){(i=(n=s==null?void 0:s.message)==null?void 0:n.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(s=>Be(s)?{value:s.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ce(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(Et(i)?i:Promise.resolve(i));return Kn(n,s)}refine(e,t){const n=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const l=e(i),u=()=>s.addIssue({code:v.custom,...n(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,t){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof t=="function"?t(n,i):t),!1))}_refinement(e){return new qe({schema:this,typeName:I.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return me.create(this,this._def)}nullable(){return He.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ie.create(this)}promise(){return wt.create(this,this._def)}or(e){return St.create([this,e],this._def)}and(e){return It.create(this,e,this._def)}transform(e){return new qe({...k(this._def),schema:this,typeName:I.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new un({...k(this._def),innerType:this,defaultValue:t,typeName:I.ZodDefault})}brand(){return new sr({typeName:I.ZodBranded,type:this,...k(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new cn({...k(this._def),innerType:this,catchValue:t,typeName:I.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Pn.create(this,e)}readonly(){return dn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Us=/^c[^\s-]{8,}$/i,Fs=/^[0-9a-z]+$/,Bs=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Gs=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Os=/^[a-z0-9_-]{21}$/i,qs=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Hs=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$s=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Js="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Wt;const Ys=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,zs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ks=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ws=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Zs=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Xs=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ui="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Qs=new RegExp(`^${Ui}$`);function Fi(o){let e="[0-5]\\d";o.precision?e=`${e}\\.\\d{${o.precision}}`:o.precision==null&&(e=`${e}(\\.\\d+)?`);const t=o.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function js(o){return new RegExp(`^${Fi(o)}$`)}function er(o){let e=`${Ui}T${Fi(o)}`;const t=[];return t.push(o.local?"Z?":"Z"),o.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function tr(o,e){return!!((e==="v4"||!e)&&Ys.test(o)||(e==="v6"||!e)&&Ks.test(o))}function nr(o,e){if(!qs.test(o))return!1;try{const[t]=o.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function or(o,e){return!!((e==="v4"||!e)&&zs.test(o)||(e==="v6"||!e)&&Ws.test(o))}class ne extends P{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==_.string){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.string,received:s.parsedType}),A}const n=new J;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const l=e.data.length>s.value,u=e.data.length<s.value;(l||u)&&(i=this._getOrReturnCtx(e,i),l?T(i,{code:v.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):u&&T(i,{code:v.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")$s.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"email",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Wt||(Wt=new RegExp(Js,"u")),Wt.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"emoji",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")Gs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"uuid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Os.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"nanoid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Us.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cuid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Fs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cuid2",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Bs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"ulid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),T(i,{validation:"url",code:v.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"regex",code:v.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?er(s).test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?Qs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?js(s).test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?Hs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"duration",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?tr(e.data,s.version)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"ip",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?nr(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"jwt",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?or(e.data,s.version)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cidr",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Zs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"base64",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Xs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"base64url",code:v.invalid_string,message:s.message}),n.dirty()):L.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(i=>e.test(i),{validation:t,code:v.invalid_string,...E.errToObj(n)})}_addCheck(e){return new ne({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...E.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...E.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...E.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...E.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...E.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...E.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...E.errToObj(t)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new ne({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ne({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ne({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ne.create=o=>new ne({checks:[],typeName:I.ZodString,coerce:(o==null?void 0:o.coerce)??!1,...k(o)});function ir(o,e){const t=(o.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=t>n?t:n,s=Number.parseInt(o.toFixed(i).replace(".","")),l=Number.parseInt(e.toFixed(i).replace(".",""));return s%l/10**i}class Ee extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==_.number){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.number,received:s.parsedType}),A}let n;const i=new J;for(const s of this._def.checks)s.kind==="int"?L.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:v.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?ir(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_finite,message:s.message}),i.dirty()):L.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,n,i){return new Ee({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:E.toString(i)}]})}_addCheck(e){return new Ee({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&L.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ee.create=o=>new Ee({checks:[],typeName:I.ZodNumber,coerce:(o==null?void 0:o.coerce)||!1,...k(o)});class xe extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==_.bigint)return this._getInvalidInput(e);let n;const i=new J;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):L.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return T(t,{code:v.invalid_type,expected:_.bigint,received:t.parsedType}),A}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,n,i){return new xe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:E.toString(i)}]})}_addCheck(e){return new xe({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}xe.create=o=>new xe({checks:[],typeName:I.ZodBigInt,coerce:(o==null?void 0:o.coerce)??!1,...k(o)});class xt extends P{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==_.boolean){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.boolean,received:n.parsedType}),A}return X(e.data)}}xt.create=o=>new xt({typeName:I.ZodBoolean,coerce:(o==null?void 0:o.coerce)||!1,...k(o)});class Ge extends P{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==_.date){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.date,received:s.parsedType}),A}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_date}),A}const n=new J;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):L.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ge({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ge.create=o=>new Ge({checks:[],coerce:(o==null?void 0:o.coerce)||!1,typeName:I.ZodDate,...k(o)});class Wn extends P{_parse(e){if(this._getType(e)!==_.symbol){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.symbol,received:n.parsedType}),A}return X(e.data)}}Wn.create=o=>new Wn({typeName:I.ZodSymbol,...k(o)});class Zn extends P{_parse(e){if(this._getType(e)!==_.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.undefined,received:n.parsedType}),A}return X(e.data)}}Zn.create=o=>new Zn({typeName:I.ZodUndefined,...k(o)});class Xn extends P{_parse(e){if(this._getType(e)!==_.null){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.null,received:n.parsedType}),A}return X(e.data)}}Xn.create=o=>new Xn({typeName:I.ZodNull,...k(o)});class Qn extends P{constructor(){super(...arguments),this._any=!0}_parse(e){return X(e.data)}}Qn.create=o=>new Qn({typeName:I.ZodAny,...k(o)});class rn extends P{constructor(){super(...arguments),this._unknown=!0}_parse(e){return X(e.data)}}rn.create=o=>new rn({typeName:I.ZodUnknown,...k(o)});class ge extends P{_parse(e){const t=this._getOrReturnCtx(e);return T(t,{code:v.invalid_type,expected:_.never,received:t.parsedType}),A}}ge.create=o=>new ge({typeName:I.ZodNever,...k(o)});class jn extends P{_parse(e){if(this._getType(e)!==_.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.void,received:n.parsedType}),A}return X(e.data)}}jn.create=o=>new jn({typeName:I.ZodVoid,...k(o)});class ie extends P{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==_.array)return T(t,{code:v.invalid_type,expected:_.array,received:t.parsedType}),A;if(i.exactLength!==null){const l=t.data.length>i.exactLength.value,u=t.data.length<i.exactLength.value;(l||u)&&(T(t,{code:l?v.too_big:v.too_small,minimum:u?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(T(t,{code:v.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(T(t,{code:v.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((l,u)=>i.type._parseAsync(new se(t,l,t.path,u)))).then(l=>J.mergeArray(n,l));const s=[...t.data].map((l,u)=>i.type._parseSync(new se(t,l,t.path,u)));return J.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new ie({...this._def,minLength:{value:e,message:E.toString(t)}})}max(e,t){return new ie({...this._def,maxLength:{value:e,message:E.toString(t)}})}length(e,t){return new ie({...this._def,exactLength:{value:e,message:E.toString(t)}})}nonempty(e){return this.min(1,e)}}ie.create=(o,e)=>new ie({type:o,minLength:null,maxLength:null,exactLength:null,typeName:I.ZodArray,...k(e)});function we(o){if(o instanceof B){const e={};for(const t in o.shape){const n=o.shape[t];e[t]=me.create(we(n))}return new B({...o._def,shape:()=>e})}else return o instanceof ie?new ie({...o._def,type:we(o.element)}):o instanceof me?me.create(we(o.unwrap())):o instanceof He?He.create(we(o.unwrap())):o instanceof Se?Se.create(o.items.map(e=>we(e))):o}class B extends P{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=L.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==_.object){const c=this._getOrReturnCtx(e);return T(c,{code:v.invalid_type,expected:_.object,received:c.parsedType}),A}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof ge&&this._def.unknownKeys==="strip"))for(const c in i.data)l.includes(c)||u.push(c);const d=[];for(const c of l){const f=s[c],p=i.data[c];d.push({key:{status:"valid",value:c},value:f._parse(new se(i,p,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof ge){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of u)d.push({key:{status:"valid",value:f},value:{status:"valid",value:i.data[f]}});else if(c==="strict")u.length>0&&(T(i,{code:v.unrecognized_keys,keys:u}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of u){const p=i.data[f];d.push({key:{status:"valid",value:f},value:c._parse(new se(i,p,i.path,f)),alwaysSet:f in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of d){const p=await f.key,m=await f.value;c.push({key:p,value:m,alwaysSet:f.alwaysSet})}return c}).then(c=>J.mergeObjectSync(n,c)):J.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new B({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,l;const i=((l=(s=this._def).errorMap)==null?void 0:l.call(s,t,n).message)??n.defaultError;return t.code==="unrecognized_keys"?{message:E.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new B({...this._def,unknownKeys:"strip"})}passthrough(){return new B({...this._def,unknownKeys:"passthrough"})}extend(e){return new B({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new B({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:I.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new B({...this._def,catchall:e})}pick(e){const t={};for(const n of L.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new B({...this._def,shape:()=>t})}omit(e){const t={};for(const n of L.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new B({...this._def,shape:()=>t})}deepPartial(){return we(this)}partial(e){const t={};for(const n of L.objectKeys(this.shape)){const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}return new B({...this._def,shape:()=>t})}required(e){const t={};for(const n of L.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof me;)s=s._def.innerType;t[n]=s}return new B({...this._def,shape:()=>t})}keyof(){return Bi(L.objectKeys(this.shape))}}B.create=(o,e)=>new B({shape:()=>o,unknownKeys:"strip",catchall:ge.create(),typeName:I.ZodObject,...k(e)});B.strictCreate=(o,e)=>new B({shape:()=>o,unknownKeys:"strict",catchall:ge.create(),typeName:I.ZodObject,...k(e)});B.lazycreate=(o,e)=>new B({shape:o,unknownKeys:"strip",catchall:ge.create(),typeName:I.ZodObject,...k(e)});class St extends P{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function i(s){for(const u of s)if(u.result.status==="valid")return u.result;for(const u of s)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;const l=s.map(u=>new ue(u.ctx.common.issues));return T(t,{code:v.invalid_union,unionErrors:l}),A}if(t.common.async)return Promise.all(n.map(async s=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(i);{let s;const l=[];for(const d of n){const c={...t,common:{...t.common,issues:[]},parent:null},f=d._parseSync({data:t.data,path:t.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!s&&(s={result:f,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const u=l.map(d=>new ue(d));return T(t,{code:v.invalid_union,unionErrors:u}),A}}get options(){return this._def.options}}St.create=(o,e)=>new St({options:o,typeName:I.ZodUnion,...k(e)});function an(o,e){const t=ce(o),n=ce(e);if(o===e)return{valid:!0,data:o};if(t===_.object&&n===_.object){const i=L.objectKeys(e),s=L.objectKeys(o).filter(u=>i.indexOf(u)!==-1),l={...o,...e};for(const u of s){const d=an(o[u],e[u]);if(!d.valid)return{valid:!1};l[u]=d.data}return{valid:!0,data:l}}else if(t===_.array&&n===_.array){if(o.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<o.length;s++){const l=o[s],u=e[s],d=an(l,u);if(!d.valid)return{valid:!1};i.push(d.data)}return{valid:!0,data:i}}else return t===_.date&&n===_.date&&+o==+e?{valid:!0,data:o}:{valid:!1}}class It extends P{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(s,l)=>{if(Yn(s)||Yn(l))return A;const u=an(s.value,l.value);return u.valid?((zn(s)||zn(l))&&t.dirty(),{status:t.value,value:u.data}):(T(n,{code:v.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,l])=>i(s,l)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}It.create=(o,e,t)=>new It({left:o,right:e,typeName:I.ZodIntersection,...k(t)});class Se extends P{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.array)return T(n,{code:v.invalid_type,expected:_.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return T(n,{code:v.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(T(n,{code:v.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...n.data].map((l,u)=>{const d=this._def.items[u]||this._def.rest;return d?d._parse(new se(n,l,n.path,u)):null}).filter(l=>!!l);return n.common.async?Promise.all(s).then(l=>J.mergeArray(t,l)):J.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new Se({...this._def,rest:e})}}Se.create=(o,e)=>{if(!Array.isArray(o))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Se({items:o,typeName:I.ZodTuple,rest:null,...k(e)})};class At extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.object)return T(n,{code:v.invalid_type,expected:_.object,received:n.parsedType}),A;const i=[],s=this._def.keyType,l=this._def.valueType;for(const u in n.data)i.push({key:s._parse(new se(n,u,n.path,u)),value:l._parse(new se(n,n.data[u],n.path,u)),alwaysSet:u in n.data});return n.common.async?J.mergeObjectAsync(t,i):J.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof P?new At({keyType:e,valueType:t,typeName:I.ZodRecord,...k(n)}):new At({keyType:ne.create(),valueType:e,typeName:I.ZodRecord,...k(t)})}}class eo extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.map)return T(n,{code:v.invalid_type,expected:_.map,received:n.parsedType}),A;const i=this._def.keyType,s=this._def.valueType,l=[...n.data.entries()].map(([u,d],c)=>({key:i._parse(new se(n,u,n.path,[c,"key"])),value:s._parse(new se(n,d,n.path,[c,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const d of l){const c=await d.key,f=await d.value;if(c.status==="aborted"||f.status==="aborted")return A;(c.status==="dirty"||f.status==="dirty")&&t.dirty(),u.set(c.value,f.value)}return{status:t.value,value:u}})}else{const u=new Map;for(const d of l){const c=d.key,f=d.value;if(c.status==="aborted"||f.status==="aborted")return A;(c.status==="dirty"||f.status==="dirty")&&t.dirty(),u.set(c.value,f.value)}return{status:t.value,value:u}}}}eo.create=(o,e,t)=>new eo({valueType:e,keyType:o,typeName:I.ZodMap,...k(t)});class ot extends P{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.set)return T(n,{code:v.invalid_type,expected:_.set,received:n.parsedType}),A;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(T(n,{code:v.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(T(n,{code:v.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function l(d){const c=new Set;for(const f of d){if(f.status==="aborted")return A;f.status==="dirty"&&t.dirty(),c.add(f.value)}return{status:t.value,value:c}}const u=[...n.data.values()].map((d,c)=>s._parse(new se(n,d,n.path,c)));return n.common.async?Promise.all(u).then(d=>l(d)):l(u)}min(e,t){return new ot({...this._def,minSize:{value:e,message:E.toString(t)}})}max(e,t){return new ot({...this._def,maxSize:{value:e,message:E.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ot.create=(o,e)=>new ot({valueType:o,minSize:null,maxSize:null,typeName:I.ZodSet,...k(e)});class ln extends P{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ln.create=(o,e)=>new ln({getter:o,typeName:I.ZodLazy,...k(e)});class to extends P{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return T(t,{received:t.data,code:v.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}}to.create=(o,e)=>new to({value:o,typeName:I.ZodLiteral,...k(e)});function Bi(o,e){return new Oe({values:o,typeName:I.ZodEnum,...k(e)})}class Oe extends P{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return T(t,{expected:L.joinValues(n),received:t.parsedType,code:v.invalid_type}),A}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return T(t,{received:t.data,code:v.invalid_enum_value,options:n}),A}return X(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Oe.create(e,{...this._def,...t})}exclude(e,t=this._def){return Oe.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}Oe.create=Bi;class no extends P{_parse(e){const t=L.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==_.string&&n.parsedType!==_.number){const i=L.objectValues(t);return T(n,{expected:L.joinValues(i),received:n.parsedType,code:v.invalid_type}),A}if(this._cache||(this._cache=new Set(L.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=L.objectValues(t);return T(n,{received:n.data,code:v.invalid_enum_value,options:i}),A}return X(e.data)}get enum(){return this._def.values}}no.create=(o,e)=>new no({values:o,typeName:I.ZodNativeEnum,...k(e)});class wt extends P{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==_.promise&&t.common.async===!1)return T(t,{code:v.invalid_type,expected:_.promise,received:t.parsedType}),A;const n=t.parsedType===_.promise?t.data:Promise.resolve(t.data);return X(n.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}wt.create=(o,e)=>new wt({type:o,typeName:I.ZodPromise,...k(e)});class qe extends P{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===I.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:l=>{T(n,l),l.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const l=i.transform(n.data,s);if(n.common.async)return Promise.resolve(l).then(async u=>{if(t.value==="aborted")return A;const d=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return d.status==="aborted"?A:d.status==="dirty"||t.value==="dirty"?Ke(d.value):d});{if(t.value==="aborted")return A;const u=this._def.schema._parseSync({data:l,path:n.path,parent:n});return u.status==="aborted"?A:u.status==="dirty"||t.value==="dirty"?Ke(u.value):u}}if(i.type==="refinement"){const l=u=>{const d=i.refinement(u,s);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?A:(u.status==="dirty"&&t.dirty(),l(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?A:(u.status==="dirty"&&t.dirty(),l(u.value).then(()=>({status:t.value,value:u.value}))))}if(i.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Be(l))return A;const u=i.transform(l.value,s);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>Be(l)?Promise.resolve(i.transform(l.value,s)).then(u=>({status:t.value,value:u})):A);L.assertNever(i)}}qe.create=(o,e,t)=>new qe({schema:o,typeName:I.ZodEffects,effect:e,...k(t)});qe.createWithPreprocess=(o,e,t)=>new qe({schema:e,effect:{type:"preprocess",transform:o},typeName:I.ZodEffects,...k(t)});class me extends P{_parse(e){return this._getType(e)===_.undefined?X(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}me.create=(o,e)=>new me({innerType:o,typeName:I.ZodOptional,...k(e)});class He extends P{_parse(e){return this._getType(e)===_.null?X(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}He.create=(o,e)=>new He({innerType:o,typeName:I.ZodNullable,...k(e)});class un extends P{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===_.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}un.create=(o,e)=>new un({innerType:o,typeName:I.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...k(e)});class cn extends P{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Et(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}cn.create=(o,e)=>new cn({innerType:o,typeName:I.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...k(e)});class oo extends P{_parse(e){if(this._getType(e)!==_.nan){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.nan,received:n.parsedType}),A}return{status:"valid",value:e.data}}}oo.create=o=>new oo({typeName:I.ZodNaN,...k(o)});class sr extends P{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Pn extends P{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?A:s.status==="dirty"?(t.dirty(),Ke(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?A:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,t){return new Pn({in:e,out:t,typeName:I.ZodPipeline})}}class dn extends P{_parse(e){const t=this._def.innerType._parse(e),n=i=>(Be(i)&&(i.value=Object.freeze(i.value)),i);return Et(t)?t.then(i=>n(i)):n(t)}unwrap(){return this._def.innerType}}dn.create=(o,e)=>new dn({innerType:o,typeName:I.ZodReadonly,...k(e)});var I;(function(o){o.ZodString="ZodString",o.ZodNumber="ZodNumber",o.ZodNaN="ZodNaN",o.ZodBigInt="ZodBigInt",o.ZodBoolean="ZodBoolean",o.ZodDate="ZodDate",o.ZodSymbol="ZodSymbol",o.ZodUndefined="ZodUndefined",o.ZodNull="ZodNull",o.ZodAny="ZodAny",o.ZodUnknown="ZodUnknown",o.ZodNever="ZodNever",o.ZodVoid="ZodVoid",o.ZodArray="ZodArray",o.ZodObject="ZodObject",o.ZodUnion="ZodUnion",o.ZodDiscriminatedUnion="ZodDiscriminatedUnion",o.ZodIntersection="ZodIntersection",o.ZodTuple="ZodTuple",o.ZodRecord="ZodRecord",o.ZodMap="ZodMap",o.ZodSet="ZodSet",o.ZodFunction="ZodFunction",o.ZodLazy="ZodLazy",o.ZodLiteral="ZodLiteral",o.ZodEnum="ZodEnum",o.ZodEffects="ZodEffects",o.ZodNativeEnum="ZodNativeEnum",o.ZodOptional="ZodOptional",o.ZodNullable="ZodNullable",o.ZodDefault="ZodDefault",o.ZodCatch="ZodCatch",o.ZodPromise="ZodPromise",o.ZodBranded="ZodBranded",o.ZodPipeline="ZodPipeline",o.ZodReadonly="ZodReadonly"})(I||(I={}));const Ce=ne.create,io=Ee.create;xe.create;const rr=xt.create;Ge.create;const so=rn.create;ge.create;const We=ie.create,ar=B.create,lr=St.create;It.create;Se.create;const ur=At.create,cr=ln.create,dr=Oe.create;wt.create;me.create;He.create;const Ae={string:o=>ne.create({...o,coerce:!0}),number:o=>Ee.create({...o,coerce:!0}),boolean:o=>xt.create({...o,coerce:!0}),bigint:o=>xe.create({...o,coerce:!0}),date:o=>Ge.create({...o,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let fr,pr;function mr(){return{geminiUrl:fr,vertexUrl:pr}}function hr(o,e,t){var n,i,s;if(!(!((n=o.httpOptions)===null||n===void 0)&&n.baseUrl)){const l=mr();return o.vertexai?(i=l.vertexUrl)!==null&&i!==void 0?i:e:(s=l.geminiUrl)!==null&&s!==void 0?s:t}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class st{}function S(o,e){const t=/\{([^}]+)\}/g;return o.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(o,e,t){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in o))if(Array.isArray(t))o[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(o[u])){const d=o[u];if(Array.isArray(t))for(let c=0;c<d.length;c++){const f=d[c];a(f,e.slice(s+1),t[c])}else for(const c of d)a(c,e.slice(s+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in o||(o[u]=[{}]);const d=o[u];a(d[0],e.slice(s+1),t);return}(!o[l]||typeof o[l]!="object")&&(o[l]={}),o=o[l]}const n=e[e.length-1],i=o[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=t}function r(o,e){try{if(e.length===1&&e[0]==="_self")return o;for(let t=0;t<e.length;t++){if(typeof o!="object"||o===null)return;const n=e[t];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const s=o[i];return Array.isArray(s)?s.map(l=>r(l,e.slice(t+1))):void 0}else return}else o=o[n]}return o}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ro;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ro||(ro={}));var ao;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(ao||(ao={}));var lo;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(lo||(lo={}));var uo;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(uo||(uo={}));var co;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(co||(co={}));var te;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(te||(te={}));var fo;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(fo||(fo={}));var po;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(po||(po={}));var mo;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(mo||(mo={}));var ho;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(ho||(ho={}));var go;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(go||(go={}));var yo;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(yo||(yo={}));var vo;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(vo||(vo={}));var Mt;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(Mt||(Mt={}));var Co;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Co||(Co={}));var fn;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(fn||(fn={}));var To;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(To||(To={}));var _o;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(_o||(_o={}));var Eo;(function(o){o.UNSPECIFIED="UNSPECIFIED",o.BLOCKING="BLOCKING",o.NON_BLOCKING="NON_BLOCKING"})(Eo||(Eo={}));var xo;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(xo||(xo={}));var So;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(So||(So={}));var Io;(function(o){o.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",o.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",o.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Io||(Io={}));var Ao;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(Ao||(Ao={}));var wo;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(wo||(wo={}));var Mo;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(Mo||(Mo={}));var ko;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ko||(ko={}));var Ro;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ro||(Ro={}));var No;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(No||(No={}));var Po;(function(o){o.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",o.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",o.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",o.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",o.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",o.EDIT_MODE_STYLE="EDIT_MODE_STYLE",o.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",o.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Po||(Po={}));var Do;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(Do||(Do={}));var Lo;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(Lo||(Lo={}));var bo;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(bo||(bo={}));var Vo;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Vo||(Vo={}));var Uo;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Uo||(Uo={}));var Fo;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(Fo||(Fo={}));var Bo;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Bo||(Bo={}));var Go;(function(o){o.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",o.SILENT="SILENT",o.WHEN_IDLE="WHEN_IDLE",o.INTERRUPT="INTERRUPT"})(Go||(Go={}));var Oo;(function(o){o.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",o.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",o.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",o.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",o.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",o.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",o.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",o.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",o.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",o.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",o.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",o.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",o.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Oo||(Oo={}));var qo;(function(o){o.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",o.QUALITY="QUALITY",o.DIVERSITY="DIVERSITY"})(qo||(qo={}));var ke;(function(o){o.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",o.PLAY="PLAY",o.PAUSE="PAUSE",o.STOP="STOP",o.RESET_CONTEXT="RESET_CONTEXT"})(ke||(ke={}));class Ye{get text(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const p=[];for(const m of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[h,g]of Object.entries(m))h!=="text"&&h!=="thought"&&(g!==null||g!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,c+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const p of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(c+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,n,i,s,l,u,d,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,n,i,s,l,u,d,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class Ho{}class $o{}class gr{}class yr{}class Jo{}class Yo{}class zo{}class vr{}class Ko{}class Wo{}class Zo{}class Cr{}class pn{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Tr{}class _r{}class Er{get text(){var e,t,n;let i="",s=!1;const l=[];for(const u of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;s=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,n;let i="";const s=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&s.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class xr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V(o,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Gi(o,e){const t=V(o,e);return t?t.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:t.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${t}`:t:""}function Oi(o,e){return Array.isArray(e)?e.map(t=>kt(o,t)):[kt(o,e)]}function kt(o,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Sr(o,e){const t=kt(o,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Ir(o,e){const t=kt(o,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Xo(o,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function qi(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Xo(o,t)):[Xo(o,e)]}function mn(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function Qo(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function jo(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function Y(o,e){if(e==null)throw new Error("ContentUnion is required");return mn(e)?e:{role:"user",parts:qi(o,e)}}function Hi(o,e){if(!e)return[];if(o.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=Y(o,t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const t=Y(o,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Y(o,t)):[Y(o,e)]}function j(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Qo(e)||jo(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Y(o,e)]}const t=[],n=[],i=mn(e[0]);for(const s of e){const l=mn(s);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(s);else{if(Qo(s)||jo(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return i||t.push({role:"user",parts:qi(o,n)}),t}const ei=dr(["string","number","integer","object","array","boolean","null"]),Ar=lr([ei,We(ei)]);function wr(o=!0){const e=cr(()=>{const t=ar({type:Ar.optional(),format:Ce().optional(),title:Ce().optional(),description:Ce().optional(),default:so().optional(),items:e.optional(),minItems:Ae.string().optional(),maxItems:Ae.string().optional(),enum:We(so()).optional(),properties:ur(Ce(),e).optional(),required:We(Ce()).optional(),minProperties:Ae.string().optional(),maxProperties:Ae.string().optional(),propertyOrdering:We(Ce()).optional(),minimum:io().optional(),maximum:io().optional(),minLength:Ae.string().optional(),maxLength:Ae.string().optional(),pattern:Ce().optional(),anyOf:We(e).optional(),additionalProperties:rr().optional()});return o?t.strict():t});return e}function Mr(o,e){o.includes("null")&&(e.nullable=!0);const t=o.filter(n=>n!=="null");if(t.length===1)e.type=Object.keys(te).includes(t[0].toUpperCase())?te[t[0].toUpperCase()]:te.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.keys(te).includes(n.toUpperCase())?te[n.toUpperCase()]:te.TYPE_UNSPECIFIED})}}function Xe(o){const e={},t=["items"],n=["anyOf"],i=["properties"];if(o.type&&o.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=o.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,o=s[1]):s[1].type==="null"&&(e.nullable=!0,o=s[0])),o.type instanceof Array&&Mr(o.type,e);for(const[l,u]of Object.entries(o))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.keys(te).includes(u.toUpperCase())?u.toUpperCase():te.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Xe(u);else if(n.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push(Xe(c))}e[l]=d}else if(i.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=Xe(f);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function Rt(o,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=wr().parse(e);return Xe(t)}else return Xe(e)}function $i(o,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Ji(o,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function qt(o,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Rt(o,t.parameters)),t.response&&(t.response=Rt(o,t.response));return e}function Ht(o,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function kr(o,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return o.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${o.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function ye(o,e){if(typeof e!="string")throw new Error("name must be a string");return kr(o,e,"cachedContents")}function Yi(o,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function ve(o,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function Rr(o){return o!=null&&typeof o=="object"&&"name"in o}function Nr(o){return o!=null&&typeof o=="object"&&"video"in o}function Pr(o){return o!=null&&typeof o=="object"&&"uri"in o}function zi(o,e){var t;let n;if(Rr(e)&&(n=e.name),!(Pr(e)&&(n=e.uri,n===void 0))&&!(Nr(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ki(o,e){let t;return o.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Wi(o,e){for(const t of["models","tunedModels","publisherModels"])if(Dr(e,t))return e[t];return[]}function Dr(o,e){return o!==null&&typeof o=="object"&&e in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lr(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function br(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function Vr(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Lr(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],br(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ti(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Vr(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Ur(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function Fr(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function Br(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Fr(o,n)),t}function Gr(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function Or(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Gr(o,n)),t}function qr(){return{}}function Hr(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>Ur(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],Br(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],Or(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],qr());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function $r(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function Jr(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Yr(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],Jr(o,n)),t}function zr(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],$r(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Yr(o,i)),t}function Kr(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);t!==void 0&&s!=null&&a(t,["expireTime"],s);const l=r(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const u=r(e,["contents"]);if(t!==void 0&&u!=null){let p=j(o,u);Array.isArray(p)&&(p=p.map(m=>ti(o,m))),a(t,["contents"],p)}const d=r(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],ti(o,Y(o,d)));const c=r(e,["tools"]);if(t!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>Hr(o,m))),a(t,["tools"],p)}const f=r(e,["toolConfig"]);if(t!==void 0&&f!=null&&a(t,["toolConfig"],zr(o,f)),r(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Wr(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],Gi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Kr(o,i,t)),t}function Zr(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Xr(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Qr(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);return t!==void 0&&s!=null&&a(t,["expireTime"],s),n}function jr(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Qr(o,i,t)),t}function ea(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function ta(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],ea(o,n,t)),t}function na(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function oa(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function ia(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],na(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],oa(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ni(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>ia(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function sa(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function ra(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function aa(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],ra(o,n)),t}function la(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function ua(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],la(o,n)),t}function ca(){return{}}function da(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function fa(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],da(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function pa(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],fa(o,n)),t}function ma(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>sa(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],aa(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],ua(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],ca());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],pa(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function ha(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function ga(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function ya(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],ga(o,n)),t}function va(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],ha(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],ya(o,i)),t}function Ca(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);t!==void 0&&s!=null&&a(t,["expireTime"],s);const l=r(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const u=r(e,["contents"]);if(t!==void 0&&u!=null){let m=j(o,u);Array.isArray(m)&&(m=m.map(h=>ni(o,h))),a(t,["contents"],m)}const d=r(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],ni(o,Y(o,d)));const c=r(e,["tools"]);if(t!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>ma(o,h))),a(t,["tools"],m)}const f=r(e,["toolConfig"]);t!==void 0&&f!=null&&a(t,["toolConfig"],va(o,f));const p=r(e,["kmsKeyName"]);return t!==void 0&&p!=null&&a(t,["encryption_spec","kmsKeyName"],p),n}function Ta(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],Gi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Ca(o,i,t)),t}function _a(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Ea(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function xa(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);return t!==void 0&&s!=null&&a(t,["expireTime"],s),n}function Sa(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ye(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],xa(o,i,t)),t}function Ia(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function Aa(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Ia(o,n,t)),t}function pt(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["model"]);s!=null&&a(t,["model"],s);const l=r(e,["createTime"]);l!=null&&a(t,["createTime"],l);const u=r(e,["updateTime"]);u!=null&&a(t,["updateTime"],u);const d=r(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const c=r(e,["usageMetadata"]);return c!=null&&a(t,["usageMetadata"],c),t}function wa(){return{}}function Ma(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>pt(o,l))),a(t,["cachedContents"],s)}return t}function mt(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["model"]);s!=null&&a(t,["model"],s);const l=r(e,["createTime"]);l!=null&&a(t,["createTime"],l);const u=r(e,["updateTime"]);u!=null&&a(t,["updateTime"],u);const d=r(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const c=r(e,["usageMetadata"]);return c!=null&&a(t,["usageMetadata"],c),t}function ka(){return{}}function Ra(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>mt(o,l))),a(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $e;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})($e||($e={}));class $t{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};n?typeof n=="object"?l=Object.assign({},n):l=n:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Na extends st{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new $t($e.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ta(this.apiClient,e);return u=S("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}else{const c=Wr(this.apiClient,e);return u=S("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>pt(this.apiClient,f))}}async get(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=_a(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}else{const c=Zr(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>pt(this.apiClient,f))}}async delete(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ea(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=ka(),p=new Wo;return Object.assign(p,f),p})}else{const c=Xr(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(()=>{const f=wa(),p=new Wo;return Object.assign(p,f),p})}}async update(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Sa(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}else{const c=jr(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>pt(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Aa(this.apiClient,e);return u=S("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Ra(this.apiClient,f),m=new Zo;return Object.assign(m,p),m})}else{const c=ta(this.apiClient,e);return u=S("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Ma(this.apiClient,f),m=new Zo;return Object.assign(m,p),m})}}}function oi(o){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&o[e],n=0;if(t)return t.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(o){return this instanceof U?(this.v=o,this):new U(o)}function Qe(o,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(o,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(h){return function(g){return Promise.resolve(g).then(h,p)}}function u(h,g){n[h]&&(i[h]=function(y){return new Promise(function(C,x){s.push([h,y,C,x])>1||d(h,y)})},g&&(i[h]=g(i[h])))}function d(h,g){try{c(n[h](g))}catch(y){m(s[0][3],y)}}function c(h){h.value instanceof U?Promise.resolve(h.value.v).then(f,p):m(s[0][2],h)}function f(h){d("next",h)}function p(h){d("throw",h)}function m(h,g){h(g),s.shift(),s.length&&d(s[0][0],s[0][1])}}function ht(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=o[Symbol.asyncIterator],t;return e?e.call(o):(o=typeof oi=="function"?oi(o):o[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=o[s]&&function(l){return new Promise(function(u,d){l=o[s](l),i(u,d,l.done,l.value)})}}function i(s,l,u,d){Promise.resolve(d).then(function(c){s({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pa(o){var e;if(o.candidates==null||o.candidates.length===0)return!1;const t=(e=o.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Zi(t)}function Zi(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const e of o.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function Da(o){if(o.length!==0){for(const e of o)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function ii(o){if(o===void 0||o.length===0)return[];const e=[],t=o.length;let n=0;for(;n<t;)if(o[n].role==="user")e.push(o[n]),n++;else{const i=[];let s=!0;for(;n<t&&o[n].role==="model";)i.push(o[n]),s&&!Zi(o[n])&&(s=!1),n++;s?e.push(...i):e.pop()}return e}class La{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new ba(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ba{constructor(e,t,n,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),Da(s)}async sendMessage(e){var t;await this.sendPromise;const n=Y(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,l,u;const d=await i,c=(l=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];f!=null&&(m=(u=f.slice(p))!==null&&u!==void 0?u:[]);const h=c?[c]:[];this.recordHistory(n,h,m)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const n=Y(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,n)}getHistory(e=!1){const t=e?ii(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,i;return Qe(this,arguments,function*(){var l,u,d,c;const f=[];try{for(var p=!0,m=ht(e),h;h=yield U(m.next()),l=h.done,!l;p=!0){c=h.value,p=!1;const g=c;if(Pa(g)){const y=(i=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;y!==void 0&&f.push(y)}yield yield U(g)}}catch(g){u={error:g}}finally{try{!p&&!l&&(d=m.return)&&(yield U(d.call(m)))}finally{if(u)throw u.error}}this.recordHistory(t,f)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...ii(n)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Va(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function Ua(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Va(o,n,t)),t}function Fa(o,e){const t={},n=r(e,["details"]);n!=null&&a(t,["details"],n);const i=r(e,["message"]);i!=null&&a(t,["message"],i);const s=r(e,["code"]);return s!=null&&a(t,["code"],s),t}function Ba(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["mimeType"]);s!=null&&a(t,["mimeType"],s);const l=r(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const u=r(e,["createTime"]);u!=null&&a(t,["createTime"],u);const d=r(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const c=r(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const f=r(e,["sha256Hash"]);f!=null&&a(t,["sha256Hash"],f);const p=r(e,["uri"]);p!=null&&a(t,["uri"],p);const m=r(e,["downloadUri"]);m!=null&&a(t,["downloadUri"],m);const h=r(e,["state"]);h!=null&&a(t,["state"],h);const g=r(e,["source"]);g!=null&&a(t,["source"],g);const y=r(e,["videoMetadata"]);y!=null&&a(t,["videoMetadata"],y);const C=r(e,["error"]);return C!=null&&a(t,["error"],Fa(o,C)),t}function Ga(o,e){const t={},n=r(e,["file"]);n!=null&&a(t,["file"],Ba(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Oa(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","file"],zi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function qa(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","file"],zi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Ha(o,e){const t={},n=r(e,["details"]);n!=null&&a(t,["details"],n);const i=r(e,["message"]);i!=null&&a(t,["message"],i);const s=r(e,["code"]);return s!=null&&a(t,["code"],s),t}function hn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["mimeType"]);s!=null&&a(t,["mimeType"],s);const l=r(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const u=r(e,["createTime"]);u!=null&&a(t,["createTime"],u);const d=r(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const c=r(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const f=r(e,["sha256Hash"]);f!=null&&a(t,["sha256Hash"],f);const p=r(e,["uri"]);p!=null&&a(t,["uri"],p);const m=r(e,["downloadUri"]);m!=null&&a(t,["downloadUri"],m);const h=r(e,["state"]);h!=null&&a(t,["state"],h);const g=r(e,["source"]);g!=null&&a(t,["source"],g);const y=r(e,["videoMetadata"]);y!=null&&a(t,["videoMetadata"],y);const C=r(e,["error"]);return C!=null&&a(t,["error"],Ha(o,C)),t}function $a(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>hn(o,l))),a(t,["files"],s)}return t}function Ja(){return{}}function Ya(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class za extends st{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new $t($e.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>hn(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ua(this.apiClient,e);return s=S("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=$a(this.apiClient,d),f=new Cr;return Object.assign(f,c),f})}}async createInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ga(this.apiClient,e);return s=S("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=Ja(),c=new Tr;return Object.assign(c,d),c})}}async get(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Oa(this.apiClient,e);return s=S("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>hn(this.apiClient,d))}}async delete(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qa(this.apiClient,e);return s=S("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=Ya(),c=new _r;return Object.assign(c,d),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ka(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Wa(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Xi(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Ka(o,n)),t}function Za(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Wa(o,n)),t}function Xa(o,e){const t={},n=r(e,["speaker"]);n!=null&&a(t,["speaker"],n);const i=r(e,["voiceConfig"]);return i!=null&&a(t,["voiceConfig"],Xi(o,i)),t}function Qa(o,e){const t={},n=r(e,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Xa(o,s))),a(t,["speakerVoiceConfigs"],i)}return t}function ja(o,e){const t={},n=r(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],Xi(o,n));const i=r(e,["multiSpeakerVoiceConfig"]);i!=null&&a(t,["multiSpeakerVoiceConfig"],Qa(o,i));const s=r(e,["languageCode"]);return s!=null&&a(t,["languageCode"],s),t}function el(o,e){const t={},n=r(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],Za(o,n)),r(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=r(e,["languageCode"]);return i!=null&&a(t,["languageCode"],i),t}function tl(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function nl(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function ol(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function il(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function sl(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],tl(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],ol(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function rl(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],nl(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],il(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function al(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>sl(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ll(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>rl(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ul(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function cl(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function dl(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function fl(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function pl(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],dl(o,n)),t}function ml(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],fl(o,n)),t}function hl(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function gl(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function yl(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],hl(o,n)),t}function vl(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],gl(o,n)),t}function Cl(){return{}}function Tl(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function _l(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],Tl(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function El(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],_l(o,n)),t}function xl(){return{}}function Sl(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>ul(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],pl(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],yl(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],xl());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function Il(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>cl(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],ml(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],vl(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],Cl());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],El(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function Al(o,e){const t={},n=r(e,["handle"]);if(n!=null&&a(t,["handle"],n),r(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function wl(o,e){const t={},n=r(e,["handle"]);n!=null&&a(t,["handle"],n);const i=r(e,["transparent"]);return i!=null&&a(t,["transparent"],i),t}function si(){return{}}function ri(){return{}}function Ml(o,e){const t={},n=r(e,["disabled"]);n!=null&&a(t,["disabled"],n);const i=r(e,["startOfSpeechSensitivity"]);i!=null&&a(t,["startOfSpeechSensitivity"],i);const s=r(e,["endOfSpeechSensitivity"]);s!=null&&a(t,["endOfSpeechSensitivity"],s);const l=r(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const u=r(e,["silenceDurationMs"]);return u!=null&&a(t,["silenceDurationMs"],u),t}function kl(o,e){const t={},n=r(e,["disabled"]);n!=null&&a(t,["disabled"],n);const i=r(e,["startOfSpeechSensitivity"]);i!=null&&a(t,["startOfSpeechSensitivity"],i);const s=r(e,["endOfSpeechSensitivity"]);s!=null&&a(t,["endOfSpeechSensitivity"],s);const l=r(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const u=r(e,["silenceDurationMs"]);return u!=null&&a(t,["silenceDurationMs"],u),t}function Rl(o,e){const t={},n=r(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],Ml(o,n));const i=r(e,["activityHandling"]);i!=null&&a(t,["activityHandling"],i);const s=r(e,["turnCoverage"]);return s!=null&&a(t,["turnCoverage"],s),t}function Nl(o,e){const t={},n=r(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],kl(o,n));const i=r(e,["activityHandling"]);i!=null&&a(t,["activityHandling"],i);const s=r(e,["turnCoverage"]);return s!=null&&a(t,["turnCoverage"],s),t}function Pl(o,e){const t={},n=r(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Dl(o,e){const t={},n=r(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Ll(o,e){const t={},n=r(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const i=r(e,["slidingWindow"]);return i!=null&&a(t,["slidingWindow"],Pl(o,i)),t}function bl(o,e){const t={},n=r(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const i=r(e,["slidingWindow"]);return i!=null&&a(t,["slidingWindow"],Dl(o,i)),t}function Vl(o,e){const t={},n=r(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Ul(o,e){const t={},n=r(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Fl(o,e,t){const n={},i=r(e,["generationConfig"]);t!==void 0&&i!=null&&a(t,["setup","generationConfig"],i);const s=r(e,["responseModalities"]);t!==void 0&&s!=null&&a(t,["setup","generationConfig","responseModalities"],s);const l=r(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const u=r(e,["topP"]);t!==void 0&&u!=null&&a(t,["setup","generationConfig","topP"],u);const d=r(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const c=r(e,["maxOutputTokens"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","maxOutputTokens"],c);const f=r(e,["mediaResolution"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","mediaResolution"],f);const p=r(e,["seed"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","seed"],p);const m=r(e,["speechConfig"]);t!==void 0&&m!=null&&a(t,["setup","generationConfig","speechConfig"],ja(o,Ji(o,m)));const h=r(e,["enableAffectiveDialog"]);t!==void 0&&h!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],h);const g=r(e,["systemInstruction"]);t!==void 0&&g!=null&&a(t,["setup","systemInstruction"],al(o,Y(o,g)));const y=r(e,["tools"]);if(t!==void 0&&y!=null){let F=Ht(o,y);Array.isArray(F)&&(F=F.map(O=>Sl(o,qt(o,O)))),a(t,["setup","tools"],F)}const C=r(e,["sessionResumption"]);t!==void 0&&C!=null&&a(t,["setup","sessionResumption"],Al(o,C));const x=r(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&a(t,["setup","inputAudioTranscription"],si());const w=r(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&a(t,["setup","outputAudioTranscription"],si());const M=r(e,["realtimeInputConfig"]);t!==void 0&&M!=null&&a(t,["setup","realtimeInputConfig"],Rl(o,M));const R=r(e,["contextWindowCompression"]);t!==void 0&&R!=null&&a(t,["setup","contextWindowCompression"],Ll(o,R));const N=r(e,["proactivity"]);return t!==void 0&&N!=null&&a(t,["setup","proactivity"],Vl(o,N)),n}function Bl(o,e,t){const n={},i=r(e,["generationConfig"]);t!==void 0&&i!=null&&a(t,["setup","generationConfig"],i);const s=r(e,["responseModalities"]);t!==void 0&&s!=null&&a(t,["setup","generationConfig","responseModalities"],s);const l=r(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const u=r(e,["topP"]);t!==void 0&&u!=null&&a(t,["setup","generationConfig","topP"],u);const d=r(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const c=r(e,["maxOutputTokens"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","maxOutputTokens"],c);const f=r(e,["mediaResolution"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","mediaResolution"],f);const p=r(e,["seed"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","seed"],p);const m=r(e,["speechConfig"]);t!==void 0&&m!=null&&a(t,["setup","generationConfig","speechConfig"],el(o,Ji(o,m)));const h=r(e,["enableAffectiveDialog"]);t!==void 0&&h!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],h);const g=r(e,["systemInstruction"]);t!==void 0&&g!=null&&a(t,["setup","systemInstruction"],ll(o,Y(o,g)));const y=r(e,["tools"]);if(t!==void 0&&y!=null){let F=Ht(o,y);Array.isArray(F)&&(F=F.map(O=>Il(o,qt(o,O)))),a(t,["setup","tools"],F)}const C=r(e,["sessionResumption"]);t!==void 0&&C!=null&&a(t,["setup","sessionResumption"],wl(o,C));const x=r(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&a(t,["setup","inputAudioTranscription"],ri());const w=r(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&a(t,["setup","outputAudioTranscription"],ri());const M=r(e,["realtimeInputConfig"]);t!==void 0&&M!=null&&a(t,["setup","realtimeInputConfig"],Nl(o,M));const R=r(e,["contextWindowCompression"]);t!==void 0&&R!=null&&a(t,["setup","contextWindowCompression"],bl(o,R));const N=r(e,["proactivity"]);return t!==void 0&&N!=null&&a(t,["setup","proactivity"],Ul(o,N)),n}function Gl(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["setup","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Fl(o,i,t)),t}function Ol(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["setup","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Bl(o,i,t)),t}function ql(){return{}}function Hl(){return{}}function $l(){return{}}function Jl(){return{}}function Yl(o,e){const t={},n=r(e,["media"]);n!=null&&a(t,["mediaChunks"],Oi(o,n));const i=r(e,["audio"]);i!=null&&a(t,["audio"],Ir(o,i));const s=r(e,["audioStreamEnd"]);s!=null&&a(t,["audioStreamEnd"],s);const l=r(e,["video"]);l!=null&&a(t,["video"],Sr(o,l));const u=r(e,["text"]);return u!=null&&a(t,["text"],u),r(e,["activityStart"])!=null&&a(t,["activityStart"],ql()),r(e,["activityEnd"])!=null&&a(t,["activityEnd"],$l()),t}function zl(o,e){const t={},n=r(e,["media"]);if(n!=null&&a(t,["mediaChunks"],Oi(o,n)),r(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=r(e,["audioStreamEnd"]);if(i!=null&&a(t,["audioStreamEnd"],i),r(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(r(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return r(e,["activityStart"])!=null&&a(t,["activityStart"],Hl()),r(e,["activityEnd"])!=null&&a(t,["activityEnd"],Jl()),t}function Qi(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["weight"]);return i!=null&&a(t,["weight"],i),t}function Kl(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Qi(o,s))),a(t,["weightedPrompts"],i)}return t}function ji(o,e){const t={},n=r(e,["temperature"]);n!=null&&a(t,["temperature"],n);const i=r(e,["topK"]);i!=null&&a(t,["topK"],i);const s=r(e,["seed"]);s!=null&&a(t,["seed"],s);const l=r(e,["guidance"]);l!=null&&a(t,["guidance"],l);const u=r(e,["bpm"]);u!=null&&a(t,["bpm"],u);const d=r(e,["density"]);d!=null&&a(t,["density"],d);const c=r(e,["brightness"]);c!=null&&a(t,["brightness"],c);const f=r(e,["scale"]);f!=null&&a(t,["scale"],f);const p=r(e,["muteBass"]);p!=null&&a(t,["muteBass"],p);const m=r(e,["muteDrums"]);m!=null&&a(t,["muteDrums"],m);const h=r(e,["onlyBassAndDrums"]);h!=null&&a(t,["onlyBassAndDrums"],h);const g=r(e,["musicGenerationMode"]);return g!=null&&a(t,["musicGenerationMode"],g),t}function Wl(o,e){const t={},n=r(e,["musicGenerationConfig"]);return n!=null&&a(t,["musicGenerationConfig"],ji(o,n)),t}function es(o,e){const t={},n=r(e,["model"]);return n!=null&&a(t,["model"],n),t}function ts(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Qi(o,s))),a(t,["weightedPrompts"],i)}return t}function gn(o,e){const t={},n=r(e,["setup"]);n!=null&&a(t,["setup"],es(o,n));const i=r(e,["clientContent"]);i!=null&&a(t,["clientContent"],ts(o,i));const s=r(e,["musicGenerationConfig"]);s!=null&&a(t,["musicGenerationConfig"],ji(o,s));const l=r(e,["playbackControl"]);return l!=null&&a(t,["playbackControl"],l),t}function Zl(){return{}}function Xl(){return{}}function Ql(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function jl(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function eu(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function tu(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function nu(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Ql(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],eu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ou(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],jl(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],tu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function iu(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>nu(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function su(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>ou(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ai(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["finished"]);return i!=null&&a(t,["finished"],i),t}function li(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["finished"]);return i!=null&&a(t,["finished"],i),t}function ru(o,e){const t={},n=r(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const i=r(e,["urlRetrievalStatus"]);return i!=null&&a(t,["urlRetrievalStatus"],i),t}function au(o,e){const t={},n=r(e,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ru(o,s))),a(t,["urlMetadata"],i)}return t}function lu(o,e){const t={},n=r(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],iu(o,n));const i=r(e,["turnComplete"]);i!=null&&a(t,["turnComplete"],i);const s=r(e,["interrupted"]);s!=null&&a(t,["interrupted"],s);const l=r(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const u=r(e,["generationComplete"]);u!=null&&a(t,["generationComplete"],u);const d=r(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],ai(o,d));const c=r(e,["outputTranscription"]);c!=null&&a(t,["outputTranscription"],ai(o,c));const f=r(e,["urlContextMetadata"]);return f!=null&&a(t,["urlContextMetadata"],au(o,f)),t}function uu(o,e){const t={},n=r(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],su(o,n));const i=r(e,["turnComplete"]);i!=null&&a(t,["turnComplete"],i);const s=r(e,["interrupted"]);s!=null&&a(t,["interrupted"],s);const l=r(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const u=r(e,["generationComplete"]);u!=null&&a(t,["generationComplete"],u);const d=r(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],li(o,d));const c=r(e,["outputTranscription"]);return c!=null&&a(t,["outputTranscription"],li(o,c)),t}function cu(o,e){const t={},n=r(e,["id"]);n!=null&&a(t,["id"],n);const i=r(e,["args"]);i!=null&&a(t,["args"],i);const s=r(e,["name"]);return s!=null&&a(t,["name"],s),t}function du(o,e){const t={},n=r(e,["args"]);n!=null&&a(t,["args"],n);const i=r(e,["name"]);return i!=null&&a(t,["name"],i),t}function fu(o,e){const t={},n=r(e,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>cu(o,s))),a(t,["functionCalls"],i)}return t}function pu(o,e){const t={},n=r(e,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>du(o,s))),a(t,["functionCalls"],i)}return t}function mu(o,e){const t={},n=r(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function hu(o,e){const t={},n=r(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function lt(o,e){const t={},n=r(e,["modality"]);n!=null&&a(t,["modality"],n);const i=r(e,["tokenCount"]);return i!=null&&a(t,["tokenCount"],i),t}function ut(o,e){const t={},n=r(e,["modality"]);n!=null&&a(t,["modality"],n);const i=r(e,["tokenCount"]);return i!=null&&a(t,["tokenCount"],i),t}function gu(o,e){const t={},n=r(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const i=r(e,["cachedContentTokenCount"]);i!=null&&a(t,["cachedContentTokenCount"],i);const s=r(e,["responseTokenCount"]);s!=null&&a(t,["responseTokenCount"],s);const l=r(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const u=r(e,["thoughtsTokenCount"]);u!=null&&a(t,["thoughtsTokenCount"],u);const d=r(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const c=r(e,["promptTokensDetails"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(g=>lt(o,g))),a(t,["promptTokensDetails"],h)}const f=r(e,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>lt(o,g))),a(t,["cacheTokensDetails"],h)}const p=r(e,["responseTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(g=>lt(o,g))),a(t,["responseTokensDetails"],h)}const m=r(e,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>lt(o,g))),a(t,["toolUsePromptTokensDetails"],h)}return t}function yu(o,e){const t={},n=r(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const i=r(e,["cachedContentTokenCount"]);i!=null&&a(t,["cachedContentTokenCount"],i);const s=r(e,["candidatesTokenCount"]);s!=null&&a(t,["responseTokenCount"],s);const l=r(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const u=r(e,["thoughtsTokenCount"]);u!=null&&a(t,["thoughtsTokenCount"],u);const d=r(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const c=r(e,["promptTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>ut(o,y))),a(t,["promptTokensDetails"],g)}const f=r(e,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(y=>ut(o,y))),a(t,["cacheTokensDetails"],g)}const p=r(e,["candidatesTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>ut(o,y))),a(t,["responseTokensDetails"],g)}const m=r(e,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(y=>ut(o,y))),a(t,["toolUsePromptTokensDetails"],g)}const h=r(e,["trafficType"]);return h!=null&&a(t,["trafficType"],h),t}function vu(o,e){const t={},n=r(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function Cu(o,e){const t={},n=r(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function Tu(o,e){const t={},n=r(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const i=r(e,["resumable"]);i!=null&&a(t,["resumable"],i);const s=r(e,["lastConsumedClientMessageIndex"]);return s!=null&&a(t,["lastConsumedClientMessageIndex"],s),t}function _u(o,e){const t={},n=r(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const i=r(e,["resumable"]);i!=null&&a(t,["resumable"],i);const s=r(e,["lastConsumedClientMessageIndex"]);return s!=null&&a(t,["lastConsumedClientMessageIndex"],s),t}function Eu(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Zl());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],lu(o,i));const s=r(e,["toolCall"]);s!=null&&a(t,["toolCall"],fu(o,s));const l=r(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],mu(o,l));const u=r(e,["usageMetadata"]);u!=null&&a(t,["usageMetadata"],gu(o,u));const d=r(e,["goAway"]);d!=null&&a(t,["goAway"],vu(o,d));const c=r(e,["sessionResumptionUpdate"]);return c!=null&&a(t,["sessionResumptionUpdate"],Tu(o,c)),t}function xu(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Xl());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],uu(o,i));const s=r(e,["toolCall"]);s!=null&&a(t,["toolCall"],pu(o,s));const l=r(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],hu(o,l));const u=r(e,["usageMetadata"]);u!=null&&a(t,["usageMetadata"],yu(o,u));const d=r(e,["goAway"]);d!=null&&a(t,["goAway"],Cu(o,d));const c=r(e,["sessionResumptionUpdate"]);return c!=null&&a(t,["sessionResumptionUpdate"],_u(o,c)),t}function Su(){return{}}function Iu(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["weight"]);return i!=null&&a(t,["weight"],i),t}function Au(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Iu(o,s))),a(t,["weightedPrompts"],i)}return t}function wu(o,e){const t={},n=r(e,["temperature"]);n!=null&&a(t,["temperature"],n);const i=r(e,["topK"]);i!=null&&a(t,["topK"],i);const s=r(e,["seed"]);s!=null&&a(t,["seed"],s);const l=r(e,["guidance"]);l!=null&&a(t,["guidance"],l);const u=r(e,["bpm"]);u!=null&&a(t,["bpm"],u);const d=r(e,["density"]);d!=null&&a(t,["density"],d);const c=r(e,["brightness"]);c!=null&&a(t,["brightness"],c);const f=r(e,["scale"]);f!=null&&a(t,["scale"],f);const p=r(e,["muteBass"]);p!=null&&a(t,["muteBass"],p);const m=r(e,["muteDrums"]);m!=null&&a(t,["muteDrums"],m);const h=r(e,["onlyBassAndDrums"]);h!=null&&a(t,["onlyBassAndDrums"],h);const g=r(e,["musicGenerationMode"]);return g!=null&&a(t,["musicGenerationMode"],g),t}function Mu(o,e){const t={},n=r(e,["clientContent"]);n!=null&&a(t,["clientContent"],Au(o,n));const i=r(e,["musicGenerationConfig"]);return i!=null&&a(t,["musicGenerationConfig"],wu(o,i)),t}function ku(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);i!=null&&a(t,["mimeType"],i);const s=r(e,["sourceMetadata"]);return s!=null&&a(t,["sourceMetadata"],Mu(o,s)),t}function Ru(o,e){const t={},n=r(e,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ku(o,s))),a(t,["audioChunks"],i)}return t}function Nu(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["filteredReason"]);return i!=null&&a(t,["filteredReason"],i),t}function Pu(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Su());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],Ru(o,i));const s=r(e,["filteredPrompt"]);return s!=null&&a(t,["filteredPrompt"],Nu(o,s)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Du(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function Lu(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function bu(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Du(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],Lu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function Jt(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>bu(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Vu(o,e){const t={};if(r(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=r(e,["category"]);n!=null&&a(t,["category"],n);const i=r(e,["threshold"]);return i!=null&&a(t,["threshold"],i),t}function Uu(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function Fu(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function Bu(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Fu(o,n)),t}function Gu(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function Ou(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Gu(o,n)),t}function qu(){return{}}function Hu(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>Uu(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],Bu(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],Ou(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],qu());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function $u(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function Ju(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Yu(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],Ju(o,n)),t}function zu(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],$u(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Yu(o,i)),t}function Ku(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function ns(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Ku(o,n)),t}function Wu(o,e){const t={},n=r(e,["speaker"]);n!=null&&a(t,["speaker"],n);const i=r(e,["voiceConfig"]);return i!=null&&a(t,["voiceConfig"],ns(o,i)),t}function Zu(o,e){const t={},n=r(e,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Wu(o,s))),a(t,["speakerVoiceConfigs"],i)}return t}function Xu(o,e){const t={},n=r(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],ns(o,n));const i=r(e,["multiSpeakerVoiceConfig"]);i!=null&&a(t,["multiSpeakerVoiceConfig"],Zu(o,i));const s=r(e,["languageCode"]);return s!=null&&a(t,["languageCode"],s),t}function Qu(o,e){const t={},n=r(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const i=r(e,["thinkingBudget"]);return i!=null&&a(t,["thinkingBudget"],i),t}function ju(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],Jt(o,Y(o,i)));const s=r(e,["temperature"]);s!=null&&a(n,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(n,["topP"],l);const u=r(e,["topK"]);u!=null&&a(n,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(n,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(n,["stopSequences"],f);const p=r(e,["responseLogprobs"]);p!=null&&a(n,["responseLogprobs"],p);const m=r(e,["logprobs"]);m!=null&&a(n,["logprobs"],m);const h=r(e,["presencePenalty"]);h!=null&&a(n,["presencePenalty"],h);const g=r(e,["frequencyPenalty"]);g!=null&&a(n,["frequencyPenalty"],g);const y=r(e,["seed"]);y!=null&&a(n,["seed"],y);const C=r(e,["responseMimeType"]);C!=null&&a(n,["responseMimeType"],C);const x=r(e,["responseSchema"]);if(x!=null&&a(n,["responseSchema"],Rt(o,x)),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=r(e,["safetySettings"]);if(t!==void 0&&w!=null){let b=w;Array.isArray(b)&&(b=b.map(ee=>Vu(o,ee))),a(t,["safetySettings"],b)}const M=r(e,["tools"]);if(t!==void 0&&M!=null){let b=Ht(o,M);Array.isArray(b)&&(b=b.map(ee=>Hu(o,qt(o,ee)))),a(t,["tools"],b)}const R=r(e,["toolConfig"]);if(t!==void 0&&R!=null&&a(t,["toolConfig"],zu(o,R)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=r(e,["cachedContent"]);t!==void 0&&N!=null&&a(t,["cachedContent"],ye(o,N));const F=r(e,["responseModalities"]);F!=null&&a(n,["responseModalities"],F);const O=r(e,["mediaResolution"]);O!=null&&a(n,["mediaResolution"],O);const Q=r(e,["speechConfig"]);if(Q!=null&&a(n,["speechConfig"],Xu(o,$i(o,Q))),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const D=r(e,["thinkingConfig"]);return D!=null&&a(n,["thinkingConfig"],Qu(o,D)),n}function ui(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=j(o,i);Array.isArray(l)&&(l=l.map(u=>Jt(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["generationConfig"],ju(o,s,t)),t}function ec(o,e,t){const n={},i=r(e,["taskType"]);t!==void 0&&i!=null&&a(t,["requests[]","taskType"],i);const s=r(e,["title"]);t!==void 0&&s!=null&&a(t,["requests[]","title"],s);const l=r(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&a(t,["requests[]","outputDimensionality"],l),r(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function tc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);i!=null&&a(t,["requests[]","content"],Hi(o,i));const s=r(e,["config"]);s!=null&&a(t,["config"],ec(o,s,t));const l=r(e,["model"]);return l!==void 0&&a(t,["requests[]","model"],V(o,l)),t}function nc(o,e,t){const n={};if(r(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=r(e,["numberOfImages"]);t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i);const s=r(e,["aspectRatio"]);t!==void 0&&s!=null&&a(t,["parameters","aspectRatio"],s);const l=r(e,["guidanceScale"]);if(t!==void 0&&l!=null&&a(t,["parameters","guidanceScale"],l),r(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=r(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&a(t,["parameters","safetySetting"],u);const d=r(e,["personGeneration"]);t!==void 0&&d!=null&&a(t,["parameters","personGeneration"],d);const c=r(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&a(t,["parameters","includeSafetyAttributes"],c);const f=r(e,["includeRaiReason"]);t!==void 0&&f!=null&&a(t,["parameters","includeRaiReason"],f);const p=r(e,["language"]);t!==void 0&&p!=null&&a(t,["parameters","language"],p);const m=r(e,["outputMimeType"]);t!==void 0&&m!=null&&a(t,["parameters","outputOptions","mimeType"],m);const h=r(e,["outputCompressionQuality"]);if(t!==void 0&&h!=null&&a(t,["parameters","outputOptions","compressionQuality"],h),r(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function oc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],nc(o,s,t)),t}function ic(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function sc(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const u=r(e,["queryBase"]);return t!==void 0&&u!=null&&a(t,["_url","models_url"],Ki(o,u)),n}function rc(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],sc(o,n,t)),t}function ac(o,e,t){const n={},i=r(e,["displayName"]);t!==void 0&&i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);t!==void 0&&s!=null&&a(t,["description"],s);const l=r(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function lc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],ac(o,i,t)),t}function uc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function cc(o,e){const t={};if(r(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function dc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=j(o,i);Array.isArray(l)&&(l=l.map(u=>Jt(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],cc(o,s)),t}function fc(o,e){const t={};if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(e,["imageBytes"]);n!=null&&a(t,["bytesBase64Encoded"],ve(o,n));const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function pc(o,e,t){const n={},i=r(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i),r(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=r(e,["durationSeconds"]);if(t!==void 0&&s!=null&&a(t,["parameters","durationSeconds"],s),r(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=r(e,["aspectRatio"]);if(t!==void 0&&l!=null&&a(t,["parameters","aspectRatio"],l),r(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=r(e,["personGeneration"]);if(t!==void 0&&u!=null&&a(t,["parameters","personGeneration"],u),r(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=r(e,["negativePrompt"]);if(t!==void 0&&d!=null&&a(t,["parameters","negativePrompt"],d),r(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function mc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(t,["instances[0]","image"],fc(o,s));const l=r(e,["config"]);return l!=null&&a(t,["config"],pc(o,l,t)),t}function hc(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function gc(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function yc(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],hc(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],gc(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function Je(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>yc(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function vc(o,e){const t={},n=r(e,["featureSelectionPreference"]);return n!=null&&a(t,["featureSelectionPreference"],n),t}function Cc(o,e){const t={},n=r(e,["method"]);n!=null&&a(t,["method"],n);const i=r(e,["category"]);i!=null&&a(t,["category"],i);const s=r(e,["threshold"]);return s!=null&&a(t,["threshold"],s),t}function Tc(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function _c(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function Ec(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],_c(o,n)),t}function xc(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function Sc(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],xc(o,n)),t}function Ic(){return{}}function Ac(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function wc(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],Ac(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function Mc(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],wc(o,n)),t}function os(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>Tc(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],Ec(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],Sc(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],Ic());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],Mc(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function kc(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function Rc(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Nc(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],Rc(o,n)),t}function Pc(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],kc(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Nc(o,i)),t}function Dc(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Lc(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Dc(o,n)),t}function bc(o,e){const t={},n=r(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],Lc(o,n)),r(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=r(e,["languageCode"]);return i!=null&&a(t,["languageCode"],i),t}function Vc(o,e){const t={},n=r(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const i=r(e,["thinkingBudget"]);return i!=null&&a(t,["thinkingBudget"],i),t}function Uc(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],Je(o,Y(o,i)));const s=r(e,["temperature"]);s!=null&&a(n,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(n,["topP"],l);const u=r(e,["topK"]);u!=null&&a(n,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(n,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(n,["stopSequences"],f);const p=r(e,["responseLogprobs"]);p!=null&&a(n,["responseLogprobs"],p);const m=r(e,["logprobs"]);m!=null&&a(n,["logprobs"],m);const h=r(e,["presencePenalty"]);h!=null&&a(n,["presencePenalty"],h);const g=r(e,["frequencyPenalty"]);g!=null&&a(n,["frequencyPenalty"],g);const y=r(e,["seed"]);y!=null&&a(n,["seed"],y);const C=r(e,["responseMimeType"]);C!=null&&a(n,["responseMimeType"],C);const x=r(e,["responseSchema"]);x!=null&&a(n,["responseSchema"],Rt(o,x));const w=r(e,["routingConfig"]);w!=null&&a(n,["routingConfig"],w);const M=r(e,["modelSelectionConfig"]);M!=null&&a(n,["modelConfig"],vc(o,M));const R=r(e,["safetySettings"]);if(t!==void 0&&R!=null){let re=R;Array.isArray(re)&&(re=re.map(zt=>Cc(o,zt))),a(t,["safetySettings"],re)}const N=r(e,["tools"]);if(t!==void 0&&N!=null){let re=Ht(o,N);Array.isArray(re)&&(re=re.map(zt=>os(o,qt(o,zt)))),a(t,["tools"],re)}const F=r(e,["toolConfig"]);t!==void 0&&F!=null&&a(t,["toolConfig"],Pc(o,F));const O=r(e,["labels"]);t!==void 0&&O!=null&&a(t,["labels"],O);const Q=r(e,["cachedContent"]);t!==void 0&&Q!=null&&a(t,["cachedContent"],ye(o,Q));const D=r(e,["responseModalities"]);D!=null&&a(n,["responseModalities"],D);const b=r(e,["mediaResolution"]);b!=null&&a(n,["mediaResolution"],b);const ee=r(e,["speechConfig"]);ee!=null&&a(n,["speechConfig"],bc(o,$i(o,ee)));const Un=r(e,["audioTimestamp"]);Un!=null&&a(n,["audioTimestamp"],Un);const Fn=r(e,["thinkingConfig"]);return Fn!=null&&a(n,["thinkingConfig"],Vc(o,Fn)),n}function ci(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=j(o,i);Array.isArray(l)&&(l=l.map(u=>Je(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["generationConfig"],Uc(o,s,t)),t}function Fc(o,e,t){const n={},i=r(e,["taskType"]);t!==void 0&&i!=null&&a(t,["instances[]","task_type"],i);const s=r(e,["title"]);t!==void 0&&s!=null&&a(t,["instances[]","title"],s);const l=r(e,["outputDimensionality"]);t!==void 0&&l!=null&&a(t,["parameters","outputDimensionality"],l);const u=r(e,["mimeType"]);t!==void 0&&u!=null&&a(t,["instances[]","mimeType"],u);const d=r(e,["autoTruncate"]);return t!==void 0&&d!=null&&a(t,["parameters","autoTruncate"],d),n}function Bc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);i!=null&&a(t,["instances[]","content"],Hi(o,i));const s=r(e,["config"]);return s!=null&&a(t,["config"],Fc(o,s,t)),t}function Gc(o,e,t){const n={},i=r(e,["outputGcsUri"]);t!==void 0&&i!=null&&a(t,["parameters","storageUri"],i);const s=r(e,["negativePrompt"]);t!==void 0&&s!=null&&a(t,["parameters","negativePrompt"],s);const l=r(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const u=r(e,["aspectRatio"]);t!==void 0&&u!=null&&a(t,["parameters","aspectRatio"],u);const d=r(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const c=r(e,["seed"]);t!==void 0&&c!=null&&a(t,["parameters","seed"],c);const f=r(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&a(t,["parameters","safetySetting"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&a(t,["parameters","includeSafetyAttributes"],m);const h=r(e,["includeRaiReason"]);t!==void 0&&h!=null&&a(t,["parameters","includeRaiReason"],h);const g=r(e,["language"]);t!==void 0&&g!=null&&a(t,["parameters","language"],g);const y=r(e,["outputMimeType"]);t!==void 0&&y!=null&&a(t,["parameters","outputOptions","mimeType"],y);const C=r(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&a(t,["parameters","outputOptions","compressionQuality"],C);const x=r(e,["addWatermark"]);t!==void 0&&x!=null&&a(t,["parameters","addWatermark"],x);const w=r(e,["enhancePrompt"]);return t!==void 0&&w!=null&&a(t,["parameters","enhancePrompt"],w),n}function Oc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],Gc(o,s,t)),t}function Dn(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const i=r(e,["imageBytes"]);i!=null&&a(t,["bytesBase64Encoded"],ve(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function qc(o,e){const t={},n=r(e,["maskMode"]);n!=null&&a(t,["maskMode"],n);const i=r(e,["segmentationClasses"]);i!=null&&a(t,["maskClasses"],i);const s=r(e,["maskDilation"]);return s!=null&&a(t,["dilation"],s),t}function Hc(o,e){const t={},n=r(e,["controlType"]);n!=null&&a(t,["controlType"],n);const i=r(e,["enableControlImageComputation"]);return i!=null&&a(t,["computeControl"],i),t}function $c(o,e){const t={},n=r(e,["styleDescription"]);return n!=null&&a(t,["styleDescription"],n),t}function Jc(o,e){const t={},n=r(e,["subjectType"]);n!=null&&a(t,["subjectType"],n);const i=r(e,["subjectDescription"]);return i!=null&&a(t,["subjectDescription"],i),t}function Yc(o,e){const t={},n=r(e,["referenceImage"]);n!=null&&a(t,["referenceImage"],Dn(o,n));const i=r(e,["referenceId"]);i!=null&&a(t,["referenceId"],i);const s=r(e,["referenceType"]);s!=null&&a(t,["referenceType"],s);const l=r(e,["maskImageConfig"]);l!=null&&a(t,["maskImageConfig"],qc(o,l));const u=r(e,["controlImageConfig"]);u!=null&&a(t,["controlImageConfig"],Hc(o,u));const d=r(e,["styleImageConfig"]);d!=null&&a(t,["styleImageConfig"],$c(o,d));const c=r(e,["subjectImageConfig"]);return c!=null&&a(t,["subjectImageConfig"],Jc(o,c)),t}function zc(o,e,t){const n={},i=r(e,["outputGcsUri"]);t!==void 0&&i!=null&&a(t,["parameters","storageUri"],i);const s=r(e,["negativePrompt"]);t!==void 0&&s!=null&&a(t,["parameters","negativePrompt"],s);const l=r(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const u=r(e,["aspectRatio"]);t!==void 0&&u!=null&&a(t,["parameters","aspectRatio"],u);const d=r(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const c=r(e,["seed"]);t!==void 0&&c!=null&&a(t,["parameters","seed"],c);const f=r(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&a(t,["parameters","safetySetting"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&a(t,["parameters","includeSafetyAttributes"],m);const h=r(e,["includeRaiReason"]);t!==void 0&&h!=null&&a(t,["parameters","includeRaiReason"],h);const g=r(e,["language"]);t!==void 0&&g!=null&&a(t,["parameters","language"],g);const y=r(e,["outputMimeType"]);t!==void 0&&y!=null&&a(t,["parameters","outputOptions","mimeType"],y);const C=r(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&a(t,["parameters","outputOptions","compressionQuality"],C);const x=r(e,["editMode"]);t!==void 0&&x!=null&&a(t,["parameters","editMode"],x);const w=r(e,["baseSteps"]);return t!==void 0&&w!=null&&a(t,["parameters","editConfig","baseSteps"],w),n}function Kc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["referenceImages"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>Yc(o,d))),a(t,["instances[0]","referenceImages"],u)}const l=r(e,["config"]);return l!=null&&a(t,["config"],zc(o,l,t)),t}function Wc(o,e,t){const n={},i=r(e,["includeRaiReason"]);t!==void 0&&i!=null&&a(t,["parameters","includeRaiReason"],i);const s=r(e,["outputMimeType"]);t!==void 0&&s!=null&&a(t,["parameters","outputOptions","mimeType"],s);const l=r(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&a(t,["parameters","outputOptions","compressionQuality"],l);const u=r(e,["numberOfImages"]);t!==void 0&&u!=null&&a(t,["parameters","sampleCount"],u);const d=r(e,["mode"]);return t!==void 0&&d!=null&&a(t,["parameters","mode"],d),n}function Zc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["image"]);i!=null&&a(t,["instances[0]","image"],Dn(o,i));const s=r(e,["upscaleFactor"]);s!=null&&a(t,["parameters","upscaleConfig","upscaleFactor"],s);const l=r(e,["config"]);return l!=null&&a(t,["config"],Wc(o,l,t)),t}function Xc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Qc(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const u=r(e,["queryBase"]);return t!==void 0&&u!=null&&a(t,["_url","models_url"],Ki(o,u)),n}function jc(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Qc(o,n,t)),t}function ed(o,e,t){const n={},i=r(e,["displayName"]);t!==void 0&&i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);t!==void 0&&s!=null&&a(t,["description"],s);const l=r(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function td(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],ed(o,i,t)),t}function nd(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function od(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],Je(o,Y(o,i)));const s=r(e,["tools"]);if(t!==void 0&&s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>os(o,d))),a(t,["tools"],u)}const l=r(e,["generationConfig"]);return t!==void 0&&l!=null&&a(t,["generationConfig"],l),n}function id(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=j(o,i);Array.isArray(l)&&(l=l.map(u=>Je(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],od(o,s,t)),t}function sd(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=j(o,i);Array.isArray(l)&&(l=l.map(u=>Je(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],s),t}function rd(o,e,t){const n={},i=r(e,["numberOfVideos"]);t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i);const s=r(e,["outputGcsUri"]);t!==void 0&&s!=null&&a(t,["parameters","storageUri"],s);const l=r(e,["fps"]);t!==void 0&&l!=null&&a(t,["parameters","fps"],l);const u=r(e,["durationSeconds"]);t!==void 0&&u!=null&&a(t,["parameters","durationSeconds"],u);const d=r(e,["seed"]);t!==void 0&&d!=null&&a(t,["parameters","seed"],d);const c=r(e,["aspectRatio"]);t!==void 0&&c!=null&&a(t,["parameters","aspectRatio"],c);const f=r(e,["resolution"]);t!==void 0&&f!=null&&a(t,["parameters","resolution"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["pubsubTopic"]);t!==void 0&&m!=null&&a(t,["parameters","pubsubTopic"],m);const h=r(e,["negativePrompt"]);t!==void 0&&h!=null&&a(t,["parameters","negativePrompt"],h);const g=r(e,["enhancePrompt"]);return t!==void 0&&g!=null&&a(t,["parameters","enhancePrompt"],g),n}function ad(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(t,["instances[0]","image"],Dn(o,s));const l=r(e,["config"]);return l!=null&&a(t,["config"],rd(o,l,t)),t}function ld(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function ud(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function cd(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],ld(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],ud(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function dd(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>cd(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function fd(o,e){const t={},n=r(e,["citationSources"]);return n!=null&&a(t,["citations"],n),t}function pd(o,e){const t={},n=r(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const i=r(e,["urlRetrievalStatus"]);return i!=null&&a(t,["urlRetrievalStatus"],i),t}function md(o,e){const t={},n=r(e,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>pd(o,s))),a(t,["urlMetadata"],i)}return t}function hd(o,e){const t={},n=r(e,["content"]);n!=null&&a(t,["content"],dd(o,n));const i=r(e,["citationMetadata"]);i!=null&&a(t,["citationMetadata"],fd(o,i));const s=r(e,["tokenCount"]);s!=null&&a(t,["tokenCount"],s);const l=r(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const u=r(e,["urlContextMetadata"]);u!=null&&a(t,["urlContextMetadata"],md(o,u));const d=r(e,["avgLogprobs"]);d!=null&&a(t,["avgLogprobs"],d);const c=r(e,["groundingMetadata"]);c!=null&&a(t,["groundingMetadata"],c);const f=r(e,["index"]);f!=null&&a(t,["index"],f);const p=r(e,["logprobsResult"]);p!=null&&a(t,["logprobsResult"],p);const m=r(e,["safetyRatings"]);return m!=null&&a(t,["safetyRatings"],m),t}function di(o,e){const t={},n=r(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>hd(o,d))),a(t,["candidates"],u)}const i=r(e,["modelVersion"]);i!=null&&a(t,["modelVersion"],i);const s=r(e,["promptFeedback"]);s!=null&&a(t,["promptFeedback"],s);const l=r(e,["usageMetadata"]);return l!=null&&a(t,["usageMetadata"],l),t}function gd(o,e){const t={},n=r(e,["values"]);return n!=null&&a(t,["values"],n),t}function yd(){return{}}function vd(o,e){const t={},n=r(e,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>gd(o,l))),a(t,["embeddings"],s)}return r(e,["metadata"])!=null&&a(t,["metadata"],yd()),t}function Cd(o,e){const t={},n=r(e,["bytesBase64Encoded"]);n!=null&&a(t,["imageBytes"],ve(o,n));const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function is(o,e){const t={},n=r(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const i=r(e,["safetyAttributes","scores"]);i!=null&&a(t,["scores"],i);const s=r(e,["contentType"]);return s!=null&&a(t,["contentType"],s),t}function Td(o,e){const t={},n=r(e,["_self"]);n!=null&&a(t,["image"],Cd(o,n));const i=r(e,["raiFilteredReason"]);i!=null&&a(t,["raiFilteredReason"],i);const s=r(e,["_self"]);return s!=null&&a(t,["safetyAttributes"],is(o,s)),t}function _d(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Td(o,l))),a(t,["generatedImages"],s)}const i=r(e,["positivePromptSafetyAttributes"]);return i!=null&&a(t,["positivePromptSafetyAttributes"],is(o,i)),t}function Ed(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["updateTime"]);return s!=null&&a(t,["updateTime"],s),t}function yn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);s!=null&&a(t,["description"],s);const l=r(e,["version"]);l!=null&&a(t,["version"],l);const u=r(e,["_self"]);u!=null&&a(t,["tunedModelInfo"],Ed(o,u));const d=r(e,["inputTokenLimit"]);d!=null&&a(t,["inputTokenLimit"],d);const c=r(e,["outputTokenLimit"]);c!=null&&a(t,["outputTokenLimit"],c);const f=r(e,["supportedGenerationMethods"]);return f!=null&&a(t,["supportedActions"],f),t}function xd(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["_self"]);if(i!=null){let s=Wi(o,i);Array.isArray(s)&&(s=s.map(l=>yn(o,l))),a(t,["models"],s)}return t}function Sd(){return{}}function Id(o,e){const t={},n=r(e,["totalTokens"]);n!=null&&a(t,["totalTokens"],n);const i=r(e,["cachedContentTokenCount"]);return i!=null&&a(t,["cachedContentTokenCount"],i),t}function Ad(o,e){const t={},n=r(e,["video","uri"]);n!=null&&a(t,["uri"],n);const i=r(e,["video","encodedVideo"]);i!=null&&a(t,["videoBytes"],ve(o,i));const s=r(e,["encoding"]);return s!=null&&a(t,["mimeType"],s),t}function wd(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],Ad(o,n)),t}function Md(o,e){const t={},n=r(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>wd(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function kd(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response","generateVideoResponse"]);return u!=null&&a(t,["response"],Md(o,u)),t}function Rd(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function Nd(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function Pd(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Rd(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],Nd(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function Dd(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Pd(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Ld(o,e){const t={},n=r(e,["citations"]);return n!=null&&a(t,["citations"],n),t}function bd(o,e){const t={},n=r(e,["content"]);n!=null&&a(t,["content"],Dd(o,n));const i=r(e,["citationMetadata"]);i!=null&&a(t,["citationMetadata"],Ld(o,i));const s=r(e,["finishMessage"]);s!=null&&a(t,["finishMessage"],s);const l=r(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const u=r(e,["avgLogprobs"]);u!=null&&a(t,["avgLogprobs"],u);const d=r(e,["groundingMetadata"]);d!=null&&a(t,["groundingMetadata"],d);const c=r(e,["index"]);c!=null&&a(t,["index"],c);const f=r(e,["logprobsResult"]);f!=null&&a(t,["logprobsResult"],f);const p=r(e,["safetyRatings"]);return p!=null&&a(t,["safetyRatings"],p),t}function fi(o,e){const t={},n=r(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>bd(o,f))),a(t,["candidates"],c)}const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["responseId"]);s!=null&&a(t,["responseId"],s);const l=r(e,["modelVersion"]);l!=null&&a(t,["modelVersion"],l);const u=r(e,["promptFeedback"]);u!=null&&a(t,["promptFeedback"],u);const d=r(e,["usageMetadata"]);return d!=null&&a(t,["usageMetadata"],d),t}function Vd(o,e){const t={},n=r(e,["truncated"]);n!=null&&a(t,["truncated"],n);const i=r(e,["token_count"]);return i!=null&&a(t,["tokenCount"],i),t}function Ud(o,e){const t={},n=r(e,["values"]);n!=null&&a(t,["values"],n);const i=r(e,["statistics"]);return i!=null&&a(t,["statistics"],Vd(o,i)),t}function Fd(o,e){const t={},n=r(e,["billableCharacterCount"]);return n!=null&&a(t,["billableCharacterCount"],n),t}function Bd(o,e){const t={},n=r(e,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ud(o,l))),a(t,["embeddings"],s)}const i=r(e,["metadata"]);return i!=null&&a(t,["metadata"],Fd(o,i)),t}function Gd(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["imageBytes"],ve(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function ss(o,e){const t={},n=r(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const i=r(e,["safetyAttributes","scores"]);i!=null&&a(t,["scores"],i);const s=r(e,["contentType"]);return s!=null&&a(t,["contentType"],s),t}function Ln(o,e){const t={},n=r(e,["_self"]);n!=null&&a(t,["image"],Gd(o,n));const i=r(e,["raiFilteredReason"]);i!=null&&a(t,["raiFilteredReason"],i);const s=r(e,["_self"]);s!=null&&a(t,["safetyAttributes"],ss(o,s));const l=r(e,["prompt"]);return l!=null&&a(t,["enhancedPrompt"],l),t}function Od(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ln(o,l))),a(t,["generatedImages"],s)}const i=r(e,["positivePromptSafetyAttributes"]);return i!=null&&a(t,["positivePromptSafetyAttributes"],ss(o,i)),t}function qd(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ln(o,s))),a(t,["generatedImages"],i)}return t}function Hd(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ln(o,s))),a(t,["generatedImages"],i)}return t}function $d(o,e){const t={},n=r(e,["endpoint"]);n!=null&&a(t,["name"],n);const i=r(e,["deployedModelId"]);return i!=null&&a(t,["deployedModelId"],i),t}function Jd(o,e){const t={},n=r(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["updateTime"]);return s!=null&&a(t,["updateTime"],s),t}function Yd(o,e){const t={},n=r(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const i=r(e,["epoch"]);i!=null&&a(t,["epoch"],i);const s=r(e,["step"]);return s!=null&&a(t,["step"],s),t}function vn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);s!=null&&a(t,["description"],s);const l=r(e,["versionId"]);l!=null&&a(t,["version"],l);const u=r(e,["deployedModels"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(h=>$d(o,h))),a(t,["endpoints"],m)}const d=r(e,["labels"]);d!=null&&a(t,["labels"],d);const c=r(e,["_self"]);c!=null&&a(t,["tunedModelInfo"],Jd(o,c));const f=r(e,["defaultCheckpointId"]);f!=null&&a(t,["defaultCheckpointId"],f);const p=r(e,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Yd(o,h))),a(t,["checkpoints"],m)}return t}function zd(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["_self"]);if(i!=null){let s=Wi(o,i);Array.isArray(s)&&(s=s.map(l=>vn(o,l))),a(t,["models"],s)}return t}function Kd(){return{}}function Wd(o,e){const t={},n=r(e,["totalTokens"]);return n!=null&&a(t,["totalTokens"],n),t}function Zd(o,e){const t={},n=r(e,["tokensInfo"]);return n!=null&&a(t,["tokensInfo"],n),t}function Xd(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["videoBytes"],ve(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function Qd(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],Xd(o,n)),t}function jd(o,e){const t={},n=r(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Qd(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function ef(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],jd(o,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tf="Content-Type",nf="X-Server-Timeout",of="User-Agent",Cn="x-goog-api-client",sf="0.15.0",rf=`google-genai-sdk/${sf}`,af="v1beta1",lf="v1beta",pi=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class rs extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class Tn extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class uf{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:af,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:lf,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?n[i]=Object.assign(Object.assign({},n[i]),s):s!==void 0&&(n[i]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const i=new AbortController,s=i.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>i.abort(),t.timeout),n&&n.addEventListener("abort",()=>{i.abort()}),e.signal=s}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await mi(i),new pn(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await mi(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return Qe(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield U(i.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=s.decode(d);try{const p=JSON.parse(c);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,g=m.code,y=`got status: ${h}. ${JSON.stringify(p)}`;if(g>=400&&g<500)throw new rs(y);if(g>=500&&g<600)throw new Tn(y)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}l+=c;let f=l.match(pi);for(;f;){const p=f[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield U(new pn(m)),l=l.slice(f[0].length),f=l.match(pi)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=rf+" "+this.clientOptions.userAgentExtra;return e[of]=t,e[Cn]=t,e[tf]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,i]of Object.entries(e.headers))t.append(n,i);e.timeout&&e.timeout>0&&t.append(nf,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);i.sizeBytes=String(l.size);const u=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d=await this.fetchUploadUrl(i,t);return s.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var n;let i={};t!=null&&t.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},l=await this.request({path:S("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=l==null?void 0:l.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function mi(o){var e;if(o===void 0)throw new Tn("response is undefined");if(!o.ok){const t=o.status,n=o.statusText;let i;!((e=o.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await o.json():i={error:{message:await o.text(),code:o.status,status:o.statusText}};const s=`got status: ${t} ${n}. ${JSON.stringify(i)}`;throw t>=400&&t<500?new rs(s):t>=500&&t<600?new Tn(s):new Error(s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cf="mcp_used/unknown";function _n(o){for(const e of o)if(bn(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function En(o){var e;o[Cn]=(((e=o[Cn])!==null&&e!==void 0?e:"")+` ${cf}`).trimStart()}function df(o){var e,t,n;return(n=(t=(e=o.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>bn(i)))!==null&&n!==void 0?n:!1}function ff(o){var e,t,n;return(n=(t=(e=o.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>!bn(i)))!==null&&n!==void 0?n:!1}function bn(o){return o!==null&&typeof o=="object"&&"tool"in o&&"callTool"in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function pf(o,e,t){const n=new xr,i=JSON.parse(t.data),s=Pu(o,i);Object.assign(n,s),e(n)}class mf{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=yf(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(M=>{c=M}),p=e.callbacks,m=function(){c({})},h=this.apiClient,g={onopen:m,onmessage:M=>{pf(h,p.onmessage,M)},onerror:(t=p==null?void 0:p.onerror)!==null&&t!==void 0?t:function(M){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(M){}},y=this.webSocketFactory.create(d,gf(l),g);y.connect(),await f;const C=V(this.apiClient,e.model),x=es(this.apiClient,{model:C}),w=gn(this.apiClient,{setup:x});return y.send(JSON.stringify(w)),new hf(y,this.apiClient)}}class hf{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Kl(this.apiClient,e),n=ts(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Wl(this.apiClient,e),n=gn(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const t=gn(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ke.PLAY)}pause(){this.sendPlaybackControl(ke.PAUSE)}stop(){this.sendPlaybackControl(ke.STOP)}resetContext(){this.sendPlaybackControl(ke.RESET_CONTEXT)}close(){this.conn.close()}}function gf(o){const e={};return o.forEach((t,n)=>{e[n]=t}),e}function yf(o){const e=new Headers;for(const[t,n]of Object.entries(o))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vf="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Cf(o,e,t){const n=new Er;let i;if(t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),o.isVertexAI()){const s=xu(o,i);Object.assign(n,s)}else{const s=Eu(o,i);Object.assign(n,s)}e(n)}class Tf{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new mf(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,s,l,u;const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&_n(e.config.tools)&&En(p);const m=Sf(p);if(this.apiClient.isVertexAI())f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const D=this.apiClient.getApiKey();f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateContent?key=${D}`}let h=()=>{};const g=new Promise(D=>{h=D}),y=e.callbacks,C=function(){var D;(D=y==null?void 0:y.onopen)===null||D===void 0||D.call(y),h({})},x=this.apiClient,w={onopen:C,onmessage:D=>{Cf(x,y.onmessage,D)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(D){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(D){}},M=this.webSocketFactory.create(f,xf(m),w);M.connect(),await g;let R=V(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&R.startsWith("publishers/")){const D=this.apiClient.getProject(),b=this.apiClient.getLocation();R=`projects/${D}/locations/${b}/`+R}let N={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Mt.AUDIO]}:e.config.responseModalities=[Mt.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],O=[];for(const D of F)if(this.isCallableTool(D)){const b=D;O.push(await b.tool())}else O.push(D);O.length>0&&(e.config.tools=O);const Q={model:R,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?N=Ol(this.apiClient,Q):N=Gl(this.apiClient,Q),delete N.config,M.send(JSON.stringify(N)),new Ef(M,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const _f={turnComplete:!0};class Ef{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=j(e,t.turns),e.isVertexAI()?n=n.map(i=>Je(e,i)):n=n.map(i=>Jt(e,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(vf)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},_f),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:zl(this.apiClient,e)}:t={realtimeInput:Yl(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function xf(o){const e={};return o.forEach((t,n)=>{e[n]=t}),e}function Sf(o){const e=new Headers;for(const[t,n]of Object.entries(o))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hi=10;function gi(o){var e,t,n;if(!((e=o==null?void 0:o.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=o==null?void 0:o.tools)!==null&&t!==void 0?t:[])if(gt(l)){i=!0;break}if(!i)return!0;const s=(n=o==null?void 0:o.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function gt(o){return"callTool"in o&&typeof o.callTool=="function"}function yi(o){var e;return!(!((e=o==null?void 0:o.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class If extends st{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,i,s,l,u;if(t.config&&t.config.tools&&_n(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),En(t.config.httpOptions.headers)),!df(t)||gi(t.config))return await this.generateContentInternal(t);if(ff(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const d=await this.transformCallableTools(t);let c,f;const p=j(this.apiClient,d.contents),m=(s=(i=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:hi;let h=0;for(;h<m&&(c=await this.generateContentInternal(d),!(!c.functionCalls||c.functionCalls.length===0));){const g=c.candidates[0].content,y=[];for(const C of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(gt(C)){const w=await C.callTool(c.functionCalls);y.push(...w)}h++,f={role:"user",parts:y},d.contents=j(this.apiClient,d.contents),d.contents.push(g),d.contents.push(f),yi(d.config)&&(p.push(g),p.push(f))}return yi(d.config)&&(c.automaticFunctionCallingHistory=p),c},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&_n(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),En(t.config.httpOptions.headers)),gi(t.config)){const n=await this.transformCallableTools(t);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let s;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:l.push(d);let u;return s?u={generatedImages:l,positivePromptSafetyAttributes:s}:u={generatedImages:l},u}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new $t($e.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(i)}}async transformCallableTools(e){var t;const n=(t=e.config)===null||t===void 0?void 0:t.tools;if(!n)return e;const i=await Promise.all(n.map(async l=>gt(l)?await l.tool():l)),s={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};return s.config.tools=i,s}async initAfcToolsMap(e){var t,n,i;const s=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(gt(l)){const u=l,d=await u.tool();for(const c of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,u)}}return s}async processAfcStream(e){var t,n,i;const s=(i=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:hi;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return function(c,f,p){var m,h;return Qe(this,arguments,function*(){for(var g,y,C,x;u<s;){l&&(u++,l=!1);const N=yield U(c.transformCallableTools(p)),F=yield U(c.generateContentStreamInternal(N)),O=[],Q=[];try{for(var w=!0,M=(y=void 0,ht(F)),R;R=yield U(M.next()),g=R.done,!g;w=!0){x=R.value,w=!1;const D=x;if(yield yield U(D),D.candidates&&(!((m=D.candidates[0])===null||m===void 0)&&m.content)){Q.push(D.candidates[0].content);for(const b of(h=D.candidates[0].content.parts)!==null&&h!==void 0?h:[])if(u<s&&b.functionCall){if(!b.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(b.functionCall.name)){const ee=yield U(f.get(b.functionCall.name).callTool([b.functionCall]));O.push(...ee)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${b.functionCall.name}`)}}}}catch(D){y={error:D}}finally{try{!w&&!g&&(C=M.return)&&(yield U(C.call(M)))}finally{if(y)throw y.error}}if(O.length>0){l=!0;const D=new Ye;D.candidates=[{content:{role:"user",parts:O}}],yield yield U(D);const b=[];b.push(...Q),b.push({role:"user",parts:O});const ee=j(c.apiClient,p.contents).concat(b);p.contents=ee}else break}})}(this,d,e)}async generateContentInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ci(this.apiClient,e);return u=S("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=fi(this.apiClient,f),m=new Ye;return Object.assign(m,p),m})}else{const c=ui(this.apiClient,e);return u=S("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=di(this.apiClient,f),m=new Ye;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ci(this.apiClient,e);u=S("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(p){return Qe(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,x=ht(p),w;w=yield U(x.next()),m=w.done,!m;C=!0){y=w.value,C=!1;const R=fi(f,yield U(y.json())),N=new Ye;Object.assign(N,R),yield yield U(N)}}catch(M){h={error:M}}finally{try{!C&&!m&&(g=x.return)&&(yield U(g.call(x)))}finally{if(h)throw h.error}}})})}else{const c=ui(this.apiClient,e);u=S("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(p){return Qe(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,x=ht(p),w;w=yield U(x.next()),m=w.done,!m;C=!0){y=w.value,C=!1;const R=di(f,yield U(y.json())),N=new Ye;Object.assign(N,R),yield yield U(N)}}catch(M){h={error:M}}finally{try{!C&&!m&&(g=x.return)&&(yield U(g.call(x)))}finally{if(h)throw h.error}}})})}}async embedContent(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Bc(this.apiClient,e);return u=S("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Bd(this.apiClient,f),m=new Ho;return Object.assign(m,p),m})}else{const c=tc(this.apiClient,e);return u=S("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=vd(this.apiClient,f),m=new Ho;return Object.assign(m,p),m})}}async generateImagesInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Oc(this.apiClient,e);return u=S("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Od(this.apiClient,f),m=new $o;return Object.assign(m,p),m})}else{const c=oc(this.apiClient,e);return u=S("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=_d(this.apiClient,f),m=new $o;return Object.assign(m,p),m})}}async editImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Kc(this.apiClient,e);return s=S("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=qd(this.apiClient,d),f=new gr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Zc(this.apiClient,e);return s=S("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Hd(this.apiClient,d),f=new yr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xc(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>vn(this.apiClient,f))}else{const c=ic(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>yn(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=jc(this.apiClient,e);return u=S("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=zd(this.apiClient,f),m=new Jo;return Object.assign(m,p),m})}else{const c=rc(this.apiClient,e);return u=S("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=xd(this.apiClient,f),m=new Jo;return Object.assign(m,p),m})}}async update(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=td(this.apiClient,e);return u=S("{model}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>vn(this.apiClient,f))}else{const c=lc(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>yn(this.apiClient,f))}}async delete(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=nd(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Kd(),p=new Yo;return Object.assign(p,f),p})}else{const c=uc(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Sd(),p=new Yo;return Object.assign(p,f),p})}}async countTokens(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=id(this.apiClient,e);return u=S("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Wd(this.apiClient,f),m=new zo;return Object.assign(m,p),m})}else{const c=dc(this.apiClient,e);return u=S("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Id(this.apiClient,f),m=new zo;return Object.assign(m,p),m})}}async computeTokens(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=sd(this.apiClient,e);return s=S("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Zd(this.apiClient,d),f=new vr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ad(this.apiClient,e);return u=S("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ef(this.apiClient,f))}else{const c=mc(this.apiClient,e);return u=S("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>kd(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Af(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function wf(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Mf(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["operationName"],n);const i=r(e,["resourceName"]);i!=null&&a(t,["_url","resourceName"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],s),t}function kf(o,e){const t={},n=r(e,["video","uri"]);n!=null&&a(t,["uri"],n);const i=r(e,["video","encodedVideo"]);i!=null&&a(t,["videoBytes"],ve(o,i));const s=r(e,["encoding"]);return s!=null&&a(t,["mimeType"],s),t}function Rf(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],kf(o,n)),t}function Nf(o,e){const t={},n=r(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Rf(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function Pf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response","generateVideoResponse"]);return u!=null&&a(t,["response"],Nf(o,u)),t}function Df(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["videoBytes"],ve(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function Lf(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],Df(o,n)),t}function bf(o,e){const t={},n=r(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Lf(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function vi(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],bf(o,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vf extends st{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;return n&&"httpOptions"in n&&(s=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=wf(this.apiClient,e);return u=S("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>vi(this.apiClient,f))}else{const c=Af(this.apiClient,e);return u=S("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>Pf(this.apiClient,f))}}async fetchPredictVideosOperationInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Mf(this.apiClient,e);return s=S("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>vi(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Ff(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function Bf(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Ff(o,n,t)),t}function Gf(o,e){const t={},n=r(e,["textInput"]);n!=null&&a(t,["textInput"],n);const i=r(e,["output"]);return i!=null&&a(t,["output"],i),t}function Of(o,e){const t={};if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(e,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Gf(o,s))),a(t,["examples","examples"],i)}return t}function qf(o,e,t){const n={};if(r(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&a(t,["displayName"],i),r(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=r(e,["epochCount"]);t!==void 0&&s!=null&&a(t,["tuningTask","hyperparameters","epochCount"],s);const l=r(e,["learningRateMultiplier"]);if(l!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),r(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=r(e,["batchSize"]);t!==void 0&&u!=null&&a(t,["tuningTask","hyperparameters","batchSize"],u);const d=r(e,["learningRate"]);return t!==void 0&&d!=null&&a(t,["tuningTask","hyperparameters","learningRate"],d),n}function Hf(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["trainingDataset"]);i!=null&&a(t,["tuningTask","trainingData"],Of(o,i));const s=r(e,["config"]);return s!=null&&a(t,["config"],qf(o,s,t)),t}function $f(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Jf(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function Yf(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Jf(o,n,t)),t}function zf(o,e,t){const n={},i=r(e,["gcsUri"]);if(t!==void 0&&i!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],i),r(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Kf(o,e){const t={},n=r(e,["gcsUri"]);return n!=null&&a(t,["validationDatasetUri"],n),t}function Wf(o,e,t){const n={},i=r(e,["validationDataset"]);t!==void 0&&i!=null&&a(t,["supervisedTuningSpec"],Kf(o,i));const s=r(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&a(t,["tunedModelDisplayName"],s);const l=r(e,["description"]);t!==void 0&&l!=null&&a(t,["description"],l);const u=r(e,["epochCount"]);t!==void 0&&u!=null&&a(t,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=r(e,["learningRateMultiplier"]);t!==void 0&&d!=null&&a(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const c=r(e,["exportLastCheckpointOnly"]);t!==void 0&&c!=null&&a(t,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const f=r(e,["adapterSize"]);if(t!==void 0&&f!=null&&a(t,["supervisedTuningSpec","hyperParameters","adapterSize"],f),r(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Zf(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["trainingDataset"]);i!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],zf(o,i,t));const s=r(e,["config"]);return s!=null&&a(t,["config"],Wf(o,s,t)),t}function Xf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["model"],n);const i=r(e,["name"]);return i!=null&&a(t,["endpoint"],i),t}function as(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["state"]);i!=null&&a(t,["state"],Yi(o,i));const s=r(e,["createTime"]);s!=null&&a(t,["createTime"],s);const l=r(e,["tuningTask","startTime"]);l!=null&&a(t,["startTime"],l);const u=r(e,["tuningTask","completeTime"]);u!=null&&a(t,["endTime"],u);const d=r(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const c=r(e,["description"]);c!=null&&a(t,["description"],c);const f=r(e,["baseModel"]);f!=null&&a(t,["baseModel"],f);const p=r(e,["_self"]);p!=null&&a(t,["tunedModel"],Xf(o,p));const m=r(e,["distillationSpec"]);m!=null&&a(t,["distillationSpec"],m);const h=r(e,["experiment"]);h!=null&&a(t,["experiment"],h);const g=r(e,["labels"]);g!=null&&a(t,["labels"],g);const y=r(e,["pipelineJob"]);y!=null&&a(t,["pipelineJob"],y);const C=r(e,["tunedModelDisplayName"]);return C!=null&&a(t,["tunedModelDisplayName"],C),t}function Qf(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>as(o,l))),a(t,["tuningJobs"],s)}return t}function jf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);return l!=null&&a(t,["error"],l),t}function ep(o,e){const t={},n=r(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const i=r(e,["epoch"]);i!=null&&a(t,["epoch"],i);const s=r(e,["step"]);s!=null&&a(t,["step"],s);const l=r(e,["endpoint"]);return l!=null&&a(t,["endpoint"],l),t}function tp(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],n);const i=r(e,["endpoint"]);i!=null&&a(t,["endpoint"],i);const s=r(e,["checkpoints"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>ep(o,u))),a(t,["checkpoints"],l)}return t}function xn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["state"]);i!=null&&a(t,["state"],Yi(o,i));const s=r(e,["createTime"]);s!=null&&a(t,["createTime"],s);const l=r(e,["startTime"]);l!=null&&a(t,["startTime"],l);const u=r(e,["endTime"]);u!=null&&a(t,["endTime"],u);const d=r(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const c=r(e,["error"]);c!=null&&a(t,["error"],c);const f=r(e,["description"]);f!=null&&a(t,["description"],f);const p=r(e,["baseModel"]);p!=null&&a(t,["baseModel"],p);const m=r(e,["tunedModel"]);m!=null&&a(t,["tunedModel"],tp(o,m));const h=r(e,["supervisedTuningSpec"]);h!=null&&a(t,["supervisedTuningSpec"],h);const g=r(e,["tuningDataStats"]);g!=null&&a(t,["tuningDataStats"],g);const y=r(e,["encryptionSpec"]);y!=null&&a(t,["encryptionSpec"],y);const C=r(e,["partnerModelTuningSpec"]);C!=null&&a(t,["partnerModelTuningSpec"],C);const x=r(e,["distillationSpec"]);x!=null&&a(t,["distillationSpec"],x);const w=r(e,["experiment"]);w!=null&&a(t,["experiment"],w);const M=r(e,["labels"]);M!=null&&a(t,["labels"],M);const R=r(e,["pipelineJob"]);R!=null&&a(t,["pipelineJob"],R);const N=r(e,["tunedModelDisplayName"]);return N!=null&&a(t,["tunedModelDisplayName"],N),t}function np(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>xn(o,l))),a(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class op extends st{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new $t($e.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const n=await this.tuneMldevInternal(t);let i="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?i=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:fn.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=$f(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>xn(this.apiClient,f))}else{const c=Uf(this.apiClient,e);return u=S("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>as(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Yf(this.apiClient,e);return u=S("tuningJobs",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=np(this.apiClient,f),m=new Ko;return Object.assign(m,p),m})}else{const c=Bf(this.apiClient,e);return u=S("tunedModels",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Qf(this.apiClient,f),m=new Ko;return Object.assign(m,p),m})}}async tuneInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Zf(this.apiClient,e);return s=S("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>xn(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Hf(this.apiClient,e);return s=S("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>jf(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ip{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const sp=1024*1024*8,rp=3,ap=1e3,lp=2,Zt="x-goog-upload-status";async function up(o,e,t){var n,i,s;let l=0,u=0,d=new pn(new Response),c="upload";for(l=o.size;u<l;){const p=Math.min(sp,l-u),m=o.slice(u,u+p);u+p>=l&&(c+=", finalize");let h=0,g=ap;for(;h<rp&&(d=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((n=d==null?void 0:d.headers)===null||n===void 0)&&n[Zt]));)h++,await dp(g),g=g*lp;if(u+=p,((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[Zt])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[Zt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function cp(o){return{size:o.size,type:o.type}}function dp(o){return new Promise(e=>setTimeout(e,o))}class fp{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await up(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cp(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pp{create(e,t,n){return new mp(e,t,n)}}class mp{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ci="x-goog-api-key";class hp{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(Ci)===null&&e.append(Ci,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gp="gl-node/";class ls{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=hr(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const i=new hp(this.apiKey);this.apiClient=new uf({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:gp+"web",uploader:new fp,downloader:new ip}),this.models=new If(this.apiClient),this.live=new Tf(this.apiClient,i,new pp),this.chats=new La(this.models,this.apiClient),this.caches=new Na(this.apiClient),this.files=new za(this.apiClient),this.operations=new Vf(this.apiClient),this.tunings=new op(this.apiClient)}}const yp={low:"Identify only the most essential and defining grammar patterns of the sentence. Focus on major conjunctions, verb conjugations (tense/politeness), and sentence-ending particles. Avoid breaking down common compound words or very simple phrases.",medium:"Provide a balanced analysis. Identify all major grammar patterns, common set phrases, and important vocabulary usage. This is the standard level of detail suitable for most learners.",high:"Perform an exhaustive analysis. Identify every possible grammatical pattern, nuance, idiomatic expression, and compound word structure, no matter how small or common. Deconstruct everything for a very detailed view for advanced study."};function vp(o){return`You are an advanced linguistic analysis model, acting as a patient, insightful teacher of the Japanese language.
Your primary task is to take a single Japanese sentence and produce a detailed, structured analysis according to the specified JSON schema. Your explanations should be clear enough for a language learner.

Detailed Task Breakdown:
1.  **Sentence Analysis**: Deconstruct the input sentence into its smallest meaningful components (words, particles, etc.).
    For each component in the 'analysis' array:
    *   **Grammatical Category**: Assign a highly specific category. Use the format \`BASE_TYPE-FORM-TENSE-POLARITY\`.
        *   Examples: \`VERB_GODAN-TE-PAST-AFFIRMATIVE\`, \`ADJECTIVE_I-PLAIN-PRESENT-NEGATIVE\`, \`NOUN_COMMON\`.
        *   Available Categories: NOUN_COMMON, NOUN_PROPER, NOUN_PRONOUN, NOUN_COUNTER, VERB_ICHIDAN, VERB_GODAN, VERB_IRREGULAR, VERB_SURU, ADJECTIVE_I, ADJECTIVE_NA, ADVERB, PARTICLE, AUXILIARY_VERB, GRAMMATICAL_AUXILIARY, CONJUNCTION, INTERJECTION, SUFFIX, PREFIX, PUNCTUATION.
    *   **Reading**: Provide the reading in Hiragana or Katakana.
    *   **English Equivalent**: Provide a concise English meaning.
    *   **Pitch Accent**: THIS IS A CRITICAL, MANDATORY FIELD.
        *   Provide the standard Tokyo-dialect pitch accent as a string of 'H' (High) and 'L' (Low).
        *   **RULE: The length of the 'pitch_accent' string MUST EXACTLY match the character length of the 'reading' string.**
        *   Example: If 'reading' is 'ねこ' (2 chars), 'pitch_accent' MUST be 'LH' (2 chars).
        *   Example: If 'reading' is 'ともだち' (4 chars), 'pitch_accent' (heiban) MUST be 'LHHH' (4 chars).
        *   For particles or single-mora words with no accent drop, use the appropriate single letter ('H' or 'L').
        *   If pitch is truly not applicable (like punctuation), provide an empty string "". DO NOT OMIT THE FIELD. Avoid common pitfalls like providing a pattern shorter than the reading.

2.  **Full Translation**: Provide a natural, fluent English translation of the entire sentence.

3.  **Grammar & Phrase Explanations**: In the 'grammar_patterns' array, identify and explain all notable grammar points, set phrases, or nuanced vocabulary.
    *   **Analysis Thoroughness Level: ${o.toUpperCase()}**
    *   **Instruction: ${yp[o]}**
    *   For each pattern, provide its name, a clear explanation for a learner, and the 'constituent_indices' that form the pattern in the 'analysis' array. This section must be comprehensive according to the specified thoroughness level.

Input is a single Japanese sentence. You must respond ONLY with the JSON object defined in the schema. Do not add any conversational text or markdown fences.`}function Cp(){return`You are a Japanese language teaching assistant.
Your task is to provide 2-3 simple, distinct, and pedagogically useful example sentences for the Japanese grammar pattern provided as the user input.

For each example sentence, you MUST provide:
1.  'japanese': The full sentence in Japanese, using Kanji where appropriate.
2.  'reading': The complete furigana reading of the sentence in Hiragana.
3.  'english': A natural and accurate English translation.
4.  'highlight_indices': A two-element array \`[startIndex, endIndex]\` indicating the exact location of the grammar pattern within the 'japanese' string. 'startIndex' is the zero-based index of the first character of the pattern, and 'endIndex' is the zero-based index of the character immediately AFTER the last character of the pattern.

Example for pattern "〜について":
If the user input is "〜について" and a sentence is "日本の文化について話します。", the pattern "について" starts at index 5 and ends at index 9. So, 'highlight_indices' would be [5, 9].

Respond ONLY with a JSON object that adheres to the provided schema. Do not add any extra text or markdown fences.`}const Tp={type:"OBJECT",properties:{original_japanese_sentence:{type:"STRING",description:"The original Japanese sentence provided by the user."},analysis:{type:"ARRAY",description:"An array of objects, each representing a segmented component of the Japanese sentence.",items:{type:"OBJECT",properties:{japanese_segment:{type:"STRING",description:"The individual Japanese segment (word, particle, etc.)."},reading:{type:"STRING",description:"The reading of the Japanese segment in Hiragana or Katakana."},category:{type:"STRING",description:"A highly specific grammatical category label for the segment (e.g., 'NOUN_COMMON', 'VERB_ICHIDAN-TE-PAST-AFFIRMATIVE')."},english_equivalent:{type:"STRING",description:"A direct, concise English equivalent of the segment."},pitch_accent:{type:"STRING",description:`CRITICAL: A string representing the pitch accent pattern using 'H' for high and 'L' for low. This string's length MUST exactly match the character length of the 'reading' field. For heiban words, use 'L' followed by all 'H's (e.g., reading 'ともだち' -> pitch 'LHHH'). For non-applicable segments like punctuation, this MUST be an empty string "". Do not omit this field.`}},required:["japanese_segment","reading","category","english_equivalent","pitch_accent"]}},grammar_patterns:{type:"ARRAY",description:"A comprehensive array of identified grammatical patterns, idiomatic phrases, or nuanced vocabulary in the sentence.",items:{type:"OBJECT",properties:{pattern_name:{type:"STRING",description:"The name of the grammatical pattern or the phrase being explained (e.g., '〜なければならない', 'よろしくお願いします')."},explanation:{type:"STRING",description:"A detailed explanation of the pattern's meaning, usage, and nuance for a language learner."},constituent_indices:{type:"ARRAY",description:"An array of zero-based indices from the 'analysis' array that form this pattern.",items:{type:"NUMBER"}}},required:["pattern_name","explanation","constituent_indices"]}},english_translation:{type:"STRING",description:"The complete, natural-sounding English translation of the entire Japanese sentence."}},required:["original_japanese_sentence","analysis","grammar_patterns","english_translation"]},_p={type:"ARRAY",description:"An array of 2-3 simple example sentences for the given grammar pattern.",items:{type:"OBJECT",properties:{japanese:{type:"STRING",description:"The full example sentence in Japanese, including Kanji."},reading:{type:"STRING",description:"The complete reading of the Japanese sentence in Hiragana."},english:{type:"STRING",description:"The natural English translation of the sentence."},highlight_indices:{type:"ARRAY",description:"A two-element array [startIndex, endIndex] indicating the character position of the grammar pattern within the 'japanese' string. startIndex is inclusive, endIndex is exclusive.",items:{type:"NUMBER"},minItems:2,maxItems:2}},required:["japanese","reading","english","highlight_indices"]}};async function us(o,e=3,t=1e3){let n=0,i=t;for(;;)try{return await o()}catch(s){const l=(s.message||"").toLowerCase();if((l.includes("429")||l.includes("resource_exhausted"))&&n<e){n++;const d=Math.random()*500;console.warn(`Rate limit hit. Retrying in ${Math.round(i+d)}ms... (Attempt ${n}/${e})`),await new Promise(c=>setTimeout(c,i+d)),i*=2}else throw s}}async function Ep(o,e,t){return us(async()=>{var f;const i=new ls({apiKey:o}),s=vp(t),u=(await i.models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:e,config:{systemInstruction:s,responseMimeType:"application/json",responseSchema:Tp,temperature:.1,seed:42}})).text,d=((f=u.trim().match(/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s))==null?void 0:f[1])||u.trim(),c=JSON.parse(d);return Array.isArray(c)?c[0]:c})}async function xp(o,e){const t=async()=>{var u;const n=new ls({apiKey:o}),i=Cp(),s=await n.models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:e,config:{systemInstruction:i,responseMimeType:"application/json",responseSchema:_p,temperature:.01,seed:42}});let l=((u=s.text.trim().match(/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s))==null?void 0:u[1])||s.text.trim();return JSON.parse(l)};try{return await us(t)}catch(n){throw console.error(`Failed to get examples for "${e}":`,n),new Error(`Could not generate examples for ${e}.`)}}function rt(o,e="main",t){const n=Rs(o,t);e==="analysis"?G.innerHTML=n:(Bt.classList.remove("hidden"),q.classList.add("hidden"),z.innerHTML=n,G.innerHTML="")}function cs(){if(!H){const o=document.createElement("button");o.className="fixed bottom-5 right-5 w-12 h-12 bg-sky-600 text-white rounded-full shadow-lg flex items-center justify-center text-2xl font-bold opacity-0 invisible transform translate-y-5 transition-all duration-300 hover:bg-sky-700 z-50",o.innerHTML="&#8679;",o.title="Back to analyzed sentence",document.body.appendChild(o),gs(o)}}function Ti(){const o=z.querySelector(".clickable-sentence.selected");if(!o)return;cs(),H&&(H.onclick=()=>o.scrollIntoView({behavior:"smooth",block:"center"}),H.title="Back to analyzed sentence"),_e&&_e.disconnect();const e=new IntersectionObserver(([t])=>{H==null||H.classList.toggle("opacity-0",t.isIntersecting),H==null||H.classList.toggle("invisible",t.isIntersecting),H==null||H.classList.toggle("translate-y-5",t.isIntersecting)},{root:null,threshold:.1});e.observe(z),Ei(e)}function Ie(){try{K.sort((o,e)=>e.updatedAt-o.updatedAt),localStorage.setItem(ms,JSON.stringify(K))}catch(o){console.error("Failed to save history to localStorage",o)}}function Sp(){try{const o=localStorage.getItem(ms);o&&en(JSON.parse(o))}catch(o){console.error("Failed to load or parse history from localStorage",o),en([])}Fe()}function Ip(){const o=()=>{nn.classList.remove("translate-x-full"),ct.classList.remove("invisible","opacity-0")},e=()=>{nn.classList.add("translate-x-full"),ct.classList.add("invisible","opacity-0")};Ai.addEventListener("click",o),wi.addEventListener("click",e),ct.addEventListener("click",e),kn.addEventListener("click",()=>{K.length!==0&&on("Are you sure you want to delete all your saved texts? This cannot be undone.",()=>{Cs(),Ie(),Fe(),$&&_t()},{confirmText:"Delete All"})}),Tt.addEventListener("click",t=>{const i=t.target.closest("[data-action]");if(!i)return;const{action:s,entryId:l}=i.dataset;if(!s||!l)return;const u=Z(l);if(u)switch(s){case"load":e(),localStorage.removeItem("japanese-analyzer-unsaved-title"),localStorage.removeItem("japanese-analyzer-unsaved-text"),Vn(l);break;case"delete":on(`Are you sure you want to delete "${u.title}"?`,()=>{const d=$===l;vs(l),Ie(),Fe(),d&&_t()},{confirmText:"Delete"});break}})}function Ap(){Sp(),Ip()}async function Yt(o,e,t){var i;const n=(i=o.analyzedSentences[e])==null?void 0:i[t];if(n)return n;if(!Pe)throw new Error("API Key is not configured. Please add one in the settings menu.");try{const s=await Ep(Pe,e.trim(),t);return ys(e,s,t),Ie(),Fe(),s}catch(s){throw console.error(`Analysis failed for: "${e}"`,s),s}}async function wp(o,e){var i;const t=o.text.split(`
`).flatMap(s=>{var l;return((l=s.match(/[^。？！\s]+[。？！]?/g))==null?void 0:l.filter(u=>u==null?void 0:u.trim()))||[]}),n=e+1;if(n<t.length){const s=t[n];(i=o.analyzedSentences[s])!=null&&i[he]||(console.log(`Prefetching analysis for: "${s}"`),Yt(o,s,he).catch(l=>{console.warn(`Prefetch failed for sentence ${n+1}:`,l.message)}))}}async function Nt(o,e){const t=o.text.split(`
`).flatMap(s=>{var l;return((l=s.match(/[^。？！\s]+[。？！]?/g))==null?void 0:l.filter(u=>u==null?void 0:u.trim()))||[]});if(e>=t.length||t.length===0){Vn(o.id);return}const n=t[e],i=t.length;Ds(),Ps(e,i);try{const s=await Yt(o,n,he);Ns(o,e,s),oe(),_e&&_e.disconnect(),je&&window.removeEventListener("scroll",je),cs();const l=H;if(l){l.onclick=()=>window.scrollTo({top:0,behavior:"smooth"}),l.title="Scroll to top",l.classList.add("opacity-0","invisible","translate-y-5");const u=()=>{if(q.classList.contains("hidden"))return;const d=window.scrollY>window.innerHeight/2;l.classList.toggle("opacity-0",!d),l.classList.toggle("invisible",!d),l.classList.toggle("translate-y-5",!d)};window.addEventListener("scroll",u),xi(u)}await wp(o,e)}catch(s){const l=s instanceof Error?s:new Error("An unknown error occurred during analysis."),{main:u,detail:d}=Nn(l);rt(u,"main",d)}}function Vn(o){const e=Z(o);e&&(Vi(),De.classList.add("hidden"),Te.value=e.title,fe.value=e.text,In(o),Ot(e),G.innerHTML='<p class="text-center p-8 text-slate-500">Select a sentence to analyze, or start reading mode.</p>',it())}const ds=[{label:"XX-Small",value:"0.75"},{label:"X-Small",value:"0.85"},{label:"Small",value:"1.0"},{label:"Medium",value:"1.15"},{label:"Large",value:"1.3"},{label:"X-Large",value:"1.5"}],_i=2;function fs(){const o=localStorage.getItem(bt)||"light";document.documentElement.classList.toggle("dark",o==="dark"),Ze.checked=o==="dark";const e=localStorage.getItem(Vt)==="true";Le.checked=!e;const t=localStorage.getItem(Ut)!=="false";be.checked=!t;const n=localStorage.getItem(Ft)!=="false";et.checked=!n,oe();const i=localStorage.getItem(Lt),s=i&&Xt.includes(i)?i:"medium";Si(s);const l=Xt.indexOf(s);vt.value=String(l),An.textContent=s.charAt(0).toUpperCase()+s.slice(1);const u=ds,d=localStorage.getItem(hs),c=d?parseInt(d,10):_i,f=c>=0&&c<u.length?c:_i;if(f>=0&&f<u.length){const h=u[f];document.documentElement.style.setProperty("--font-size-multiplier",h.value),Ct.value=String(f),wn.textContent=h.label}const p=localStorage.getItem(Sn);jt(p||void 0||null),Re.value="",p?(Re.placeholder="API key saved",de.textContent="Using key from local storage.",de.classList.remove("text-amber-500","font-semibold")):(de.textContent="No API key found. Please add one.",de.classList.add("text-amber-500","font-semibold")),it()}function Mp(){Ze.addEventListener("change",()=>{var t;const o=Ze.checked?"dark":"light";document.documentElement.classList.toggle("dark",Ze.checked),localStorage.setItem(bt,o);const e=z.querySelector(".clickable-sentence.selected");if(e!=null&&e.dataset.sentence&&$){const n=Z($),i=(t=n==null?void 0:n.analyzedSentences[e.dataset.sentence])==null?void 0:t[he];i&&(nt(G,i),oe())}})}function kp(){Le.addEventListener("change",()=>{const o=!Le.checked;localStorage.setItem(Vt,String(o)),oe()}),be.addEventListener("change",()=>{const o=!be.checked;localStorage.setItem(Ut,String(o)),oe()}),et.addEventListener("change",()=>{const o=!et.checked;localStorage.setItem(Ft,String(o)),oe()})}function Rp(){vt.addEventListener("input",()=>{const o=Xt[parseInt(vt.value,10)];if(An.textContent=o.charAt(0).toUpperCase()+o.slice(1),Si(o),localStorage.setItem(Lt,o),$){const e=Z($);if(!e)return;if(Ot(e),!q.classList.contains("hidden")){Nt(e,e.readingProgress);return}const t=z.querySelector(".clickable-sentence.selected");if(t!=null&&t.dataset.sentence){const n=t.dataset.sentence;G.innerHTML=`<p class="text-center p-8 text-slate-500">Analyzing with new '${o}' setting...</p>`,Yt(e,n,o).then(i=>{nt(G,i),oe()}).catch(i=>{const s=i instanceof Error?i:new Error(String(i)),{main:l,detail:u}=Nn(s);rt(l,"analysis",u)})}}})}function Np(){const o=ds;Ct.addEventListener("input",()=>{const e=parseInt(Ct.value,10);if(e>=0&&e<o.length){const t=o[e];document.documentElement.style.setProperty("--font-size-multiplier",t.value),wn.textContent=t.label,localStorage.setItem(hs,String(e))}})}function Pp(){Ri.addEventListener("click",()=>{const o=Re.value.trim();o?(localStorage.setItem(Sn,o),jt(o),Re.value="",Re.placeholder="API key saved",de.textContent="✅ Key saved and is now active.",de.classList.remove("text-amber-500","font-semibold")):(localStorage.removeItem(Sn),jt(null),de.textContent="User-defined key removed. Falling back to built-in key if available."),it()})}function Dp(){ki.addEventListener("click",()=>{const o={version:"1.0",exportedAt:Date.now(),history:K,settings:{[bt]:localStorage.getItem(bt),[Vt]:localStorage.getItem(Vt),[Ut]:localStorage.getItem(Ut),[Ft]:localStorage.getItem(Ft),[Lt]:localStorage.getItem(Lt)}},e=JSON.stringify(o,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n;const s=new Date().toISOString().split("T")[0];i.download=`japanese-analyzer-backup-${s}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}),dt.addEventListener("change",()=>{var t;const o=(t=dt.files)==null?void 0:t[0];if(!o)return;const e=new FileReader;e.onload=n=>{var i;try{const s=JSON.parse((i=n.target)==null?void 0:i.result);if(!s.history||!s.settings)throw new Error("Invalid backup file structure.");on("Importing will overwrite your current history and settings. Are you sure you want to continue?",()=>{Object.keys(s.settings).forEach(l=>{const u=s.settings[l];u!=null?localStorage.setItem(l,u):localStorage.removeItem(l)}),en(s.history),Ie(),fs(),Fe(),_t(),Hn("Import successful! Your data and settings have been updated.")},{confirmText:"Import",confirmClass:"bg-sky-600 hover:bg-sky-700"})}catch(s){Hn(`Import failed: ${s instanceof Error?s.message:"Could not read file."}`)}finally{dt.value=""}},e.readAsText(o)})}function Lp(){tn.addEventListener("click",o=>{o.stopPropagation(),ze.classList.toggle("hidden")}),document.addEventListener("click",o=>{ze.classList.contains("hidden")||!ze.contains(o.target)&&!tn.contains(o.target)&&ze.classList.add("hidden")})}function bp(){fs(),Lp(),Mp(),kp(),Rp(),Np(),Pp(),Dp()}function ps(o){var i;const e=(i=o.closest(".p-4.rounded-lg"))==null?void 0:i.querySelector("#translation-content");if(!e)return;const t=e.classList.contains("hidden");e.classList.toggle("hidden"),o.setAttribute("aria-expanded",String(!t));const n=o.querySelector(".button-text");n&&(n.textContent=t?"Hide":"Show")}function Vp(){Me.addEventListener("click",async()=>{const o=fe.value;if(!o.trim()){rt("Input Required","main","Please enter some Japanese text to process.");return}const e=Te.value.trim()||o.substring(0,40)+"...";let t=$;if(t){const i=Z(t);if(i){const s=f=>new Set(f.split(`
`).flatMap(p=>{var m;return((m=p.match(/[^。？！\s]+[。？！]?/g))==null?void 0:m.filter(h=>h==null?void 0:h.trim()))||[]})),l=s(i.text),u=s(o),d=i.analyzedSentences,c={};for(const f of u)l.has(f)&&d[f]&&(c[f]=d[f]);i.title=e,i.text=o,i.analyzedSentences=c,i.updatedAt=Date.now(),i.readingProgress=0,yt(i)}else t=null}if(!t){const i=Date.now().toString(),s={id:i,title:e,text:o,createdAt:Date.now(),updatedAt:Date.now(),analyzedSentences:{},readingProgress:0};yt(s),In(i)}Ie(),Fe(),localStorage.setItem(Pt,e),localStorage.setItem(Dt,o);const n=Z($);Ot(n),De.classList.add("hidden"),G.innerHTML='<p class="text-center p-8 text-neutral-500">Select a sentence to analyze, or start reading mode.</p>'})}function Up(){le.addEventListener("click",async o=>{var s,l;if(!q.classList.contains("hidden"))return;const e=o.target,t=e.closest("#toggle-translation-button");if(t){ps(t);return}if(e.closest("#start-reading-button")){if($){const u=Z($);u&&await Nt(u,u.readingProgress)}return}if(e.closest("#edit-text-button")){De.classList.remove("hidden"),z.innerHTML="",G.innerHTML="",De.scrollIntoView({behavior:"smooth",block:"start"});return}const n=e.closest(".clickable-sentence");if(n&&z.contains(n)){const u=n.dataset.sentence;if(!u||!$)return;Ue(),z.querySelectorAll(".clickable-sentence").forEach(f=>f.classList.remove("selected","bg-sky-200/60","dark:bg-sky-500/30","font-semibold")),n.classList.add("selected","bg-sky-200/60","dark:bg-sky-500/30","font-semibold");const d=Z($),c=(s=d.analyzedSentences[u])==null?void 0:s[he];if(c)nt(G,c),Ti(),G.scrollIntoView({behavior:"smooth",block:"start"});else{G.innerHTML='<p class="text-center p-8 text-neutral-500">Analyzing sentence...</p>';try{const f=await Yt(d,u,he);Ot(d),(l=z.querySelector(`.clickable-sentence[data-sentence="${CSS.escape(u)}"]`))==null||l.classList.add("selected","bg-sky-200/60","dark:bg-sky-500/30","font-semibold"),nt(G,f),Ti(),G.scrollIntoView({behavior:"smooth",block:"start"})}catch(f){const p=f instanceof Error?f:new Error(String(f)),{main:m,detail:h}=Nn(p);rt(m,"analysis",h),G.scrollIntoView({behavior:"smooth",block:"start"})}}oe();return}if(e.closest("a.underline")){o.stopPropagation();return}const i=e.closest(".segment");if(i&&G.contains(i)){if(o.stopPropagation(),G.querySelector(".is-focused"))return;Ss(i)?Ue():xs(i)}})}function Fp(){le.addEventListener("click",o=>{if(q.classList.contains("hidden"))return;const e=o.target,t=e.closest("#toggle-translation-button");if(t){ps(t);return}const n=$;if(!n)return;const i=Z(n);if(!i)return;let s=i.readingProgress;if(e.closest("#reading-mode-exit")){Vn(n);return}if(e.closest("#reading-nav-next"))s++;else if(e.closest("#reading-nav-prev"))s--;else return;Gn(n,s),Ie(),Nt(i,s)}),le.addEventListener("change",o=>{if(q.classList.contains("hidden"))return;const e=o.target;if(e.id!=="reading-mode-sentence-input")return;const t=$;if(!t)return;const n=Z(t);if(!n)return;const s=n.text.split(`
`).flatMap(u=>{var d;return((d=u.match(/[^。？！\s]+[。？！]?/g))==null?void 0:d.filter(c=>c==null?void 0:c.trim()))||[]}).length;let l=parseInt(e.value,10)-1;if(isNaN(l)||l<0||l>=s){e.value=String(n.readingProgress+1);return}l!==n.readingProgress&&(Gn(t,l),Ie(),Nt(n,l))})}function Bp(){le.addEventListener("click",o=>{const e=o.target.closest("[data-pattern-id]");if(!e)return;const t=e.closest("#analysis-view, #reading-mode-view");if(!t)return;const{patternId:n}=e.dataset;if(!n)return;const i=e.classList.contains("is-focused");t.querySelectorAll("[data-pattern-id]").forEach(s=>s.classList.remove("is-focused","ring-2","ring-sky-500","bg-white","dark:bg-neutral-800")),t.querySelectorAll(".segment").forEach(s=>s.classList.remove("opacity-30")),i||(e.classList.add("is-focused","ring-2","ring-sky-500","bg-white","dark:bg-neutral-800"),t.querySelectorAll(`.segment:not(.${n})`).forEach(l=>l.classList.add("opacity-30")))})}function Gp(){le.addEventListener("click",async o=>{const e=o.target.closest(".show-examples-button");if(!e||e.disabled)return;if(o.preventDefault(),!Pe){rt("API Key Not Found","analysis","Please add your Gemini API key in the settings menu to generate examples.");return}const{patternName:t}=e.dataset,n=e.querySelector(".button-text");if(!n)return;const i=e.nextElementSibling;if(i&&i.classList.contains("examples-container")){i.classList.toggle("hidden"),n.textContent=i.classList.contains("hidden")?"Examples":"Hide";return}e.disabled=!0;const s=e.innerHTML;e.innerHTML='<span class="animate-spin rounded-full h-4 w-4 border-b-2 border-current"></span><span class="button-text">Loading...</span>';try{const l=await xp(Pe,t);e.innerHTML=s;const u=e.querySelector(".button-text");if((l==null?void 0:l.length)>0){const d=document.createElement("div");d.className="examples-container mt-4 pt-4 border-t border-dashed border-neutral-200 dark:border-neutral-700";const c=document.createElement("dl");c.className="flex flex-col gap-4",l.forEach(f=>{const p=document.createElement("dt"),m=document.createElement("dd"),h=bi(f.japanese,f.reading,!1);p.innerHTML=`<span class="text-lg font-jp">${h}</span>`,m.className="text-sm text-neutral-600 dark:text-neutral-400 -mt-1",m.textContent=f.english,c.append(p,m)}),d.appendChild(c),e.insertAdjacentElement("afterend",d),u.textContent="Hide"}else u.textContent="No examples"}catch(l){console.error(l),e.innerHTML=s,e.querySelector(".button-text").textContent="Error"}finally{e.disabled=!1,oe()}})}function Op(){Ii.addEventListener("click",()=>{localStorage.removeItem(Pt),localStorage.removeItem(Dt),_t()})}function qp(){Te.value=localStorage.getItem(Pt)||"",fe.value=localStorage.getItem(Dt)||"",Te.addEventListener("input",()=>{localStorage.setItem(Pt,Te.value)}),fe.addEventListener("input",()=>{localStorage.setItem(Dt,fe.value),it()})}function Hp(){document.addEventListener("keydown",o=>{var l,u;const e=o.target;if(["INPUT","TEXTAREA"].includes(e.tagName)||e.isContentEditable)return;o.key.toLowerCase()==="f"&&(o.preventDefault(),Le.click()),o.key.toLowerCase()==="c"&&(o.preventDefault(),be.click());const t=!q.classList.contains("hidden"),n=t?q:G.innerHTML.trim()?G:null;if(t&&(o.key==="ArrowRight"?(o.preventDefault(),(l=document.getElementById("reading-nav-next"))==null||l.click()):o.key==="ArrowLeft"&&(o.preventDefault(),(u=document.getElementById("reading-nav-prev"))==null||u.click())),!n)return;if(o.key.toLowerCase()==="t"){const d=n.querySelector("#toggle-translation-button");d&&(o.preventDefault(),d.click())}if(o.key.toLowerCase()==="s"){const d=n.querySelector(".tts-button");d&&(o.preventDefault(),d.click())}const i=n.querySelector(".is-focused");o.key==="Escape"&&i&&(o.preventDefault(),i.classList.remove("is-focused","ring-2","ring-sky-500","bg-white","dark:bg-neutral-800"),n.querySelectorAll(".segment").forEach(d=>d.classList.remove("opacity-30")));const s=Array.from(n.querySelectorAll("[data-pattern-id]"));if(s.length>0){const d=s.findIndex(c=>c.classList.contains("is-focused"));if(o.key.toLowerCase()==="j"||o.key.toLowerCase()==="k"){o.preventDefault();let c=d===-1?0:o.key==="j"?d+1:d-1;c>=s.length&&(c=0),c<0&&(c=s.length-1);const f=s[c];if(!f)return;f.click();const p=n.querySelector(".sticky"),m=p?p.getBoundingClientRect().bottom:0,h=f.getBoundingClientRect(),y=window.innerHeight-m;let C;h.height>y?C=m+20:C=m+y/2-h.height/2;const w=h.top-C;window.scrollBy({top:w,left:0,behavior:"smooth"})}if(o.key.toLowerCase()==="e"&&i){o.preventDefault();const c=i.querySelector(".show-examples-button");c==null||c.click()}}})}function $p(){qp(),Vp(),Up(),Fp(),Bp(),Gp(),Op(),Hp()}const ms="japanese-analyzer-history-v2",Pt="japanese-analyzer-unsaved-title",Dt="japanese-analyzer-unsaved-text",Lt="japanese-analyzer-analysis-depth",Sn="japanese-analyzer-api-key",bt="theme",Vt="furigana-hidden",Ut="color-coding-hidden",Ft="pitch-accent-hidden",hs="japanese-analyzer-font-size";function Jp(){bp(),Ap(),$p(),Ts(),Is(),ws(),oe()}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/Jp();

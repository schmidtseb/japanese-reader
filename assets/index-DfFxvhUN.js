(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Xt=["low","medium","high"];let Qt=null,W=[],B=null,ee="medium",Pe=null,$=null,Ee=null,tt=null;function Gn(o){Qt=o}function jt(o){Pe=o}function Cs(o){$=o}function xi(o){Ee=o}function Si(o){tt=o}function An(o){B=o}function Ii(o){ee=o}function en(o){W=o}function J(o){return W.find(e=>e.id===o)}function vt(o){const e=W.findIndex(t=>t.id===o.id);e>-1?W[e]=o:W.unshift(o)}function tn(o,e){const t=J(o);t&&(t.readingProgress=e,t.updatedAt=Date.now(),vt(t))}function Ts(o,e,t){if(!B)return;const n=J(B);n&&(n.analyzedSentences[o]||(n.analyzedSentences[o]={}),n.analyzedSentences[o][t]=e,n.updatedAt=Date.now(),vt(n))}function _s(o){W=W.filter(e=>e.id!==o)}function Es(){W=[]}function xs(){if(!("speechSynthesis"in window)){document.body.classList.remove("tts-available");return}const o=()=>{const e=window.speechSynthesis.getVoices().filter(s=>s.lang==="ja-JP");if(e.length===0){Gn(null),document.body.classList.remove("tts-available");return}const t=e.find(s=>s.name.includes("Google")),n=e.find(s=>!s.localService),i=t||n||e[0]||null;Gn(i),document.body.classList.toggle("tts-available",!!i)};o(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=o)}function Ss(o){if(!("speechSynthesis"in window)||!Qt){console.warn("Speech synthesis not available or no Japanese voice found.");return}window.speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(o);e.voice=Qt,e.lang="ja-JP",e.rate=.9,e.pitch=1,window.speechSynthesis.speak(e)}const Me=document.getElementById("generate-button"),me=document.getElementById("sentence-input"),_e=document.getElementById("text-title-input"),ce=document.getElementById("result-container"),be=document.querySelector(".input-area"),Bt=document.getElementById("main-view"),Y=document.getElementById("reader-view"),G=document.getElementById("analysis-view"),U=document.getElementById("reading-mode-view"),Xe=document.getElementById("theme-checkbox"),De=document.getElementById("furigana-checkbox"),Le=document.getElementById("color-coding-checkbox"),nt=document.getElementById("pitch-accent-checkbox"),Z=document.getElementById("tooltip"),nn=document.getElementById("settings-button"),Ke=document.getElementById("settings-menu"),Ct=document.getElementById("analysis-depth-slider"),wn=document.getElementById("analysis-depth-label"),Tt=document.getElementById("font-size-slider"),Mn=document.getElementById("font-size-label"),Rn=document.getElementById("app-header"),Ai=document.getElementById("new-text-button"),wi=document.getElementById("history-button"),on=document.getElementById("history-panel"),dt=document.getElementById("history-panel-overlay"),Mi=document.getElementById("close-history-button"),kn=document.getElementById("clear-history-button"),_t=document.getElementById("history-list"),Ri=document.getElementById("history-empty-message"),ki=document.getElementById("export-data-button"),Is=document.getElementById("import-data-button"),ft=document.getElementById("import-file-input"),ke=document.getElementById("api-key-input"),Ni=document.getElementById("save-api-key-button"),pe=document.getElementById("api-key-status"),Ve=document.getElementById("modal-overlay"),Gt=document.getElementById("modal-box"),Nn=document.getElementById("modal-message"),he=document.getElementById("modal-confirm-button"),ot=document.getElementById("modal-cancel-button");if(!Me||!me||!_e||!ce||!be||!Bt||!Y||!G||!U||!Xe||!De||!Le||!nt||!Z||!nn||!Ke||!Ai||!wi||!on||!Mi||!kn||!_t||!Ri||!dt||!Ct||!wn||!Tt||!Mn||!ki||!Is||!ft||!ke||!Ni||!pe||!Ve||!Gt||!Nn||!he||!ot||!Rn)throw new Error("Required HTML elements not found at startup.");let le=null,Pi;function Fe(){Z.classList.add("opacity-0","invisible","pointer-events-none"),le&&(le.classList.remove("tooltip-active"),le=null)}const bi=()=>clearTimeout(Pi),On=()=>{Pi=window.setTimeout(Fe,300)};function Di(o){bi();const{reading:e,english:t,patterns:n,category:i,wordUrl:s}=o.dataset;let l="",u="";if(i){const h=i.replace(/_/g," ").split("-").map(g=>g.charAt(0).toUpperCase()+g.slice(1).toLowerCase()).join(", ");u+=`<p class="text-xs text-text-muted"><strong class="font-medium text-text-secondary">Category:</strong> ${h}</p>`}if(u+=`<p class="text-xs text-text-muted mt-1"><strong class="font-medium text-text-secondary">Reading:</strong> ${e||"N/A"}</p>`,u+=`<p class="text-xs text-text-muted mt-1"><strong class="font-medium text-text-secondary">English:</strong> ${t||"N/A"}</p>`,s&&s.includes("http")&&(u+=`<div class="mt-2"><a href="${s}" target="_blank" rel="noopener noreferrer" class="text-xs font-semibold text-accent hover:underline inline-flex items-center gap-1">Search on Jisho <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div>`),u&&(l+=`<div class="mb-3"><h4 class="text-sm font-semibold border-b border-border-subtle pb-1 mb-1 text-text-primary">Word Info</h4>${u}</div>`),n)try{JSON.parse(n).forEach(h=>{l+=`<div class="mb-2 last:mb-0"><div class="flex items-center gap-2 mb-1"><span class="flex-shrink-0 w-3 h-3 rounded-sm bg-${h.idClass}"></span><h4 class="font-semibold text-accent">${h.name}</h4></div><p class="text-xs text-text-muted">${h.explanation}</p></div>`})}catch(h){console.error("Failed to parse patterns JSON",h)}if(!l){Fe();return}Z.innerHTML=l,Z.style.visibility="hidden",Z.classList.remove("opacity-0","invisible","pointer-events-none");const d=o.getBoundingClientRect(),c=Z.getBoundingClientRect(),f=10;let p=d.left+d.width/2-c.width/2;p<f&&(p=f),p+c.width>window.innerWidth-f&&(p=window.innerWidth-c.width-f);let m=d.top-c.height-10;m<f&&(m=d.bottom+10),Z.style.left=`${p}px`,Z.style.top=`${m}px`,Z.style.visibility="visible"}function As(o){le&&le.classList.remove("tooltip-active"),le=o,le.classList.add("tooltip-active"),Di(o)}function ws(o){return le===o}function lt(){return le!==null}function Ms(){ce.addEventListener("mouseover",o=>{if(lt())return;const e=o.target.closest(".segment");e&&Di(e)}),ce.addEventListener("mouseout",o=>{lt()||o.target.closest(".segment")&&On()}),document.addEventListener("click",o=>{if(!lt())return;const e=o.target.closest(".segment"),t=Z.contains(o.target);!e&&!t&&Fe()}),Z.addEventListener("mouseover",bi),Z.addEventListener("mouseout",()=>{lt()||On()})}let Ne=null,pt=null;function Li(){Ve.classList.add("opacity-0","invisible"),Gt.classList.add("scale-95","opacity-0"),Ne=null,pt=null}function Rs(){Ne==null||Ne(),Li()}function qn(){pt==null||pt(),Li()}function ks(){he.addEventListener("click",Rs),ot.addEventListener("click",qn),Ve.addEventListener("click",o=>{o.target===Ve&&qn()})}function sn(o,e,t={}){var i;Nn.textContent=o,Ne=e,he.textContent=t.confirmText||"Confirm",he.className="px-5 py-3 rounded-xl text-base font-medium text-primary-text transition-colors shadow-lg";const n=((i=t.confirmClass)==null?void 0:i.split(" "))||["bg-destructive","hover:bg-destructive-hover"];he.classList.add(...n),ot.textContent=t.cancelText||"Cancel",ot.classList.remove("hidden"),Ve.classList.remove("opacity-0","invisible"),Gt.classList.remove("scale-95","opacity-0")}function Hn(o,e){Nn.textContent=o,Ne=null,he.textContent="OK",he.className="px-5 py-3 rounded-xl text-base font-medium text-primary-text transition-colors shadow-lg",he.classList.add("bg-accent","hover:bg-accent/90"),ot.classList.add("hidden"),Ve.classList.remove("opacity-0","invisible"),Gt.classList.remove("scale-95","opacity-0")}function Ns(o){const e=(o||"unknown").split(/[-_]/)[0].toLowerCase(),t={noun:"bg-pos-noun-bg text-pos-noun-text",verb:"bg-pos-verb-bg text-pos-verb-text",particle:"bg-pos-particle-bg text-pos-particle-text",adjective:"bg-pos-adjective-bg text-pos-adjective-text",adverb:"bg-pos-adverb-bg text-pos-adverb-text",auxiliary:"bg-pos-auxiliary-bg text-pos-auxiliary-text",grammatical:"bg-pos-auxiliary-bg text-pos-auxiliary-text",conjunction:"bg-pos-conjunction-bg text-pos-conjunction-text",suffix:"bg-pos-suffix-bg text-pos-suffix-text",punctuation:"bg-transparent",unknown:"bg-surface-soft"};return t[e]||t.unknown}function $n(o){return o.split("").map(e=>/[一-龯]/.test(e)?`<a href="https://jisho.org/search/${encodeURIComponent(e)}%20%23kanji" target="_blank" rel="noopener noreferrer" class="underline decoration-text-muted/50 decoration-1 underline-offset-2 hover:text-accent hover:decoration-accent transition">${e}</a>`:e).join("")}function Vi(o,e,t){if(!e||o===e)return t?$n(o):o;const n=o.match(/([一-龯]+|[^一-龯]+)/g)||[];let i=0,s="";for(let l=0;l<n.length;l++){const u=n[l];if(/[一-龯]/.test(u)){let c="";const f=l+1<n.length&&!/[一-龯]/.test(n[l+1])?n[l+1]:"",p=f?e.indexOf(f,i):-1;p!==-1?(c=e.substring(i,p),i=p):(c=e.substring(i),i=e.length);const m=t?$n(u):u;s+=c&&c!==u?`<ruby>${m}<rt class="text-xs text-text-muted select-none">${c}</rt></ruby>`:m}else s+=u,e.substring(i).startsWith(u)&&(i+=u.length)}return s}function Ps(o,e){if(!o||!e||o.length!==e.length)return null;const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("class","pitch-accent-svg absolute top-0 left-0 w-full h-[14px] overflow-visible pointer-events-none");const i=e.split("").map((s,l)=>({x:100/o.length*(l+.5),y:s==="H"?2:8}));if(i.length>1){const s=document.createElementNS(t,"polyline");s.setAttribute("points",i.map(l=>`${l.x},${l.y}`).join(" ")),s.setAttribute("class","fill-none stroke-text-muted"),s.setAttribute("stroke-width","1.5"),s.setAttribute("stroke-linecap","round"),s.setAttribute("stroke-linejoin","round"),n.appendChild(s)}return i.forEach(s=>{const l=document.createElementNS(t,"circle");l.setAttribute("cx",String(s.x)),l.setAttribute("cy",String(s.y)),l.setAttribute("r","1.2"),l.setAttribute("class","fill-text-muted"),n.appendChild(l)}),n.setAttribute("viewBox","0 0 100 10"),n.setAttribute("preserveAspectRatio","none"),n}function Fi(o,e){return`
    <div role="alert" class="p-4 bg-destructive-subtle-bg border-l-4 border-destructive rounded-r-lg shadow-md my-4 transition-all duration-300">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-destructive" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3 flex-1">
          <p class="text-sm font-semibold text-destructive-subtle-text">${o}</p>
          ${e?`<div class="mt-2 text-sm text-destructive-subtle-text/80"><p>${e}</p></div>`:""}
        </div>
      </div>
    </div>
  `}function Ui(o,e,t={}){const{stickyTopClass:n="top-0"}=t;o.innerHTML="";const i=document.createElement("div");i.className=`sticky ${n} z-10 bg-surface pt-2 rounded-b-lg`,o.appendChild(i);const s=document.createElement("div");s.className="p-4 bg-surface-soft rounded-lg";const l=document.createElement("div");l.className="flex items-center gap-4 text-2xl";const u=document.createElement("p");u.className="flex-grow text-text-muted font-japanese font-medium",u.textContent=e;const d=document.createElement("div");d.className="animate-spin rounded-full h-5 w-5 border-b-2 border-accent flex-shrink-0",l.append(u,d),s.appendChild(l),i.appendChild(s);const c=document.createElement("div");c.className="px-4 pt-14 md:pt-8 pb-4 text-center text-text-muted",c.textContent="Fetching analysis and grammar notes...",o.appendChild(c)}function Ue(o,e,t={}){var u,d;const{stickyTopClass:n="top-0"}=t;o.innerHTML="";const i=[],s=document.createElement("div");s.className=`sticky ${n} z-10 bg-surface transition-colors duration-300 pt-2 rounded-b-lg`,o.appendChild(s);const l=document.createElement("div");if(l.className="px-4 pt-14 md:pt-8 pb-4",o.appendChild(l),((u=e.analysis)==null?void 0:u.length)>0){const c=document.createElement("div");c.className="p-4 bg-surface-soft rounded-lg max-h-[50vh] overflow-y-auto";const f=document.createElement("div");f.className="flex-grow flex flex-wrap items-center gap-x-1.5 gap-y-1 text-2xl",e.analysis.forEach(y=>{const C=document.createElement("span");if(C.className=`segment relative inline-block rounded-md px-2 py-1 cursor-pointer transition-transform duration-200 hover:-translate-y-0.5 leading-loose ${Ns(y.category)}`,C.dataset.reading=y.reading,C.dataset.english=y.english_equivalent,C.dataset.category=y.category,C.dataset.wordUrl=`https://jisho.org/search/${encodeURIComponent(y.japanese_segment)}`,y.category!=="PUNCTUATION"){const S=Ps(y.reading,y.pitch_accent);S&&C.appendChild(S)}const x=document.createElement("div");x.innerHTML=Vi(y.japanese_segment,y.reading,!0),C.appendChild(x),f.appendChild(C),i.push(C)});const p=document.createElement("div");p.className="flex items-center gap-1.5 ml-2 self-center";const m=document.createElement("button");m.id="re-analyze-button",m.className="inline-flex items-center justify-center w-8 h-8 rounded-full bg-surface text-accent hover:bg-accent-subtle-bg transition align-middle",m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.667 0l3.181-3.183m-4.991-2.691V6.168" /></svg>',m.title="Re-analyze sentence";const h=document.createElement("button");h.className="tts-button inline-flex items-center justify-center w-8 h-8 rounded-full bg-surface text-accent hover:bg-accent-subtle-bg transition align-middle",h.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg>',h.title="Read sentence aloud (S)",h.onclick=y=>{y.preventDefault(),Ss(e.original_japanese_sentence)};const g=document.createElement("kbd");g.className="hidden sm:inline font-sans text-xs font-semibold text-text-muted border border-strong rounded px-1.5 py-0.5",g.textContent="S",p.append(m,h,g),f.appendChild(p),c.appendChild(f),s.appendChild(c)}if(e.english_translation){const c=document.createElement("div"),f=document.createElement("div");f.className="bg-surface-subtle p-4 rounded-lg";const p=document.createElement("div");p.className="flex justify-between items-center";const m=document.createElement("h3");m.className="text-base font-semibold text-text-secondary",m.textContent="English Translation";const h=document.createElement("button");h.id="toggle-translation-button",h.className="text-xs font-semibold px-2 py-1 rounded-md border border-strong text-text-muted hover:bg-surface-hover transition inline-flex items-center gap-1.5",h.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
          <span class="button-text">Show</span>
          <kbd class="ml-1 font-sans text-xs font-semibold text-text-muted border border-strong rounded px-1.5 py-0.5">T</kbd>
      `,h.setAttribute("aria-controls","translation-content"),h.setAttribute("aria-expanded","false"),h.title="Toggle translation visibility (Hotkey: T)",p.append(m,h);const g=document.createElement("div");g.id="translation-content",g.className="hidden mt-3 pt-3 border-t border-dashed border-border-subtle",g.innerHTML=`<p class="text-base italic text-text-secondary">${e.english_translation}</p>`,f.append(p,g),c.appendChild(f),l.appendChild(c)}if(((d=e.grammar_patterns)==null?void 0:d.length)>0){const c=document.createElement("div");c.className="mt-6",c.innerHTML='<h3 class="text-base font-semibold border-b border-border-subtle pb-2 mb-3 text-text-primary">Grammar & Vocabulary Notes</h3>';const f=document.createElement("ul");f.className="flex flex-col gap-3";const p=new Map;e.grammar_patterns.forEach((h,g)=>{var I;const y=g%12,C=`pattern-${y}`,x={name:h.pattern_name,explanation:h.explanation,idClass:C,colorIndex:y};(I=h.constituent_indices)==null||I.forEach(k=>{p.has(k)||p.set(k,[]),p.get(k).push(x)});const S=document.createElement("li");S.className="flex gap-4 p-4 rounded-lg bg-surface-subtle cursor-pointer transition-all duration-200",S.dataset.patternId=C,S.innerHTML=`
          <span class="flex-shrink-0 w-1.5 rounded-full bg-pattern-${y}"></span>
          <div class="flex-grow">
              <strong class="font-semibold text-accent">${h.pattern_name}</strong>
              <p class="text-sm text-text-muted mt-1">${h.explanation}</p>
              <button class="show-examples-button mt-3 text-xs font-semibold px-2 py-1 rounded-md border border-accent text-accent hover:bg-accent hover:text-primary-text transition inline-flex items-center gap-2 disabled:opacity-50" data-pattern-name="${h.pattern_name}">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
                </svg>
                <span class="button-text">Examples</span>
              </button>
          </div>
      `,f.appendChild(S)}),p.forEach((h,g)=>{const y=i[g];if(y&&h.length>0){y.dataset.patterns=JSON.stringify(h.map(({name:I,explanation:k,idClass:D})=>({name:I,explanation:k,idClass:D})));const C=2,x=3;y.style.paddingBottom=`${4+h.length*C+(h.length-1)*x}px`;const S=h.map(I=>`linear-gradient(to top, rgb(var(--color-${I.idClass}-rgb)) 0%, rgb(var(--color-${I.idClass}-rgb)) 100%)`);y.style.backgroundImage=S.join(", "),y.style.backgroundSize=h.map(()=>`100% ${C}px`).join(", "),y.style.backgroundPosition=h.map((I,k)=>`0 calc(100% - ${k*(C+x)}px)`).join(", "),y.style.backgroundRepeat="no-repeat",y.classList.add("grammar-pattern",...h.map(I=>I.idClass))}}),c.appendChild(f);const m=document.createElement("p");m.className="text-xs text-center text-text-muted mt-4 px-4",m.innerHTML='Tip: Use <kbd class="font-sans border rounded px-1.5 py-0.5 border-strong">J</kbd>/<kbd class="font-sans border rounded px-1.5 py-0.5 border-strong">K</kbd> to navigate patterns, <kbd class="font-sans border rounded px-1.5 py-0.5 border-strong">E</kbd> for examples, and <kbd class="font-sans border rounded px-1.5 py-0.5 border-strong">Esc</kbd> to clear focus.',c.appendChild(m),l.appendChild(c)}}function Ot(o){Y.innerHTML="",$&&($.classList.add("opacity-0","invisible","translate-y-5"),$.classList.remove("transform")),Ee&&(Ee.disconnect(),xi(null)),tt&&(window.removeEventListener("scroll",tt),Si(null));const t=o.text.split(`
`).map(c=>{var f;return((f=c.match(/[^。？！\s]+[。？！]?/g))==null?void 0:f.filter(p=>p==null?void 0:p.trim()))||[]}),n=t.flat();if(!(n.length>0))return;const s=document.createElement("div");Y.appendChild(s);const l=document.createElement("div");l.className="flex justify-between items-center mb-4";const u=document.createElement("h2");if(u.className="text-xl font-bold text-text-primary",u.textContent=o.title,l.appendChild(u),n.length>0){const c=document.createElement("div");c.className="flex items-center gap-2";const f=document.createElement("button");f.id="edit-text-button",f.className="p-2 rounded-full hover:bg-surface-hover focus-ring transition-colors",f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-text-secondary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002 2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>',f.title="Edit this text",c.appendChild(f);const p=document.createElement("button");p.id="start-reading-button",p.title="Start Reading Mode",p.className="inline-flex items-center justify-center p-2.5 rounded-full text-primary-text bg-accent hover:bg-accent/90 focus-ring shadow-sm",p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>',c.appendChild(p),l.appendChild(c)}s.appendChild(l);const d=document.createElement("div");d.className="bg-surface-soft border border-border rounded-lg p-4 sm:p-6 max-h-80 overflow-y-auto",t.forEach(c=>{const f=document.createElement("p");f.className="text-lg sm:text-xl leading-relaxed",c.length>0?c.forEach(p=>{var g;const m=document.createElement("span");m.className="clickable-sentence cursor-pointer rounded p-1 -m-1 transition-colors duration-200 hover:bg-accent-selected-bg/50",!!((g=o.analyzedSentences[p])!=null&&g[ee])?(m.classList.add("text-accent-text"),m.title="Analyzed. Click to view."):m.title="Click to analyze.",m.textContent=p,m.dataset.sentence=p,f.append(m," ")}):f.innerHTML="&nbsp;",d.appendChild(f)}),s.appendChild(d)}function Jn(o,e,t){U.innerHTML="",U.className="";const i=o.text.split(`
`).flatMap(d=>{var c;return((c=d.match(/[^。？！\s]+[。？！]?/g))==null?void 0:c.filter(f=>f==null?void 0:f.trim()))||[]}).length,s=document.createElement("header");s.className="fixed top-0 left-0 right-0 z-20 border-b border-border bg-gradient-to-r from-background to-surface duration-300";const l=document.createElement("div");l.className="max-w-4xl mx-auto flex items-center justify-between p-2",l.innerHTML=`
        <button id="reading-mode-exit" title="Exit Reading Mode" class="p-2 rounded-full hover:bg-surface-hover transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-text-secondary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
        </button>
        <div class="font-medium text-text-secondary flex items-center gap-1">
            <input type="number" id="reading-mode-sentence-input" value="${e+1}" min="1" max="${i}" title="Enter sentence number and press Enter" class="w-12 text-center bg-surface-subtle rounded-md p-1 focus:ring-2 focus:ring-focus-ring focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
            <span>/ ${i}</span>
        </div>
        <div class="flex items-center gap-2">
            <button id="reading-nav-prev" title="Previous Sentence (←)" class="p-2 rounded-full hover:bg-surface-hover disabled:opacity-30 disabled:cursor-not-allowed" ${e===0?"disabled":""}>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <button id="reading-nav-next" title="Next Sentence (→)" class="p-2 rounded-full hover:bg-surface-hover disabled:opacity-30 disabled:cursor-not-allowed" ${e>=i-1?"disabled":""}>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>
    `,s.appendChild(l),U.appendChild(s);const u=document.createElement("div");Ue(u,t,{stickyTopClass:"top-14"}),U.appendChild(u)}function bs(o,e){const t=o.text.split(`
`).flatMap(d=>{var c;return((c=d.match(/[^。？！\s]+[。？！]?/g))==null?void 0:c.filter(f=>f==null?void 0:f.trim()))||[]}),n=t[e],i=t.length;U.innerHTML="",U.className="";const s=document.createElement("header");s.className="fixed top-0 left-0 right-0 z-20 border-b border-border bg-gradient-to-r from-background to-surface duration-300";const l=document.createElement("div");l.className="max-w-4xl mx-auto flex items-center justify-between p-2",l.innerHTML=`
        <button id="reading-mode-exit" title="Exit Reading Mode" class="p-2 rounded-full hover:bg-surface-hover transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-text-secondary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
        </button>
        <div class="font-medium text-text-secondary flex items-center gap-1">
            <input type="number" id="reading-mode-sentence-input" value="${e+1}" min="1" max="${i}" title="Enter sentence number and press Enter" class="w-12 text-center bg-surface-subtle rounded-md p-1 focus:ring-2 focus:ring-focus-ring focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
            <span>/ ${i}</span>
        </div>
        <div class="flex items-center gap-2">
            <button id="reading-nav-prev" title="Previous Sentence (←)" class="p-2 rounded-full hover:bg-surface-hover disabled:opacity-30 disabled:cursor-not-allowed" ${e===0?"disabled":""}>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <button id="reading-nav-next" title="Next Sentence (→)" class="p-2 rounded-full hover:bg-surface-hover disabled:opacity-30 disabled:cursor-not-allowed" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>
    `,s.appendChild(l),U.appendChild(s);const u=document.createElement("div");u.id="reading-mode-content-wrapper",Ui(u,n,{stickyTopClass:"top-14"}),U.appendChild(u)}function Be(){_t.innerHTML="";const o=W;Ri.classList.toggle("hidden",o.length>0),kn.classList.toggle("hidden",o.length===0),o.forEach(e=>{const t=document.createElement("li");t.className="text-entry-item group p-4 hover:bg-surface-hover transition-colors flex justify-between items-center";const n=document.createElement("div");n.className="flex-grow pr-4 truncate cursor-pointer",n.dataset.action="load",n.dataset.entryId=e.id;const i=document.createElement("span");i.className="font-medium text-sm pointer-events-none text-text-primary",i.textContent=e.title,i.title=e.title;const s=document.createElement("span");s.className="block text-xs text-text-muted mt-1 pointer-events-none",s.textContent=`Updated: ${new Date(e.updatedAt).toLocaleString()}`,n.append(i,s);const l=document.createElement("div");l.className="flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0";const u=document.createElement("button");u.className="p-2 rounded-full hover:bg-destructive-subtle-bg text-destructive/70 hover:text-destructive transition-colors",u.title="Delete Text",u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>',u.dataset.action="delete",u.dataset.entryId=e.id,l.append(u),t.append(n,l),_t.appendChild(t)})}function X(){const o=!De.checked,e=!nt.checked,t=!Le.checked;ce.classList.toggle("color-coding-disabled",t),document.querySelectorAll("#result-container rt").forEach(n=>n.classList.toggle("hidden",o)),document.querySelectorAll("#result-container .pitch-accent-svg").forEach(n=>n.classList.toggle("hidden",e)),document.querySelectorAll("#result-container .segment").forEach(n=>{n.classList.toggle("pt-[18px]",!e),n.classList.toggle("pt-1",e)})}function st(){const o=me.value.trim().length>0,e=!!Pe;Me.disabled=!o||!e,e?o?Me.title="":Me.title="Please enter some text to process.":Me.title="Please set your Gemini API key in the settings menu."}function Bi(){Bt.classList.remove("hidden"),U.classList.add("hidden"),Rn.classList.remove("hidden")}function Ds(){Bt.classList.add("hidden"),U.classList.remove("hidden"),Rn.classList.add("hidden")}function Pn(o){const e=o.message||"";return e.includes("429")||e.includes("RESOURCE_EXHAUSTED")?{main:"The request to the AI model was rate-limited.",detail:"This can happen if you process very large texts or make many requests in a short period. The app tried to retry automatically but was unsuccessful. Please wait a moment before trying again."}:e.includes("API key not valid")?{main:"The Gemini API key is not valid.",detail:"Please check the key in the settings menu. Make sure it has been copied correctly and is enabled for use."}:e.includes("timed out")?{main:"The request to the AI model timed out.",detail:"This could be due to a temporary network issue or the model taking too long to respond. Please try again in a moment."}:e.includes("GoogleGenAI")||e.includes("Request failed with status code")?{main:"An unexpected API error occurred.",detail:e}:{main:e}}function Et(){_e.value="",me.value="",Bi(),be.classList.remove("hidden"),Y.innerHTML="",G.innerHTML="",An(null),Fe(),st()}var b;(function(o){o.assertEqual=i=>{};function e(i){}o.assertIs=e;function t(i){throw new Error}o.assertNever=t,o.arrayToEnum=i=>{const s={};for(const l of i)s[l]=l;return s},o.getValidEnumValues=i=>{const s=o.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),l={};for(const u of s)l[u]=i[u];return o.objectValues(l)},o.objectValues=i=>o.objectKeys(i).map(function(s){return i[s]}),o.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&s.push(l);return s},o.find=(i,s)=>{for(const l of i)if(s(l))return l},o.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(s)}o.joinValues=n,o.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(b||(b={}));var zn;(function(o){o.mergeShapes=(e,t)=>({...e,...t})})(zn||(zn={}));const _=b.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fe=o=>{switch(typeof o){case"undefined":return _.undefined;case"string":return _.string;case"number":return Number.isNaN(o)?_.nan:_.number;case"boolean":return _.boolean;case"function":return _.function;case"bigint":return _.bigint;case"symbol":return _.symbol;case"object":return Array.isArray(o)?_.array:o===null?_.null:o.then&&typeof o.then=="function"&&o.catch&&typeof o.catch=="function"?_.promise:typeof Map<"u"&&o instanceof Map?_.map:typeof Set<"u"&&o instanceof Set?_.set:typeof Date<"u"&&o instanceof Date?_.date:_.object;default:return _.unknown}},v=b.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class de extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const l of s.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)n._errors.push(t(l));else{let u=n,d=0;for(;d<l.path.length;){const c=l.path[d];d===l.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(t(l))):u[c]=u[c]||{_errors:[]},u=u[c],d++}}};return i(this),n}static assert(e){if(!(e instanceof de))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,b.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}de.create=o=>new de(o);const rn=(o,e)=>{let t;switch(o.code){case v.invalid_type:o.received===_.undefined?t="Required":t=`Expected ${o.expected}, received ${o.received}`;break;case v.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(o.expected,b.jsonStringifyReplacer)}`;break;case v.unrecognized_keys:t=`Unrecognized key(s) in object: ${b.joinValues(o.keys,", ")}`;break;case v.invalid_union:t="Invalid input";break;case v.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${b.joinValues(o.options)}`;break;case v.invalid_enum_value:t=`Invalid enum value. Expected ${b.joinValues(o.options)}, received '${o.received}'`;break;case v.invalid_arguments:t="Invalid function arguments";break;case v.invalid_return_type:t="Invalid function return type";break;case v.invalid_date:t="Invalid date";break;case v.invalid_string:typeof o.validation=="object"?"includes"in o.validation?(t=`Invalid input: must include "${o.validation.includes}"`,typeof o.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${o.validation.position}`)):"startsWith"in o.validation?t=`Invalid input: must start with "${o.validation.startsWith}"`:"endsWith"in o.validation?t=`Invalid input: must end with "${o.validation.endsWith}"`:b.assertNever(o.validation):o.validation!=="regex"?t=`Invalid ${o.validation}`:t="Invalid";break;case v.too_small:o.type==="array"?t=`Array must contain ${o.exact?"exactly":o.inclusive?"at least":"more than"} ${o.minimum} element(s)`:o.type==="string"?t=`String must contain ${o.exact?"exactly":o.inclusive?"at least":"over"} ${o.minimum} character(s)`:o.type==="number"?t=`Number must be ${o.exact?"exactly equal to ":o.inclusive?"greater than or equal to ":"greater than "}${o.minimum}`:o.type==="date"?t=`Date must be ${o.exact?"exactly equal to ":o.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(o.minimum))}`:t="Invalid input";break;case v.too_big:o.type==="array"?t=`Array must contain ${o.exact?"exactly":o.inclusive?"at most":"less than"} ${o.maximum} element(s)`:o.type==="string"?t=`String must contain ${o.exact?"exactly":o.inclusive?"at most":"under"} ${o.maximum} character(s)`:o.type==="number"?t=`Number must be ${o.exact?"exactly":o.inclusive?"less than or equal to":"less than"} ${o.maximum}`:o.type==="bigint"?t=`BigInt must be ${o.exact?"exactly":o.inclusive?"less than or equal to":"less than"} ${o.maximum}`:o.type==="date"?t=`Date must be ${o.exact?"exactly":o.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(o.maximum))}`:t="Invalid input";break;case v.custom:t="Invalid input";break;case v.invalid_intersection_types:t="Intersection results could not be merged";break;case v.not_multiple_of:t=`Number must be a multiple of ${o.multipleOf}`;break;case v.not_finite:t="Number must be finite";break;default:t=e.defaultError,b.assertNever(o)}return{message:t}};let Ls=rn;function Vs(){return Ls}const Fs=o=>{const{data:e,path:t,errorMaps:n,issueData:i}=o,s=[...t,...i.path||[]],l={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let u="";const d=n.filter(c=>!!c).slice().reverse();for(const c of d)u=c(l,{data:e,defaultError:u}).message;return{...i,path:s,message:u}};function T(o,e){const t=Vs(),n=Fs({issueData:e,data:o.data,path:o.path,errorMaps:[o.common.contextualErrorMap,o.schemaErrorMap,t,t===rn?void 0:rn].filter(i=>!!i)});o.common.issues.push(n)}class z{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if(i.status==="aborted")return M;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const i of t){const s=await i.key,l=await i.value;n.push({key:s,value:l})}return z.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:s,value:l}=i;if(s.status==="aborted"||l.status==="aborted")return M;s.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(n[s.value]=l.value)}return{status:e.value,value:n}}}const M=Object.freeze({status:"aborted"}),We=o=>({status:"dirty",value:o}),Q=o=>({status:"valid",value:o}),Yn=o=>o.status==="aborted",Kn=o=>o.status==="dirty",Ge=o=>o.status==="valid",xt=o=>typeof Promise<"u"&&o instanceof Promise;var E;(function(o){o.errToObj=e=>typeof e=="string"?{message:e}:e||{},o.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(E||(E={}));class re{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Wn=(o,e)=>{if(Ge(e))return{success:!0,data:e.value};if(!o.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new de(o.common.issues);return this._error=t,this._error}}};function R(o){if(!o)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:i}=o;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(l,u)=>{const{message:d}=o;return l.code==="invalid_enum_value"?{message:d??u.defaultError}:typeof u.data>"u"?{message:d??n??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:d??t??u.defaultError}},description:i}}class N{get description(){return this._def.description}_getType(e){return fe(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new z,ctx:{common:e.parent.common,data:e.data,parsedType:fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(xt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fe(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Wn(n,i)}"~validate"(e){var n,i;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fe(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:t});return Ge(s)?{value:s.value}:{issues:t.common.issues}}catch(s){(i=(n=s==null?void 0:s.message)==null?void 0:n.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(s=>Ge(s)?{value:s.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fe(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(xt(i)?i:Promise.resolve(i));return Wn(n,s)}refine(e,t){const n=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const l=e(i),u=()=>s.addIssue({code:v.custom,...n(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,t){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof t=="function"?t(n,i):t),!1))}_refinement(e){return new He({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ge.create(this,this._def)}nullable(){return $e.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return se.create(this)}promise(){return Mt.create(this,this._def)}or(e){return It.create([this,e],this._def)}and(e){return At.create(this,e,this._def)}transform(e){return new He({...R(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new cn({...R(this._def),innerType:this,defaultValue:t,typeName:w.ZodDefault})}brand(){return new rr({typeName:w.ZodBranded,type:this,...R(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new dn({...R(this._def),innerType:this,catchValue:t,typeName:w.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return bn.create(this,e)}readonly(){return fn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Us=/^c[^\s-]{8,}$/i,Bs=/^[0-9a-z]+$/,Gs=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Os=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qs=/^[a-z0-9_-]{21}$/i,Hs=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,$s=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Js=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,zs="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Kt;const Ys=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ks=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ws=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zs=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xs=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Qs=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Gi="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",js=new RegExp(`^${Gi}$`);function Oi(o){let e="[0-5]\\d";o.precision?e=`${e}\\.\\d{${o.precision}}`:o.precision==null&&(e=`${e}(\\.\\d+)?`);const t=o.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function er(o){return new RegExp(`^${Oi(o)}$`)}function tr(o){let e=`${Gi}T${Oi(o)}`;const t=[];return t.push(o.local?"Z?":"Z"),o.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function nr(o,e){return!!((e==="v4"||!e)&&Ys.test(o)||(e==="v6"||!e)&&Ws.test(o))}function or(o,e){if(!Hs.test(o))return!1;try{const[t]=o.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function ir(o,e){return!!((e==="v4"||!e)&&Ks.test(o)||(e==="v6"||!e)&&Zs.test(o))}class ie extends N{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==_.string){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.string,received:s.parsedType}),M}const n=new z;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const l=e.data.length>s.value,u=e.data.length<s.value;(l||u)&&(i=this._getOrReturnCtx(e,i),l?T(i,{code:v.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):u&&T(i,{code:v.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Js.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"email",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Kt||(Kt=new RegExp(zs,"u")),Kt.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"emoji",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")Os.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"uuid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")qs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"nanoid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Us.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cuid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Bs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cuid2",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Gs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"ulid",code:v.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),T(i,{validation:"url",code:v.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"regex",code:v.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?tr(s).test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?js.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?er(s).test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:v.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?$s.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"duration",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?nr(e.data,s.version)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"ip",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?or(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"jwt",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?ir(e.data,s.version)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"cidr",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Xs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"base64",code:v.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Qs.test(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{validation:"base64url",code:v.invalid_string,message:s.message}),n.dirty()):b.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(i=>e.test(i),{validation:t,code:v.invalid_string,...E.errToObj(n)})}_addCheck(e){return new ie({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...E.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...E.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...E.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...E.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...E.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...E.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...E.errToObj(t)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new ie({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ie.create=o=>new ie({checks:[],typeName:w.ZodString,coerce:(o==null?void 0:o.coerce)??!1,...R(o)});function sr(o,e){const t=(o.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=t>n?t:n,s=Number.parseInt(o.toFixed(i).replace(".","")),l=Number.parseInt(e.toFixed(i).replace(".",""));return s%l/10**i}class xe extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==_.number){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.number,received:s.parsedType}),M}let n;const i=new z;for(const s of this._def.checks)s.kind==="int"?b.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:v.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?sr(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_finite,message:s.message}),i.dirty()):b.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,n,i){return new xe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:E.toString(i)}]})}_addCheck(e){return new xe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&b.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}xe.create=o=>new xe({checks:[],typeName:w.ZodNumber,coerce:(o==null?void 0:o.coerce)||!1,...R(o)});class Se extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==_.bigint)return this._getInvalidInput(e);let n;const i=new z;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),T(n,{code:v.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):b.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return T(t,{code:v.invalid_type,expected:_.bigint,received:t.parsedType}),M}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,n,i){return new Se({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:E.toString(i)}]})}_addCheck(e){return new Se({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Se.create=o=>new Se({checks:[],typeName:w.ZodBigInt,coerce:(o==null?void 0:o.coerce)??!1,...R(o)});class St extends N{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==_.boolean){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.boolean,received:n.parsedType}),M}return Q(e.data)}}St.create=o=>new St({typeName:w.ZodBoolean,coerce:(o==null?void 0:o.coerce)||!1,...R(o)});class Oe extends N{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==_.date){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_type,expected:_.date,received:s.parsedType}),M}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return T(s,{code:v.invalid_date}),M}const n=new z;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),T(i,{code:v.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):b.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Oe({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Oe.create=o=>new Oe({checks:[],coerce:(o==null?void 0:o.coerce)||!1,typeName:w.ZodDate,...R(o)});class Zn extends N{_parse(e){if(this._getType(e)!==_.symbol){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.symbol,received:n.parsedType}),M}return Q(e.data)}}Zn.create=o=>new Zn({typeName:w.ZodSymbol,...R(o)});class Xn extends N{_parse(e){if(this._getType(e)!==_.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.undefined,received:n.parsedType}),M}return Q(e.data)}}Xn.create=o=>new Xn({typeName:w.ZodUndefined,...R(o)});class Qn extends N{_parse(e){if(this._getType(e)!==_.null){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.null,received:n.parsedType}),M}return Q(e.data)}}Qn.create=o=>new Qn({typeName:w.ZodNull,...R(o)});class jn extends N{constructor(){super(...arguments),this._any=!0}_parse(e){return Q(e.data)}}jn.create=o=>new jn({typeName:w.ZodAny,...R(o)});class an extends N{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Q(e.data)}}an.create=o=>new an({typeName:w.ZodUnknown,...R(o)});class ye extends N{_parse(e){const t=this._getOrReturnCtx(e);return T(t,{code:v.invalid_type,expected:_.never,received:t.parsedType}),M}}ye.create=o=>new ye({typeName:w.ZodNever,...R(o)});class eo extends N{_parse(e){if(this._getType(e)!==_.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.void,received:n.parsedType}),M}return Q(e.data)}}eo.create=o=>new eo({typeName:w.ZodVoid,...R(o)});class se extends N{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==_.array)return T(t,{code:v.invalid_type,expected:_.array,received:t.parsedType}),M;if(i.exactLength!==null){const l=t.data.length>i.exactLength.value,u=t.data.length<i.exactLength.value;(l||u)&&(T(t,{code:l?v.too_big:v.too_small,minimum:u?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(T(t,{code:v.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(T(t,{code:v.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((l,u)=>i.type._parseAsync(new re(t,l,t.path,u)))).then(l=>z.mergeArray(n,l));const s=[...t.data].map((l,u)=>i.type._parseSync(new re(t,l,t.path,u)));return z.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new se({...this._def,minLength:{value:e,message:E.toString(t)}})}max(e,t){return new se({...this._def,maxLength:{value:e,message:E.toString(t)}})}length(e,t){return new se({...this._def,exactLength:{value:e,message:E.toString(t)}})}nonempty(e){return this.min(1,e)}}se.create=(o,e)=>new se({type:o,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...R(e)});function we(o){if(o instanceof O){const e={};for(const t in o.shape){const n=o.shape[t];e[t]=ge.create(we(n))}return new O({...o._def,shape:()=>e})}else return o instanceof se?new se({...o._def,type:we(o.element)}):o instanceof ge?ge.create(we(o.unwrap())):o instanceof $e?$e.create(we(o.unwrap())):o instanceof Ie?Ie.create(o.items.map(e=>we(e))):o}class O extends N{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=b.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==_.object){const c=this._getOrReturnCtx(e);return T(c,{code:v.invalid_type,expected:_.object,received:c.parsedType}),M}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof ye&&this._def.unknownKeys==="strip"))for(const c in i.data)l.includes(c)||u.push(c);const d=[];for(const c of l){const f=s[c],p=i.data[c];d.push({key:{status:"valid",value:c},value:f._parse(new re(i,p,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof ye){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of u)d.push({key:{status:"valid",value:f},value:{status:"valid",value:i.data[f]}});else if(c==="strict")u.length>0&&(T(i,{code:v.unrecognized_keys,keys:u}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of u){const p=i.data[f];d.push({key:{status:"valid",value:f},value:c._parse(new re(i,p,i.path,f)),alwaysSet:f in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of d){const p=await f.key,m=await f.value;c.push({key:p,value:m,alwaysSet:f.alwaysSet})}return c}).then(c=>z.mergeObjectSync(n,c)):z.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new O({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,l;const i=((l=(s=this._def).errorMap)==null?void 0:l.call(s,t,n).message)??n.defaultError;return t.code==="unrecognized_keys"?{message:E.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new O({...this._def,unknownKeys:"strip"})}passthrough(){return new O({...this._def,unknownKeys:"passthrough"})}extend(e){return new O({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new O({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:w.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new O({...this._def,catchall:e})}pick(e){const t={};for(const n of b.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new O({...this._def,shape:()=>t})}omit(e){const t={};for(const n of b.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new O({...this._def,shape:()=>t})}deepPartial(){return we(this)}partial(e){const t={};for(const n of b.objectKeys(this.shape)){const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}return new O({...this._def,shape:()=>t})}required(e){const t={};for(const n of b.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof ge;)s=s._def.innerType;t[n]=s}return new O({...this._def,shape:()=>t})}keyof(){return qi(b.objectKeys(this.shape))}}O.create=(o,e)=>new O({shape:()=>o,unknownKeys:"strip",catchall:ye.create(),typeName:w.ZodObject,...R(e)});O.strictCreate=(o,e)=>new O({shape:()=>o,unknownKeys:"strict",catchall:ye.create(),typeName:w.ZodObject,...R(e)});O.lazycreate=(o,e)=>new O({shape:o,unknownKeys:"strip",catchall:ye.create(),typeName:w.ZodObject,...R(e)});class It extends N{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function i(s){for(const u of s)if(u.result.status==="valid")return u.result;for(const u of s)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;const l=s.map(u=>new de(u.ctx.common.issues));return T(t,{code:v.invalid_union,unionErrors:l}),M}if(t.common.async)return Promise.all(n.map(async s=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(i);{let s;const l=[];for(const d of n){const c={...t,common:{...t.common,issues:[]},parent:null},f=d._parseSync({data:t.data,path:t.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!s&&(s={result:f,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const u=l.map(d=>new de(d));return T(t,{code:v.invalid_union,unionErrors:u}),M}}get options(){return this._def.options}}It.create=(o,e)=>new It({options:o,typeName:w.ZodUnion,...R(e)});function ln(o,e){const t=fe(o),n=fe(e);if(o===e)return{valid:!0,data:o};if(t===_.object&&n===_.object){const i=b.objectKeys(e),s=b.objectKeys(o).filter(u=>i.indexOf(u)!==-1),l={...o,...e};for(const u of s){const d=ln(o[u],e[u]);if(!d.valid)return{valid:!1};l[u]=d.data}return{valid:!0,data:l}}else if(t===_.array&&n===_.array){if(o.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<o.length;s++){const l=o[s],u=e[s],d=ln(l,u);if(!d.valid)return{valid:!1};i.push(d.data)}return{valid:!0,data:i}}else return t===_.date&&n===_.date&&+o==+e?{valid:!0,data:o}:{valid:!1}}class At extends N{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(s,l)=>{if(Yn(s)||Yn(l))return M;const u=ln(s.value,l.value);return u.valid?((Kn(s)||Kn(l))&&t.dirty(),{status:t.value,value:u.data}):(T(n,{code:v.invalid_intersection_types}),M)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,l])=>i(s,l)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}At.create=(o,e,t)=>new At({left:o,right:e,typeName:w.ZodIntersection,...R(t)});class Ie extends N{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.array)return T(n,{code:v.invalid_type,expected:_.array,received:n.parsedType}),M;if(n.data.length<this._def.items.length)return T(n,{code:v.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),M;!this._def.rest&&n.data.length>this._def.items.length&&(T(n,{code:v.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...n.data].map((l,u)=>{const d=this._def.items[u]||this._def.rest;return d?d._parse(new re(n,l,n.path,u)):null}).filter(l=>!!l);return n.common.async?Promise.all(s).then(l=>z.mergeArray(t,l)):z.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new Ie({...this._def,rest:e})}}Ie.create=(o,e)=>{if(!Array.isArray(o))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ie({items:o,typeName:w.ZodTuple,rest:null,...R(e)})};class wt extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.object)return T(n,{code:v.invalid_type,expected:_.object,received:n.parsedType}),M;const i=[],s=this._def.keyType,l=this._def.valueType;for(const u in n.data)i.push({key:s._parse(new re(n,u,n.path,u)),value:l._parse(new re(n,n.data[u],n.path,u)),alwaysSet:u in n.data});return n.common.async?z.mergeObjectAsync(t,i):z.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof N?new wt({keyType:e,valueType:t,typeName:w.ZodRecord,...R(n)}):new wt({keyType:ie.create(),valueType:e,typeName:w.ZodRecord,...R(t)})}}class to extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.map)return T(n,{code:v.invalid_type,expected:_.map,received:n.parsedType}),M;const i=this._def.keyType,s=this._def.valueType,l=[...n.data.entries()].map(([u,d],c)=>({key:i._parse(new re(n,u,n.path,[c,"key"])),value:s._parse(new re(n,d,n.path,[c,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const d of l){const c=await d.key,f=await d.value;if(c.status==="aborted"||f.status==="aborted")return M;(c.status==="dirty"||f.status==="dirty")&&t.dirty(),u.set(c.value,f.value)}return{status:t.value,value:u}})}else{const u=new Map;for(const d of l){const c=d.key,f=d.value;if(c.status==="aborted"||f.status==="aborted")return M;(c.status==="dirty"||f.status==="dirty")&&t.dirty(),u.set(c.value,f.value)}return{status:t.value,value:u}}}}to.create=(o,e,t)=>new to({valueType:e,keyType:o,typeName:w.ZodMap,...R(t)});class it extends N{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.set)return T(n,{code:v.invalid_type,expected:_.set,received:n.parsedType}),M;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(T(n,{code:v.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(T(n,{code:v.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function l(d){const c=new Set;for(const f of d){if(f.status==="aborted")return M;f.status==="dirty"&&t.dirty(),c.add(f.value)}return{status:t.value,value:c}}const u=[...n.data.values()].map((d,c)=>s._parse(new re(n,d,n.path,c)));return n.common.async?Promise.all(u).then(d=>l(d)):l(u)}min(e,t){return new it({...this._def,minSize:{value:e,message:E.toString(t)}})}max(e,t){return new it({...this._def,maxSize:{value:e,message:E.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}it.create=(o,e)=>new it({valueType:o,minSize:null,maxSize:null,typeName:w.ZodSet,...R(e)});class un extends N{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}un.create=(o,e)=>new un({getter:o,typeName:w.ZodLazy,...R(e)});class no extends N{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return T(t,{received:t.data,code:v.invalid_literal,expected:this._def.value}),M}return{status:"valid",value:e.data}}get value(){return this._def.value}}no.create=(o,e)=>new no({value:o,typeName:w.ZodLiteral,...R(e)});function qi(o,e){return new qe({values:o,typeName:w.ZodEnum,...R(e)})}class qe extends N{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return T(t,{expected:b.joinValues(n),received:t.parsedType,code:v.invalid_type}),M}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return T(t,{received:t.data,code:v.invalid_enum_value,options:n}),M}return Q(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return qe.create(e,{...this._def,...t})}exclude(e,t=this._def){return qe.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}qe.create=qi;class oo extends N{_parse(e){const t=b.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==_.string&&n.parsedType!==_.number){const i=b.objectValues(t);return T(n,{expected:b.joinValues(i),received:n.parsedType,code:v.invalid_type}),M}if(this._cache||(this._cache=new Set(b.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=b.objectValues(t);return T(n,{received:n.data,code:v.invalid_enum_value,options:i}),M}return Q(e.data)}get enum(){return this._def.values}}oo.create=(o,e)=>new oo({values:o,typeName:w.ZodNativeEnum,...R(e)});class Mt extends N{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==_.promise&&t.common.async===!1)return T(t,{code:v.invalid_type,expected:_.promise,received:t.parsedType}),M;const n=t.parsedType===_.promise?t.data:Promise.resolve(t.data);return Q(n.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Mt.create=(o,e)=>new Mt({type:o,typeName:w.ZodPromise,...R(e)});class He extends N{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:l=>{T(n,l),l.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const l=i.transform(n.data,s);if(n.common.async)return Promise.resolve(l).then(async u=>{if(t.value==="aborted")return M;const d=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return d.status==="aborted"?M:d.status==="dirty"||t.value==="dirty"?We(d.value):d});{if(t.value==="aborted")return M;const u=this._def.schema._parseSync({data:l,path:n.path,parent:n});return u.status==="aborted"?M:u.status==="dirty"||t.value==="dirty"?We(u.value):u}}if(i.type==="refinement"){const l=u=>{const d=i.refinement(u,s);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?M:(u.status==="dirty"&&t.dirty(),l(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?M:(u.status==="dirty"&&t.dirty(),l(u.value).then(()=>({status:t.value,value:u.value}))))}if(i.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ge(l))return M;const u=i.transform(l.value,s);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>Ge(l)?Promise.resolve(i.transform(l.value,s)).then(u=>({status:t.value,value:u})):M);b.assertNever(i)}}He.create=(o,e,t)=>new He({schema:o,typeName:w.ZodEffects,effect:e,...R(t)});He.createWithPreprocess=(o,e,t)=>new He({schema:e,effect:{type:"preprocess",transform:o},typeName:w.ZodEffects,...R(t)});class ge extends N{_parse(e){return this._getType(e)===_.undefined?Q(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ge.create=(o,e)=>new ge({innerType:o,typeName:w.ZodOptional,...R(e)});class $e extends N{_parse(e){return this._getType(e)===_.null?Q(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$e.create=(o,e)=>new $e({innerType:o,typeName:w.ZodNullable,...R(e)});class cn extends N{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===_.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}cn.create=(o,e)=>new cn({innerType:o,typeName:w.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...R(e)});class dn extends N{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return xt(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new de(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new de(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}dn.create=(o,e)=>new dn({innerType:o,typeName:w.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...R(e)});class io extends N{_parse(e){if(this._getType(e)!==_.nan){const n=this._getOrReturnCtx(e);return T(n,{code:v.invalid_type,expected:_.nan,received:n.parsedType}),M}return{status:"valid",value:e.data}}}io.create=o=>new io({typeName:w.ZodNaN,...R(o)});class rr extends N{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class bn extends N{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?M:s.status==="dirty"?(t.dirty(),We(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?M:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,t){return new bn({in:e,out:t,typeName:w.ZodPipeline})}}class fn extends N{_parse(e){const t=this._def.innerType._parse(e),n=i=>(Ge(i)&&(i.value=Object.freeze(i.value)),i);return xt(t)?t.then(i=>n(i)):n(t)}unwrap(){return this._def.innerType}}fn.create=(o,e)=>new fn({innerType:o,typeName:w.ZodReadonly,...R(e)});var w;(function(o){o.ZodString="ZodString",o.ZodNumber="ZodNumber",o.ZodNaN="ZodNaN",o.ZodBigInt="ZodBigInt",o.ZodBoolean="ZodBoolean",o.ZodDate="ZodDate",o.ZodSymbol="ZodSymbol",o.ZodUndefined="ZodUndefined",o.ZodNull="ZodNull",o.ZodAny="ZodAny",o.ZodUnknown="ZodUnknown",o.ZodNever="ZodNever",o.ZodVoid="ZodVoid",o.ZodArray="ZodArray",o.ZodObject="ZodObject",o.ZodUnion="ZodUnion",o.ZodDiscriminatedUnion="ZodDiscriminatedUnion",o.ZodIntersection="ZodIntersection",o.ZodTuple="ZodTuple",o.ZodRecord="ZodRecord",o.ZodMap="ZodMap",o.ZodSet="ZodSet",o.ZodFunction="ZodFunction",o.ZodLazy="ZodLazy",o.ZodLiteral="ZodLiteral",o.ZodEnum="ZodEnum",o.ZodEffects="ZodEffects",o.ZodNativeEnum="ZodNativeEnum",o.ZodOptional="ZodOptional",o.ZodNullable="ZodNullable",o.ZodDefault="ZodDefault",o.ZodCatch="ZodCatch",o.ZodPromise="ZodPromise",o.ZodBranded="ZodBranded",o.ZodPipeline="ZodPipeline",o.ZodReadonly="ZodReadonly"})(w||(w={}));const Te=ie.create,so=xe.create;Se.create;const ar=St.create;Oe.create;const ro=an.create;ye.create;const Ze=se.create,lr=O.create,ur=It.create;At.create;Ie.create;const cr=wt.create,dr=un.create,fr=qe.create;Mt.create;ge.create;$e.create;const Ae={string:o=>ie.create({...o,coerce:!0}),number:o=>xe.create({...o,coerce:!0}),boolean:o=>St.create({...o,coerce:!0}),bigint:o=>Se.create({...o,coerce:!0}),date:o=>Oe.create({...o,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let pr,mr;function hr(){return{geminiUrl:pr,vertexUrl:mr}}function gr(o,e,t){var n,i,s;if(!(!((n=o.httpOptions)===null||n===void 0)&&n.baseUrl)){const l=hr();return o.vertexai?(i=l.vertexUrl)!==null&&i!==void 0?i:e:(s=l.geminiUrl)!==null&&s!==void 0?s:t}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rt{}function A(o,e){const t=/\{([^}]+)\}/g;return o.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(o,e,t){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in o))if(Array.isArray(t))o[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(o[u])){const d=o[u];if(Array.isArray(t))for(let c=0;c<d.length;c++){const f=d[c];a(f,e.slice(s+1),t[c])}else for(const c of d)a(c,e.slice(s+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in o||(o[u]=[{}]);const d=o[u];a(d[0],e.slice(s+1),t);return}(!o[l]||typeof o[l]!="object")&&(o[l]={}),o=o[l]}const n=e[e.length-1],i=o[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=t}function r(o,e){try{if(e.length===1&&e[0]==="_self")return o;for(let t=0;t<e.length;t++){if(typeof o!="object"||o===null)return;const n=e[t];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const s=o[i];return Array.isArray(s)?s.map(l=>r(l,e.slice(t+1))):void 0}else return}else o=o[n]}return o}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ao;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ao||(ao={}));var lo;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(lo||(lo={}));var uo;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(uo||(uo={}));var co;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(co||(co={}));var fo;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(fo||(fo={}));var oe;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(oe||(oe={}));var po;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(po||(po={}));var mo;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(mo||(mo={}));var ho;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(ho||(ho={}));var go;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(go||(go={}));var yo;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(yo||(yo={}));var vo;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(vo||(vo={}));var Co;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Co||(Co={}));var Rt;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(Rt||(Rt={}));var To;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(To||(To={}));var pn;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(pn||(pn={}));var _o;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(_o||(_o={}));var Eo;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(Eo||(Eo={}));var xo;(function(o){o.UNSPECIFIED="UNSPECIFIED",o.BLOCKING="BLOCKING",o.NON_BLOCKING="NON_BLOCKING"})(xo||(xo={}));var So;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(So||(So={}));var Io;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(Io||(Io={}));var Ao;(function(o){o.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",o.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",o.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Ao||(Ao={}));var wo;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(wo||(wo={}));var Mo;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(Mo||(Mo={}));var Ro;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(Ro||(Ro={}));var ko;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ko||(ko={}));var No;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(No||(No={}));var Po;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Po||(Po={}));var bo;(function(o){o.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",o.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",o.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",o.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",o.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",o.EDIT_MODE_STYLE="EDIT_MODE_STYLE",o.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",o.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(bo||(bo={}));var Do;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(Do||(Do={}));var Lo;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(Lo||(Lo={}));var Vo;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Vo||(Vo={}));var Fo;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Fo||(Fo={}));var Uo;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Uo||(Uo={}));var Bo;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(Bo||(Bo={}));var Go;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Go||(Go={}));var Oo;(function(o){o.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",o.SILENT="SILENT",o.WHEN_IDLE="WHEN_IDLE",o.INTERRUPT="INTERRUPT"})(Oo||(Oo={}));var qo;(function(o){o.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",o.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",o.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",o.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",o.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",o.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",o.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",o.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",o.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",o.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",o.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",o.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",o.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(qo||(qo={}));var Ho;(function(o){o.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",o.QUALITY="QUALITY",o.DIVERSITY="DIVERSITY"})(Ho||(Ho={}));var Re;(function(o){o.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",o.PLAY="PLAY",o.PAUSE="PAUSE",o.STOP="STOP",o.RESET_CONTEXT="RESET_CONTEXT"})(Re||(Re={}));class Ye{get text(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const p=[];for(const m of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[h,g]of Object.entries(m))h!=="text"&&h!=="thought"&&(g!==null||g!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,c+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const p of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(c+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,n,i,s,l,u,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,n,i,s,l,u,d,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,n,i,s,l,u,d,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class $o{}class Jo{}class yr{}class vr{}class zo{}class Yo{}class Ko{}class Cr{}class Wo{}class Zo{}class Xo{}class Tr{}class mn{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class _r{}class Er{}class xr{get text(){var e,t,n;let i="",s=!1;const l=[];for(const u of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;s=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,n;let i="";const s=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&s.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Sr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V(o,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Hi(o,e){const t=V(o,e);return t?t.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:t.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${t}`:t:""}function $i(o,e){return Array.isArray(e)?e.map(t=>kt(o,t)):[kt(o,e)]}function kt(o,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Ir(o,e){const t=kt(o,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Ar(o,e){const t=kt(o,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Qo(o,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function Ji(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Qo(o,t)):[Qo(o,e)]}function hn(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function jo(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function ei(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function K(o,e){if(e==null)throw new Error("ContentUnion is required");return hn(e)?e:{role:"user",parts:Ji(o,e)}}function zi(o,e){if(!e)return[];if(o.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=K(o,t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const t=K(o,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>K(o,t)):[K(o,e)]}function te(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(jo(e)||ei(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[K(o,e)]}const t=[],n=[],i=hn(e[0]);for(const s of e){const l=hn(s);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(s);else{if(jo(s)||ei(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return i||t.push({role:"user",parts:Ji(o,n)}),t}const ti=fr(["string","number","integer","object","array","boolean","null"]),wr=ur([ti,Ze(ti)]);function Mr(o=!0){const e=dr(()=>{const t=lr({type:wr.optional(),format:Te().optional(),title:Te().optional(),description:Te().optional(),default:ro().optional(),items:e.optional(),minItems:Ae.string().optional(),maxItems:Ae.string().optional(),enum:Ze(ro()).optional(),properties:cr(Te(),e).optional(),required:Ze(Te()).optional(),minProperties:Ae.string().optional(),maxProperties:Ae.string().optional(),propertyOrdering:Ze(Te()).optional(),minimum:so().optional(),maximum:so().optional(),minLength:Ae.string().optional(),maxLength:Ae.string().optional(),pattern:Te().optional(),anyOf:Ze(e).optional(),additionalProperties:ar().optional()});return o?t.strict():t});return e}function Rr(o,e){o.includes("null")&&(e.nullable=!0);const t=o.filter(n=>n!=="null");if(t.length===1)e.type=Object.keys(oe).includes(t[0].toUpperCase())?oe[t[0].toUpperCase()]:oe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.keys(oe).includes(n.toUpperCase())?oe[n.toUpperCase()]:oe.TYPE_UNSPECIFIED})}}function Qe(o){const e={},t=["items"],n=["anyOf"],i=["properties"];if(o.type&&o.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=o.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,o=s[1]):s[1].type==="null"&&(e.nullable=!0,o=s[0])),o.type instanceof Array&&Rr(o.type,e);for(const[l,u]of Object.entries(o))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.keys(oe).includes(u.toUpperCase())?u.toUpperCase():oe.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Qe(u);else if(n.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push(Qe(c))}e[l]=d}else if(i.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=Qe(f);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function Nt(o,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=Mr().parse(e);return Qe(t)}else return Qe(e)}function Yi(o,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Ki(o,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function qt(o,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Nt(o,t.parameters)),t.response&&(t.response=Nt(o,t.response));return e}function Ht(o,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function kr(o,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return o.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${o.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function ve(o,e){if(typeof e!="string")throw new Error("name must be a string");return kr(o,e,"cachedContents")}function Wi(o,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ce(o,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function Nr(o){return o!=null&&typeof o=="object"&&"name"in o}function Pr(o){return o!=null&&typeof o=="object"&&"video"in o}function br(o){return o!=null&&typeof o=="object"&&"uri"in o}function Zi(o,e){var t;let n;if(Nr(e)&&(n=e.name),!(br(e)&&(n=e.uri,n===void 0))&&!(Pr(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Xi(o,e){let t;return o.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Qi(o,e){for(const t of["models","tunedModels","publisherModels"])if(Dr(e,t))return e[t];return[]}function Dr(o,e){return o!==null&&typeof o=="object"&&e in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lr(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function Vr(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function Fr(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Lr(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],Vr(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ni(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Fr(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Ur(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function Br(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function Gr(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Br(o,n)),t}function Or(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function qr(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Or(o,n)),t}function Hr(){return{}}function $r(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>Ur(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],Gr(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],qr(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],Hr());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function Jr(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function zr(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Yr(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],zr(o,n)),t}function Kr(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],Jr(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Yr(o,i)),t}function Wr(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);t!==void 0&&s!=null&&a(t,["expireTime"],s);const l=r(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const u=r(e,["contents"]);if(t!==void 0&&u!=null){let p=te(o,u);Array.isArray(p)&&(p=p.map(m=>ni(o,m))),a(t,["contents"],p)}const d=r(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],ni(o,K(o,d)));const c=r(e,["tools"]);if(t!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>$r(o,m))),a(t,["tools"],p)}const f=r(e,["toolConfig"]);if(t!==void 0&&f!=null&&a(t,["toolConfig"],Kr(o,f)),r(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Zr(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],Hi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Wr(o,i,t)),t}function Xr(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Qr(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function jr(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);return t!==void 0&&s!=null&&a(t,["expireTime"],s),n}function ea(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],jr(o,i,t)),t}function ta(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function na(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],ta(o,n,t)),t}function oa(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function ia(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function sa(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],oa(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],ia(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function oi(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>sa(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ra(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function aa(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function la(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],aa(o,n)),t}function ua(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function ca(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],ua(o,n)),t}function da(){return{}}function fa(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function pa(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],fa(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function ma(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],pa(o,n)),t}function ha(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>ra(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],la(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],ca(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],da());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],ma(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function ga(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function ya(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function va(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],ya(o,n)),t}function Ca(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],ga(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],va(o,i)),t}function Ta(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);t!==void 0&&s!=null&&a(t,["expireTime"],s);const l=r(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const u=r(e,["contents"]);if(t!==void 0&&u!=null){let m=te(o,u);Array.isArray(m)&&(m=m.map(h=>oi(o,h))),a(t,["contents"],m)}const d=r(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],oi(o,K(o,d)));const c=r(e,["tools"]);if(t!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>ha(o,h))),a(t,["tools"],m)}const f=r(e,["toolConfig"]);t!==void 0&&f!=null&&a(t,["toolConfig"],Ca(o,f));const p=r(e,["kmsKeyName"]);return t!==void 0&&p!=null&&a(t,["encryption_spec","kmsKeyName"],p),n}function _a(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],Hi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Ta(o,i,t)),t}function Ea(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function xa(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Sa(o,e,t){const n={},i=r(e,["ttl"]);t!==void 0&&i!=null&&a(t,["ttl"],i);const s=r(e,["expireTime"]);return t!==void 0&&s!=null&&a(t,["expireTime"],s),n}function Ia(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],ve(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Sa(o,i,t)),t}function Aa(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function wa(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Aa(o,n,t)),t}function mt(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["model"]);s!=null&&a(t,["model"],s);const l=r(e,["createTime"]);l!=null&&a(t,["createTime"],l);const u=r(e,["updateTime"]);u!=null&&a(t,["updateTime"],u);const d=r(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const c=r(e,["usageMetadata"]);return c!=null&&a(t,["usageMetadata"],c),t}function Ma(){return{}}function Ra(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>mt(o,l))),a(t,["cachedContents"],s)}return t}function ht(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["model"]);s!=null&&a(t,["model"],s);const l=r(e,["createTime"]);l!=null&&a(t,["createTime"],l);const u=r(e,["updateTime"]);u!=null&&a(t,["updateTime"],u);const d=r(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const c=r(e,["usageMetadata"]);return c!=null&&a(t,["usageMetadata"],c),t}function ka(){return{}}function Na(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>ht(o,l))),a(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Je;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Je||(Je={}));class $t{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};n?typeof n=="object"?l=Object.assign({},n):l=n:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pa extends rt{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new $t(Je.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=_a(this.apiClient,e);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=Zr(this.apiClient,e);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async get(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ea(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=Xr(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async delete(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=xa(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=ka(),p=new Zo;return Object.assign(p,f),p})}else{const c=Qr(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Ma(),p=new Zo;return Object.assign(p,f),p})}}async update(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ia(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=ea(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=wa(this.apiClient,e);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Na(this.apiClient,f),m=new Xo;return Object.assign(m,p),m})}else{const c=na(this.apiClient,e);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Ra(this.apiClient,f),m=new Xo;return Object.assign(m,p),m})}}}function ii(o){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&o[e],n=0;if(t)return t.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function F(o){return this instanceof F?(this.v=o,this):new F(o)}function je(o,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(o,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(h){return function(g){return Promise.resolve(g).then(h,p)}}function u(h,g){n[h]&&(i[h]=function(y){return new Promise(function(C,x){s.push([h,y,C,x])>1||d(h,y)})},g&&(i[h]=g(i[h])))}function d(h,g){try{c(n[h](g))}catch(y){m(s[0][3],y)}}function c(h){h.value instanceof F?Promise.resolve(h.value.v).then(f,p):m(s[0][2],h)}function f(h){d("next",h)}function p(h){d("throw",h)}function m(h,g){h(g),s.shift(),s.length&&d(s[0][0],s[0][1])}}function gt(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=o[Symbol.asyncIterator],t;return e?e.call(o):(o=typeof ii=="function"?ii(o):o[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=o[s]&&function(l){return new Promise(function(u,d){l=o[s](l),i(u,d,l.done,l.value)})}}function i(s,l,u,d){Promise.resolve(d).then(function(c){s({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ba(o){var e;if(o.candidates==null||o.candidates.length===0)return!1;const t=(e=o.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ji(t)}function ji(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const e of o.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function Da(o){if(o.length!==0){for(const e of o)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function si(o){if(o===void 0||o.length===0)return[];const e=[],t=o.length;let n=0;for(;n<t;)if(o[n].role==="user")e.push(o[n]),n++;else{const i=[];let s=!0;for(;n<t&&o[n].role==="model";)i.push(o[n]),s&&!ji(o[n])&&(s=!1),n++;s?e.push(...i):e.pop()}return e}class La{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Va(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Va{constructor(e,t,n,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),Da(s)}async sendMessage(e){var t;await this.sendPromise;const n=K(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,l,u;const d=await i,c=(l=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];f!=null&&(m=(u=f.slice(p))!==null&&u!==void 0?u:[]);const h=c?[c]:[];this.recordHistory(n,h,m)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const n=K(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,n)}getHistory(e=!1){const t=e?si(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,i;return je(this,arguments,function*(){var l,u,d,c;const f=[];try{for(var p=!0,m=gt(e),h;h=yield F(m.next()),l=h.done,!l;p=!0){c=h.value,p=!1;const g=c;if(ba(g)){const y=(i=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;y!==void 0&&f.push(y)}yield yield F(g)}}catch(g){u={error:g}}finally{try{!p&&!l&&(d=m.return)&&(yield F(d.call(m)))}finally{if(u)throw u.error}}this.recordHistory(t,f)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...si(n)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fa(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);return t!==void 0&&s!=null&&a(t,["_query","pageToken"],s),n}function Ua(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Fa(o,n,t)),t}function Ba(o,e){const t={},n=r(e,["details"]);n!=null&&a(t,["details"],n);const i=r(e,["message"]);i!=null&&a(t,["message"],i);const s=r(e,["code"]);return s!=null&&a(t,["code"],s),t}function Ga(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["mimeType"]);s!=null&&a(t,["mimeType"],s);const l=r(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const u=r(e,["createTime"]);u!=null&&a(t,["createTime"],u);const d=r(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const c=r(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const f=r(e,["sha256Hash"]);f!=null&&a(t,["sha256Hash"],f);const p=r(e,["uri"]);p!=null&&a(t,["uri"],p);const m=r(e,["downloadUri"]);m!=null&&a(t,["downloadUri"],m);const h=r(e,["state"]);h!=null&&a(t,["state"],h);const g=r(e,["source"]);g!=null&&a(t,["source"],g);const y=r(e,["videoMetadata"]);y!=null&&a(t,["videoMetadata"],y);const C=r(e,["error"]);return C!=null&&a(t,["error"],Ba(o,C)),t}function Oa(o,e){const t={},n=r(e,["file"]);n!=null&&a(t,["file"],Ga(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function qa(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","file"],Zi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Ha(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","file"],Zi(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function $a(o,e){const t={},n=r(e,["details"]);n!=null&&a(t,["details"],n);const i=r(e,["message"]);i!=null&&a(t,["message"],i);const s=r(e,["code"]);return s!=null&&a(t,["code"],s),t}function gn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["mimeType"]);s!=null&&a(t,["mimeType"],s);const l=r(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const u=r(e,["createTime"]);u!=null&&a(t,["createTime"],u);const d=r(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const c=r(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const f=r(e,["sha256Hash"]);f!=null&&a(t,["sha256Hash"],f);const p=r(e,["uri"]);p!=null&&a(t,["uri"],p);const m=r(e,["downloadUri"]);m!=null&&a(t,["downloadUri"],m);const h=r(e,["state"]);h!=null&&a(t,["state"],h);const g=r(e,["source"]);g!=null&&a(t,["source"],g);const y=r(e,["videoMetadata"]);y!=null&&a(t,["videoMetadata"],y);const C=r(e,["error"]);return C!=null&&a(t,["error"],$a(o,C)),t}function Ja(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>gn(o,l))),a(t,["files"],s)}return t}function za(){return{}}function Ya(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ka extends rt{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new $t(Je.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>gn(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ua(this.apiClient,e);return s=A("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Ja(this.apiClient,d),f=new Tr;return Object.assign(f,c),f})}}async createInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Oa(this.apiClient,e);return s=A("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=za(),c=new _r;return Object.assign(c,d),c})}}async get(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qa(this.apiClient,e);return s=A("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>gn(this.apiClient,d))}}async delete(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ha(this.apiClient,e);return s=A("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=Ya(),c=new Er;return Object.assign(c,d),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wa(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Za(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function es(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Wa(o,n)),t}function Xa(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Za(o,n)),t}function Qa(o,e){const t={},n=r(e,["speaker"]);n!=null&&a(t,["speaker"],n);const i=r(e,["voiceConfig"]);return i!=null&&a(t,["voiceConfig"],es(o,i)),t}function ja(o,e){const t={},n=r(e,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Qa(o,s))),a(t,["speakerVoiceConfigs"],i)}return t}function el(o,e){const t={},n=r(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],es(o,n));const i=r(e,["multiSpeakerVoiceConfig"]);i!=null&&a(t,["multiSpeakerVoiceConfig"],ja(o,i));const s=r(e,["languageCode"]);return s!=null&&a(t,["languageCode"],s),t}function tl(o,e){const t={},n=r(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],Xa(o,n)),r(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=r(e,["languageCode"]);return i!=null&&a(t,["languageCode"],i),t}function nl(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function ol(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function il(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function sl(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function rl(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],nl(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],il(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function al(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],ol(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],sl(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ll(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>rl(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ul(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>al(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function cl(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function dl(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function fl(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function pl(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function ml(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],fl(o,n)),t}function hl(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],pl(o,n)),t}function gl(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function yl(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function vl(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],gl(o,n)),t}function Cl(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],yl(o,n)),t}function Tl(){return{}}function _l(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function El(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],_l(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function xl(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],El(o,n)),t}function Sl(){return{}}function Il(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>cl(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],ml(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],vl(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],Sl());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function Al(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>dl(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],hl(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],Cl(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],Tl());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],xl(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function wl(o,e){const t={},n=r(e,["handle"]);if(n!=null&&a(t,["handle"],n),r(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Ml(o,e){const t={},n=r(e,["handle"]);n!=null&&a(t,["handle"],n);const i=r(e,["transparent"]);return i!=null&&a(t,["transparent"],i),t}function ri(){return{}}function ai(){return{}}function Rl(o,e){const t={},n=r(e,["disabled"]);n!=null&&a(t,["disabled"],n);const i=r(e,["startOfSpeechSensitivity"]);i!=null&&a(t,["startOfSpeechSensitivity"],i);const s=r(e,["endOfSpeechSensitivity"]);s!=null&&a(t,["endOfSpeechSensitivity"],s);const l=r(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const u=r(e,["silenceDurationMs"]);return u!=null&&a(t,["silenceDurationMs"],u),t}function kl(o,e){const t={},n=r(e,["disabled"]);n!=null&&a(t,["disabled"],n);const i=r(e,["startOfSpeechSensitivity"]);i!=null&&a(t,["startOfSpeechSensitivity"],i);const s=r(e,["endOfSpeechSensitivity"]);s!=null&&a(t,["endOfSpeechSensitivity"],s);const l=r(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const u=r(e,["silenceDurationMs"]);return u!=null&&a(t,["silenceDurationMs"],u),t}function Nl(o,e){const t={},n=r(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],Rl(o,n));const i=r(e,["activityHandling"]);i!=null&&a(t,["activityHandling"],i);const s=r(e,["turnCoverage"]);return s!=null&&a(t,["turnCoverage"],s),t}function Pl(o,e){const t={},n=r(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],kl(o,n));const i=r(e,["activityHandling"]);i!=null&&a(t,["activityHandling"],i);const s=r(e,["turnCoverage"]);return s!=null&&a(t,["turnCoverage"],s),t}function bl(o,e){const t={},n=r(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Dl(o,e){const t={},n=r(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Ll(o,e){const t={},n=r(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const i=r(e,["slidingWindow"]);return i!=null&&a(t,["slidingWindow"],bl(o,i)),t}function Vl(o,e){const t={},n=r(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const i=r(e,["slidingWindow"]);return i!=null&&a(t,["slidingWindow"],Dl(o,i)),t}function Fl(o,e){const t={},n=r(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Ul(o,e){const t={},n=r(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Bl(o,e,t){const n={},i=r(e,["generationConfig"]);t!==void 0&&i!=null&&a(t,["setup","generationConfig"],i);const s=r(e,["responseModalities"]);t!==void 0&&s!=null&&a(t,["setup","generationConfig","responseModalities"],s);const l=r(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const u=r(e,["topP"]);t!==void 0&&u!=null&&a(t,["setup","generationConfig","topP"],u);const d=r(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const c=r(e,["maxOutputTokens"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","maxOutputTokens"],c);const f=r(e,["mediaResolution"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","mediaResolution"],f);const p=r(e,["seed"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","seed"],p);const m=r(e,["speechConfig"]);t!==void 0&&m!=null&&a(t,["setup","generationConfig","speechConfig"],el(o,Ki(o,m)));const h=r(e,["enableAffectiveDialog"]);t!==void 0&&h!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],h);const g=r(e,["systemInstruction"]);t!==void 0&&g!=null&&a(t,["setup","systemInstruction"],ll(o,K(o,g)));const y=r(e,["tools"]);if(t!==void 0&&y!=null){let q=Ht(o,y);Array.isArray(q)&&(q=q.map(H=>Il(o,qt(o,H)))),a(t,["setup","tools"],q)}const C=r(e,["sessionResumption"]);t!==void 0&&C!=null&&a(t,["setup","sessionResumption"],wl(o,C));const x=r(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&a(t,["setup","inputAudioTranscription"],ri());const S=r(e,["outputAudioTranscription"]);t!==void 0&&S!=null&&a(t,["setup","outputAudioTranscription"],ri());const I=r(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&a(t,["setup","realtimeInputConfig"],Nl(o,I));const k=r(e,["contextWindowCompression"]);t!==void 0&&k!=null&&a(t,["setup","contextWindowCompression"],Ll(o,k));const D=r(e,["proactivity"]);return t!==void 0&&D!=null&&a(t,["setup","proactivity"],Fl(o,D)),n}function Gl(o,e,t){const n={},i=r(e,["generationConfig"]);t!==void 0&&i!=null&&a(t,["setup","generationConfig"],i);const s=r(e,["responseModalities"]);t!==void 0&&s!=null&&a(t,["setup","generationConfig","responseModalities"],s);const l=r(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const u=r(e,["topP"]);t!==void 0&&u!=null&&a(t,["setup","generationConfig","topP"],u);const d=r(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const c=r(e,["maxOutputTokens"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","maxOutputTokens"],c);const f=r(e,["mediaResolution"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","mediaResolution"],f);const p=r(e,["seed"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","seed"],p);const m=r(e,["speechConfig"]);t!==void 0&&m!=null&&a(t,["setup","generationConfig","speechConfig"],tl(o,Ki(o,m)));const h=r(e,["enableAffectiveDialog"]);t!==void 0&&h!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],h);const g=r(e,["systemInstruction"]);t!==void 0&&g!=null&&a(t,["setup","systemInstruction"],ul(o,K(o,g)));const y=r(e,["tools"]);if(t!==void 0&&y!=null){let q=Ht(o,y);Array.isArray(q)&&(q=q.map(H=>Al(o,qt(o,H)))),a(t,["setup","tools"],q)}const C=r(e,["sessionResumption"]);t!==void 0&&C!=null&&a(t,["setup","sessionResumption"],Ml(o,C));const x=r(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&a(t,["setup","inputAudioTranscription"],ai());const S=r(e,["outputAudioTranscription"]);t!==void 0&&S!=null&&a(t,["setup","outputAudioTranscription"],ai());const I=r(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&a(t,["setup","realtimeInputConfig"],Pl(o,I));const k=r(e,["contextWindowCompression"]);t!==void 0&&k!=null&&a(t,["setup","contextWindowCompression"],Vl(o,k));const D=r(e,["proactivity"]);return t!==void 0&&D!=null&&a(t,["setup","proactivity"],Ul(o,D)),n}function Ol(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["setup","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Bl(o,i,t)),t}function ql(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["setup","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],Gl(o,i,t)),t}function Hl(){return{}}function $l(){return{}}function Jl(){return{}}function zl(){return{}}function Yl(o,e){const t={},n=r(e,["media"]);n!=null&&a(t,["mediaChunks"],$i(o,n));const i=r(e,["audio"]);i!=null&&a(t,["audio"],Ar(o,i));const s=r(e,["audioStreamEnd"]);s!=null&&a(t,["audioStreamEnd"],s);const l=r(e,["video"]);l!=null&&a(t,["video"],Ir(o,l));const u=r(e,["text"]);return u!=null&&a(t,["text"],u),r(e,["activityStart"])!=null&&a(t,["activityStart"],Hl()),r(e,["activityEnd"])!=null&&a(t,["activityEnd"],Jl()),t}function Kl(o,e){const t={},n=r(e,["media"]);if(n!=null&&a(t,["mediaChunks"],$i(o,n)),r(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=r(e,["audioStreamEnd"]);if(i!=null&&a(t,["audioStreamEnd"],i),r(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(r(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return r(e,["activityStart"])!=null&&a(t,["activityStart"],$l()),r(e,["activityEnd"])!=null&&a(t,["activityEnd"],zl()),t}function ts(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["weight"]);return i!=null&&a(t,["weight"],i),t}function Wl(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ts(o,s))),a(t,["weightedPrompts"],i)}return t}function ns(o,e){const t={},n=r(e,["temperature"]);n!=null&&a(t,["temperature"],n);const i=r(e,["topK"]);i!=null&&a(t,["topK"],i);const s=r(e,["seed"]);s!=null&&a(t,["seed"],s);const l=r(e,["guidance"]);l!=null&&a(t,["guidance"],l);const u=r(e,["bpm"]);u!=null&&a(t,["bpm"],u);const d=r(e,["density"]);d!=null&&a(t,["density"],d);const c=r(e,["brightness"]);c!=null&&a(t,["brightness"],c);const f=r(e,["scale"]);f!=null&&a(t,["scale"],f);const p=r(e,["muteBass"]);p!=null&&a(t,["muteBass"],p);const m=r(e,["muteDrums"]);m!=null&&a(t,["muteDrums"],m);const h=r(e,["onlyBassAndDrums"]);h!=null&&a(t,["onlyBassAndDrums"],h);const g=r(e,["musicGenerationMode"]);return g!=null&&a(t,["musicGenerationMode"],g),t}function Zl(o,e){const t={},n=r(e,["musicGenerationConfig"]);return n!=null&&a(t,["musicGenerationConfig"],ns(o,n)),t}function os(o,e){const t={},n=r(e,["model"]);return n!=null&&a(t,["model"],n),t}function is(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ts(o,s))),a(t,["weightedPrompts"],i)}return t}function yn(o,e){const t={},n=r(e,["setup"]);n!=null&&a(t,["setup"],os(o,n));const i=r(e,["clientContent"]);i!=null&&a(t,["clientContent"],is(o,i));const s=r(e,["musicGenerationConfig"]);s!=null&&a(t,["musicGenerationConfig"],ns(o,s));const l=r(e,["playbackControl"]);return l!=null&&a(t,["playbackControl"],l),t}function Xl(){return{}}function Ql(){return{}}function jl(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function eu(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function tu(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function nu(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function ou(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],jl(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],tu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function iu(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],eu(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],nu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function su(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>ou(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function ru(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>iu(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function li(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["finished"]);return i!=null&&a(t,["finished"],i),t}function ui(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["finished"]);return i!=null&&a(t,["finished"],i),t}function au(o,e){const t={},n=r(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const i=r(e,["urlRetrievalStatus"]);return i!=null&&a(t,["urlRetrievalStatus"],i),t}function lu(o,e){const t={},n=r(e,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>au(o,s))),a(t,["urlMetadata"],i)}return t}function uu(o,e){const t={},n=r(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],su(o,n));const i=r(e,["turnComplete"]);i!=null&&a(t,["turnComplete"],i);const s=r(e,["interrupted"]);s!=null&&a(t,["interrupted"],s);const l=r(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const u=r(e,["generationComplete"]);u!=null&&a(t,["generationComplete"],u);const d=r(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],li(o,d));const c=r(e,["outputTranscription"]);c!=null&&a(t,["outputTranscription"],li(o,c));const f=r(e,["urlContextMetadata"]);return f!=null&&a(t,["urlContextMetadata"],lu(o,f)),t}function cu(o,e){const t={},n=r(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],ru(o,n));const i=r(e,["turnComplete"]);i!=null&&a(t,["turnComplete"],i);const s=r(e,["interrupted"]);s!=null&&a(t,["interrupted"],s);const l=r(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const u=r(e,["generationComplete"]);u!=null&&a(t,["generationComplete"],u);const d=r(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],ui(o,d));const c=r(e,["outputTranscription"]);return c!=null&&a(t,["outputTranscription"],ui(o,c)),t}function du(o,e){const t={},n=r(e,["id"]);n!=null&&a(t,["id"],n);const i=r(e,["args"]);i!=null&&a(t,["args"],i);const s=r(e,["name"]);return s!=null&&a(t,["name"],s),t}function fu(o,e){const t={},n=r(e,["args"]);n!=null&&a(t,["args"],n);const i=r(e,["name"]);return i!=null&&a(t,["name"],i),t}function pu(o,e){const t={},n=r(e,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>du(o,s))),a(t,["functionCalls"],i)}return t}function mu(o,e){const t={},n=r(e,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>fu(o,s))),a(t,["functionCalls"],i)}return t}function hu(o,e){const t={},n=r(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function gu(o,e){const t={},n=r(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function ut(o,e){const t={},n=r(e,["modality"]);n!=null&&a(t,["modality"],n);const i=r(e,["tokenCount"]);return i!=null&&a(t,["tokenCount"],i),t}function ct(o,e){const t={},n=r(e,["modality"]);n!=null&&a(t,["modality"],n);const i=r(e,["tokenCount"]);return i!=null&&a(t,["tokenCount"],i),t}function yu(o,e){const t={},n=r(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const i=r(e,["cachedContentTokenCount"]);i!=null&&a(t,["cachedContentTokenCount"],i);const s=r(e,["responseTokenCount"]);s!=null&&a(t,["responseTokenCount"],s);const l=r(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const u=r(e,["thoughtsTokenCount"]);u!=null&&a(t,["thoughtsTokenCount"],u);const d=r(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const c=r(e,["promptTokensDetails"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(g=>ut(o,g))),a(t,["promptTokensDetails"],h)}const f=r(e,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>ut(o,g))),a(t,["cacheTokensDetails"],h)}const p=r(e,["responseTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(g=>ut(o,g))),a(t,["responseTokensDetails"],h)}const m=r(e,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>ut(o,g))),a(t,["toolUsePromptTokensDetails"],h)}return t}function vu(o,e){const t={},n=r(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const i=r(e,["cachedContentTokenCount"]);i!=null&&a(t,["cachedContentTokenCount"],i);const s=r(e,["candidatesTokenCount"]);s!=null&&a(t,["responseTokenCount"],s);const l=r(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const u=r(e,["thoughtsTokenCount"]);u!=null&&a(t,["thoughtsTokenCount"],u);const d=r(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const c=r(e,["promptTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>ct(o,y))),a(t,["promptTokensDetails"],g)}const f=r(e,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(y=>ct(o,y))),a(t,["cacheTokensDetails"],g)}const p=r(e,["candidatesTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>ct(o,y))),a(t,["responseTokensDetails"],g)}const m=r(e,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(y=>ct(o,y))),a(t,["toolUsePromptTokensDetails"],g)}const h=r(e,["trafficType"]);return h!=null&&a(t,["trafficType"],h),t}function Cu(o,e){const t={},n=r(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function Tu(o,e){const t={},n=r(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function _u(o,e){const t={},n=r(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const i=r(e,["resumable"]);i!=null&&a(t,["resumable"],i);const s=r(e,["lastConsumedClientMessageIndex"]);return s!=null&&a(t,["lastConsumedClientMessageIndex"],s),t}function Eu(o,e){const t={},n=r(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const i=r(e,["resumable"]);i!=null&&a(t,["resumable"],i);const s=r(e,["lastConsumedClientMessageIndex"]);return s!=null&&a(t,["lastConsumedClientMessageIndex"],s),t}function xu(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Xl());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],uu(o,i));const s=r(e,["toolCall"]);s!=null&&a(t,["toolCall"],pu(o,s));const l=r(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],hu(o,l));const u=r(e,["usageMetadata"]);u!=null&&a(t,["usageMetadata"],yu(o,u));const d=r(e,["goAway"]);d!=null&&a(t,["goAway"],Cu(o,d));const c=r(e,["sessionResumptionUpdate"]);return c!=null&&a(t,["sessionResumptionUpdate"],_u(o,c)),t}function Su(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Ql());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],cu(o,i));const s=r(e,["toolCall"]);s!=null&&a(t,["toolCall"],mu(o,s));const l=r(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],gu(o,l));const u=r(e,["usageMetadata"]);u!=null&&a(t,["usageMetadata"],vu(o,u));const d=r(e,["goAway"]);d!=null&&a(t,["goAway"],Tu(o,d));const c=r(e,["sessionResumptionUpdate"]);return c!=null&&a(t,["sessionResumptionUpdate"],Eu(o,c)),t}function Iu(){return{}}function Au(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["weight"]);return i!=null&&a(t,["weight"],i),t}function wu(o,e){const t={},n=r(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Au(o,s))),a(t,["weightedPrompts"],i)}return t}function Mu(o,e){const t={},n=r(e,["temperature"]);n!=null&&a(t,["temperature"],n);const i=r(e,["topK"]);i!=null&&a(t,["topK"],i);const s=r(e,["seed"]);s!=null&&a(t,["seed"],s);const l=r(e,["guidance"]);l!=null&&a(t,["guidance"],l);const u=r(e,["bpm"]);u!=null&&a(t,["bpm"],u);const d=r(e,["density"]);d!=null&&a(t,["density"],d);const c=r(e,["brightness"]);c!=null&&a(t,["brightness"],c);const f=r(e,["scale"]);f!=null&&a(t,["scale"],f);const p=r(e,["muteBass"]);p!=null&&a(t,["muteBass"],p);const m=r(e,["muteDrums"]);m!=null&&a(t,["muteDrums"],m);const h=r(e,["onlyBassAndDrums"]);h!=null&&a(t,["onlyBassAndDrums"],h);const g=r(e,["musicGenerationMode"]);return g!=null&&a(t,["musicGenerationMode"],g),t}function Ru(o,e){const t={},n=r(e,["clientContent"]);n!=null&&a(t,["clientContent"],wu(o,n));const i=r(e,["musicGenerationConfig"]);return i!=null&&a(t,["musicGenerationConfig"],Mu(o,i)),t}function ku(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);i!=null&&a(t,["mimeType"],i);const s=r(e,["sourceMetadata"]);return s!=null&&a(t,["sourceMetadata"],Ru(o,s)),t}function Nu(o,e){const t={},n=r(e,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ku(o,s))),a(t,["audioChunks"],i)}return t}function Pu(o,e){const t={},n=r(e,["text"]);n!=null&&a(t,["text"],n);const i=r(e,["filteredReason"]);return i!=null&&a(t,["filteredReason"],i),t}function bu(o,e){const t={};r(e,["setupComplete"])!=null&&a(t,["setupComplete"],Iu());const i=r(e,["serverContent"]);i!=null&&a(t,["serverContent"],Nu(o,i));const s=r(e,["filteredPrompt"]);return s!=null&&a(t,["filteredPrompt"],Pu(o,s)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Du(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function Lu(o,e){const t={};if(r(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function Vu(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Du(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],Lu(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function Jt(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Vu(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Fu(o,e){const t={};if(r(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=r(e,["category"]);n!=null&&a(t,["category"],n);const i=r(e,["threshold"]);return i!=null&&a(t,["threshold"],i),t}function Uu(o,e){const t={},n=r(e,["behavior"]);n!=null&&a(t,["behavior"],n);const i=r(e,["description"]);i!=null&&a(t,["description"],i);const s=r(e,["name"]);s!=null&&a(t,["name"],s);const l=r(e,["parameters"]);l!=null&&a(t,["parameters"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],u),t}function Bu(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function Gu(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Bu(o,n)),t}function Ou(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function qu(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Ou(o,n)),t}function Hu(){return{}}function $u(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>Uu(o,c))),a(t,["functionDeclarations"],d)}if(r(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=r(e,["googleSearch"]);i!=null&&a(t,["googleSearch"],Gu(o,i));const s=r(e,["googleSearchRetrieval"]);if(s!=null&&a(t,["googleSearchRetrieval"],qu(o,s)),r(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(r(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");r(e,["urlContext"])!=null&&a(t,["urlContext"],Hu());const u=r(e,["codeExecution"]);return u!=null&&a(t,["codeExecution"],u),t}function Ju(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function zu(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Yu(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],zu(o,n)),t}function Ku(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],Ju(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Yu(o,i)),t}function Wu(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function ss(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Wu(o,n)),t}function Zu(o,e){const t={},n=r(e,["speaker"]);n!=null&&a(t,["speaker"],n);const i=r(e,["voiceConfig"]);return i!=null&&a(t,["voiceConfig"],ss(o,i)),t}function Xu(o,e){const t={},n=r(e,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Zu(o,s))),a(t,["speakerVoiceConfigs"],i)}return t}function Qu(o,e){const t={},n=r(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],ss(o,n));const i=r(e,["multiSpeakerVoiceConfig"]);i!=null&&a(t,["multiSpeakerVoiceConfig"],Xu(o,i));const s=r(e,["languageCode"]);return s!=null&&a(t,["languageCode"],s),t}function ju(o,e){const t={},n=r(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const i=r(e,["thinkingBudget"]);return i!=null&&a(t,["thinkingBudget"],i),t}function ec(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],Jt(o,K(o,i)));const s=r(e,["temperature"]);s!=null&&a(n,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(n,["topP"],l);const u=r(e,["topK"]);u!=null&&a(n,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(n,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(n,["stopSequences"],f);const p=r(e,["responseLogprobs"]);p!=null&&a(n,["responseLogprobs"],p);const m=r(e,["logprobs"]);m!=null&&a(n,["logprobs"],m);const h=r(e,["presencePenalty"]);h!=null&&a(n,["presencePenalty"],h);const g=r(e,["frequencyPenalty"]);g!=null&&a(n,["frequencyPenalty"],g);const y=r(e,["seed"]);y!=null&&a(n,["seed"],y);const C=r(e,["responseMimeType"]);C!=null&&a(n,["responseMimeType"],C);const x=r(e,["responseSchema"]);if(x!=null&&a(n,["responseSchema"],Nt(o,x)),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=r(e,["safetySettings"]);if(t!==void 0&&S!=null){let L=S;Array.isArray(L)&&(L=L.map(ne=>Fu(o,ne))),a(t,["safetySettings"],L)}const I=r(e,["tools"]);if(t!==void 0&&I!=null){let L=Ht(o,I);Array.isArray(L)&&(L=L.map(ne=>$u(o,qt(o,ne)))),a(t,["tools"],L)}const k=r(e,["toolConfig"]);if(t!==void 0&&k!=null&&a(t,["toolConfig"],Ku(o,k)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=r(e,["cachedContent"]);t!==void 0&&D!=null&&a(t,["cachedContent"],ve(o,D));const q=r(e,["responseModalities"]);q!=null&&a(n,["responseModalities"],q);const H=r(e,["mediaResolution"]);H!=null&&a(n,["mediaResolution"],H);const j=r(e,["speechConfig"]);if(j!=null&&a(n,["speechConfig"],Qu(o,Yi(o,j))),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=r(e,["thinkingConfig"]);return P!=null&&a(n,["thinkingConfig"],ju(o,P)),n}function ci(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=te(o,i);Array.isArray(l)&&(l=l.map(u=>Jt(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["generationConfig"],ec(o,s,t)),t}function tc(o,e,t){const n={},i=r(e,["taskType"]);t!==void 0&&i!=null&&a(t,["requests[]","taskType"],i);const s=r(e,["title"]);t!==void 0&&s!=null&&a(t,["requests[]","title"],s);const l=r(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&a(t,["requests[]","outputDimensionality"],l),r(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function nc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);i!=null&&a(t,["requests[]","content"],zi(o,i));const s=r(e,["config"]);s!=null&&a(t,["config"],tc(o,s,t));const l=r(e,["model"]);return l!==void 0&&a(t,["requests[]","model"],V(o,l)),t}function oc(o,e,t){const n={};if(r(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=r(e,["numberOfImages"]);t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i);const s=r(e,["aspectRatio"]);t!==void 0&&s!=null&&a(t,["parameters","aspectRatio"],s);const l=r(e,["guidanceScale"]);if(t!==void 0&&l!=null&&a(t,["parameters","guidanceScale"],l),r(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=r(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&a(t,["parameters","safetySetting"],u);const d=r(e,["personGeneration"]);t!==void 0&&d!=null&&a(t,["parameters","personGeneration"],d);const c=r(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&a(t,["parameters","includeSafetyAttributes"],c);const f=r(e,["includeRaiReason"]);t!==void 0&&f!=null&&a(t,["parameters","includeRaiReason"],f);const p=r(e,["language"]);t!==void 0&&p!=null&&a(t,["parameters","language"],p);const m=r(e,["outputMimeType"]);t!==void 0&&m!=null&&a(t,["parameters","outputOptions","mimeType"],m);const h=r(e,["outputCompressionQuality"]);if(t!==void 0&&h!=null&&a(t,["parameters","outputOptions","compressionQuality"],h),r(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function ic(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],oc(o,s,t)),t}function sc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function rc(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const u=r(e,["queryBase"]);return t!==void 0&&u!=null&&a(t,["_url","models_url"],Xi(o,u)),n}function ac(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],rc(o,n,t)),t}function lc(o,e,t){const n={},i=r(e,["displayName"]);t!==void 0&&i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);t!==void 0&&s!=null&&a(t,["description"],s);const l=r(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function uc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],lc(o,i,t)),t}function cc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function dc(o,e){const t={};if(r(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function fc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=te(o,i);Array.isArray(l)&&(l=l.map(u=>Jt(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],dc(o,s)),t}function pc(o,e){const t={};if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(e,["imageBytes"]);n!=null&&a(t,["bytesBase64Encoded"],Ce(o,n));const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function mc(o,e,t){const n={},i=r(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i),r(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=r(e,["durationSeconds"]);if(t!==void 0&&s!=null&&a(t,["parameters","durationSeconds"],s),r(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=r(e,["aspectRatio"]);if(t!==void 0&&l!=null&&a(t,["parameters","aspectRatio"],l),r(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=r(e,["personGeneration"]);if(t!==void 0&&u!=null&&a(t,["parameters","personGeneration"],u),r(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=r(e,["negativePrompt"]);if(t!==void 0&&d!=null&&a(t,["parameters","negativePrompt"],d),r(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function hc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(t,["instances[0]","image"],pc(o,s));const l=r(e,["config"]);return l!=null&&a(t,["config"],mc(o,l,t)),t}function gc(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function yc(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function vc(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],gc(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],yc(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function ze(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>vc(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Cc(o,e){const t={},n=r(e,["featureSelectionPreference"]);return n!=null&&a(t,["featureSelectionPreference"],n),t}function Tc(o,e){const t={},n=r(e,["method"]);n!=null&&a(t,["method"],n);const i=r(e,["category"]);i!=null&&a(t,["category"],i);const s=r(e,["threshold"]);return s!=null&&a(t,["threshold"],s),t}function _c(o,e){const t={};if(r(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(e,["description"]);n!=null&&a(t,["description"],n);const i=r(e,["name"]);i!=null&&a(t,["name"],i);const s=r(e,["parameters"]);s!=null&&a(t,["parameters"],s);const l=r(e,["response"]);return l!=null&&a(t,["response"],l),t}function Ec(o,e){const t={},n=r(e,["startTime"]);n!=null&&a(t,["startTime"],n);const i=r(e,["endTime"]);return i!=null&&a(t,["endTime"],i),t}function xc(o,e){const t={},n=r(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Ec(o,n)),t}function Sc(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["dynamicThreshold"]);return i!=null&&a(t,["dynamicThreshold"],i),t}function Ic(o,e){const t={},n=r(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Sc(o,n)),t}function Ac(){return{}}function wc(o,e){const t={},n=r(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function Mc(o,e){const t={},n=r(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],wc(o,n));const i=r(e,["authType"]);i!=null&&a(t,["authType"],i);const s=r(e,["googleServiceAccountConfig"]);s!=null&&a(t,["googleServiceAccountConfig"],s);const l=r(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const u=r(e,["oauthConfig"]);u!=null&&a(t,["oauthConfig"],u);const d=r(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function Rc(o,e){const t={},n=r(e,["authConfig"]);return n!=null&&a(t,["authConfig"],Mc(o,n)),t}function rs(o,e){const t={},n=r(e,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>_c(o,p))),a(t,["functionDeclarations"],f)}const i=r(e,["retrieval"]);i!=null&&a(t,["retrieval"],i);const s=r(e,["googleSearch"]);s!=null&&a(t,["googleSearch"],xc(o,s));const l=r(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],Ic(o,l)),r(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],Ac());const d=r(e,["googleMaps"]);if(d!=null&&a(t,["googleMaps"],Rc(o,d)),r(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=r(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function kc(o,e){const t={},n=r(e,["mode"]);n!=null&&a(t,["mode"],n);const i=r(e,["allowedFunctionNames"]);return i!=null&&a(t,["allowedFunctionNames"],i),t}function Nc(o,e){const t={},n=r(e,["latitude"]);n!=null&&a(t,["latitude"],n);const i=r(e,["longitude"]);return i!=null&&a(t,["longitude"],i),t}function Pc(o,e){const t={},n=r(e,["latLng"]);return n!=null&&a(t,["latLng"],Nc(o,n)),t}function bc(o,e){const t={},n=r(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],kc(o,n));const i=r(e,["retrievalConfig"]);return i!=null&&a(t,["retrievalConfig"],Pc(o,i)),t}function Dc(o,e){const t={},n=r(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Lc(o,e){const t={},n=r(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],Dc(o,n)),t}function Vc(o,e){const t={},n=r(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],Lc(o,n)),r(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=r(e,["languageCode"]);return i!=null&&a(t,["languageCode"],i),t}function Fc(o,e){const t={},n=r(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const i=r(e,["thinkingBudget"]);return i!=null&&a(t,["thinkingBudget"],i),t}function Uc(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],ze(o,K(o,i)));const s=r(e,["temperature"]);s!=null&&a(n,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(n,["topP"],l);const u=r(e,["topK"]);u!=null&&a(n,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(n,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(n,["stopSequences"],f);const p=r(e,["responseLogprobs"]);p!=null&&a(n,["responseLogprobs"],p);const m=r(e,["logprobs"]);m!=null&&a(n,["logprobs"],m);const h=r(e,["presencePenalty"]);h!=null&&a(n,["presencePenalty"],h);const g=r(e,["frequencyPenalty"]);g!=null&&a(n,["frequencyPenalty"],g);const y=r(e,["seed"]);y!=null&&a(n,["seed"],y);const C=r(e,["responseMimeType"]);C!=null&&a(n,["responseMimeType"],C);const x=r(e,["responseSchema"]);x!=null&&a(n,["responseSchema"],Nt(o,x));const S=r(e,["routingConfig"]);S!=null&&a(n,["routingConfig"],S);const I=r(e,["modelSelectionConfig"]);I!=null&&a(n,["modelConfig"],Cc(o,I));const k=r(e,["safetySettings"]);if(t!==void 0&&k!=null){let ae=k;Array.isArray(ae)&&(ae=ae.map(Yt=>Tc(o,Yt))),a(t,["safetySettings"],ae)}const D=r(e,["tools"]);if(t!==void 0&&D!=null){let ae=Ht(o,D);Array.isArray(ae)&&(ae=ae.map(Yt=>rs(o,qt(o,Yt)))),a(t,["tools"],ae)}const q=r(e,["toolConfig"]);t!==void 0&&q!=null&&a(t,["toolConfig"],bc(o,q));const H=r(e,["labels"]);t!==void 0&&H!=null&&a(t,["labels"],H);const j=r(e,["cachedContent"]);t!==void 0&&j!=null&&a(t,["cachedContent"],ve(o,j));const P=r(e,["responseModalities"]);P!=null&&a(n,["responseModalities"],P);const L=r(e,["mediaResolution"]);L!=null&&a(n,["mediaResolution"],L);const ne=r(e,["speechConfig"]);ne!=null&&a(n,["speechConfig"],Vc(o,Yi(o,ne)));const Un=r(e,["audioTimestamp"]);Un!=null&&a(n,["audioTimestamp"],Un);const Bn=r(e,["thinkingConfig"]);return Bn!=null&&a(n,["thinkingConfig"],Fc(o,Bn)),n}function di(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=te(o,i);Array.isArray(l)&&(l=l.map(u=>ze(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["generationConfig"],Uc(o,s,t)),t}function Bc(o,e,t){const n={},i=r(e,["taskType"]);t!==void 0&&i!=null&&a(t,["instances[]","task_type"],i);const s=r(e,["title"]);t!==void 0&&s!=null&&a(t,["instances[]","title"],s);const l=r(e,["outputDimensionality"]);t!==void 0&&l!=null&&a(t,["parameters","outputDimensionality"],l);const u=r(e,["mimeType"]);t!==void 0&&u!=null&&a(t,["instances[]","mimeType"],u);const d=r(e,["autoTruncate"]);return t!==void 0&&d!=null&&a(t,["parameters","autoTruncate"],d),n}function Gc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);i!=null&&a(t,["instances[]","content"],zi(o,i));const s=r(e,["config"]);return s!=null&&a(t,["config"],Bc(o,s,t)),t}function Oc(o,e,t){const n={},i=r(e,["outputGcsUri"]);t!==void 0&&i!=null&&a(t,["parameters","storageUri"],i);const s=r(e,["negativePrompt"]);t!==void 0&&s!=null&&a(t,["parameters","negativePrompt"],s);const l=r(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const u=r(e,["aspectRatio"]);t!==void 0&&u!=null&&a(t,["parameters","aspectRatio"],u);const d=r(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const c=r(e,["seed"]);t!==void 0&&c!=null&&a(t,["parameters","seed"],c);const f=r(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&a(t,["parameters","safetySetting"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&a(t,["parameters","includeSafetyAttributes"],m);const h=r(e,["includeRaiReason"]);t!==void 0&&h!=null&&a(t,["parameters","includeRaiReason"],h);const g=r(e,["language"]);t!==void 0&&g!=null&&a(t,["parameters","language"],g);const y=r(e,["outputMimeType"]);t!==void 0&&y!=null&&a(t,["parameters","outputOptions","mimeType"],y);const C=r(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&a(t,["parameters","outputOptions","compressionQuality"],C);const x=r(e,["addWatermark"]);t!==void 0&&x!=null&&a(t,["parameters","addWatermark"],x);const S=r(e,["enhancePrompt"]);return t!==void 0&&S!=null&&a(t,["parameters","enhancePrompt"],S),n}function qc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],Oc(o,s,t)),t}function Dn(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const i=r(e,["imageBytes"]);i!=null&&a(t,["bytesBase64Encoded"],Ce(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function Hc(o,e){const t={},n=r(e,["maskMode"]);n!=null&&a(t,["maskMode"],n);const i=r(e,["segmentationClasses"]);i!=null&&a(t,["maskClasses"],i);const s=r(e,["maskDilation"]);return s!=null&&a(t,["dilation"],s),t}function $c(o,e){const t={},n=r(e,["controlType"]);n!=null&&a(t,["controlType"],n);const i=r(e,["enableControlImageComputation"]);return i!=null&&a(t,["computeControl"],i),t}function Jc(o,e){const t={},n=r(e,["styleDescription"]);return n!=null&&a(t,["styleDescription"],n),t}function zc(o,e){const t={},n=r(e,["subjectType"]);n!=null&&a(t,["subjectType"],n);const i=r(e,["subjectDescription"]);return i!=null&&a(t,["subjectDescription"],i),t}function Yc(o,e){const t={},n=r(e,["referenceImage"]);n!=null&&a(t,["referenceImage"],Dn(o,n));const i=r(e,["referenceId"]);i!=null&&a(t,["referenceId"],i);const s=r(e,["referenceType"]);s!=null&&a(t,["referenceType"],s);const l=r(e,["maskImageConfig"]);l!=null&&a(t,["maskImageConfig"],Hc(o,l));const u=r(e,["controlImageConfig"]);u!=null&&a(t,["controlImageConfig"],$c(o,u));const d=r(e,["styleImageConfig"]);d!=null&&a(t,["styleImageConfig"],Jc(o,d));const c=r(e,["subjectImageConfig"]);return c!=null&&a(t,["subjectImageConfig"],zc(o,c)),t}function Kc(o,e,t){const n={},i=r(e,["outputGcsUri"]);t!==void 0&&i!=null&&a(t,["parameters","storageUri"],i);const s=r(e,["negativePrompt"]);t!==void 0&&s!=null&&a(t,["parameters","negativePrompt"],s);const l=r(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const u=r(e,["aspectRatio"]);t!==void 0&&u!=null&&a(t,["parameters","aspectRatio"],u);const d=r(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const c=r(e,["seed"]);t!==void 0&&c!=null&&a(t,["parameters","seed"],c);const f=r(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&a(t,["parameters","safetySetting"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&a(t,["parameters","includeSafetyAttributes"],m);const h=r(e,["includeRaiReason"]);t!==void 0&&h!=null&&a(t,["parameters","includeRaiReason"],h);const g=r(e,["language"]);t!==void 0&&g!=null&&a(t,["parameters","language"],g);const y=r(e,["outputMimeType"]);t!==void 0&&y!=null&&a(t,["parameters","outputOptions","mimeType"],y);const C=r(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&a(t,["parameters","outputOptions","compressionQuality"],C);const x=r(e,["editMode"]);t!==void 0&&x!=null&&a(t,["parameters","editMode"],x);const S=r(e,["baseSteps"]);return t!==void 0&&S!=null&&a(t,["parameters","editConfig","baseSteps"],S),n}function Wc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["referenceImages"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>Yc(o,d))),a(t,["instances[0]","referenceImages"],u)}const l=r(e,["config"]);return l!=null&&a(t,["config"],Kc(o,l,t)),t}function Zc(o,e,t){const n={},i=r(e,["includeRaiReason"]);t!==void 0&&i!=null&&a(t,["parameters","includeRaiReason"],i);const s=r(e,["outputMimeType"]);t!==void 0&&s!=null&&a(t,["parameters","outputOptions","mimeType"],s);const l=r(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&a(t,["parameters","outputOptions","compressionQuality"],l);const u=r(e,["numberOfImages"]);t!==void 0&&u!=null&&a(t,["parameters","sampleCount"],u);const d=r(e,["mode"]);return t!==void 0&&d!=null&&a(t,["parameters","mode"],d),n}function Xc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["image"]);i!=null&&a(t,["instances[0]","image"],Dn(o,i));const s=r(e,["upscaleFactor"]);s!=null&&a(t,["parameters","upscaleConfig","upscaleFactor"],s);const l=r(e,["config"]);return l!=null&&a(t,["config"],Zc(o,l,t)),t}function Qc(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function jc(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const u=r(e,["queryBase"]);return t!==void 0&&u!=null&&a(t,["_url","models_url"],Xi(o,u)),n}function ed(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],jc(o,n,t)),t}function td(o,e,t){const n={},i=r(e,["displayName"]);t!==void 0&&i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);t!==void 0&&s!=null&&a(t,["description"],s);const l=r(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function nd(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],td(o,i,t)),t}function od(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","name"],V(o,n));const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function id(o,e,t){const n={},i=r(e,["systemInstruction"]);t!==void 0&&i!=null&&a(t,["systemInstruction"],ze(o,K(o,i)));const s=r(e,["tools"]);if(t!==void 0&&s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>rs(o,d))),a(t,["tools"],u)}const l=r(e,["generationConfig"]);return t!==void 0&&l!=null&&a(t,["generationConfig"],l),n}function sd(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=te(o,i);Array.isArray(l)&&(l=l.map(u=>ze(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],id(o,s,t)),t}function rd(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["contents"]);if(i!=null){let l=te(o,i);Array.isArray(l)&&(l=l.map(u=>ze(o,u))),a(t,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(t,["config"],s),t}function ad(o,e,t){const n={},i=r(e,["numberOfVideos"]);t!==void 0&&i!=null&&a(t,["parameters","sampleCount"],i);const s=r(e,["outputGcsUri"]);t!==void 0&&s!=null&&a(t,["parameters","storageUri"],s);const l=r(e,["fps"]);t!==void 0&&l!=null&&a(t,["parameters","fps"],l);const u=r(e,["durationSeconds"]);t!==void 0&&u!=null&&a(t,["parameters","durationSeconds"],u);const d=r(e,["seed"]);t!==void 0&&d!=null&&a(t,["parameters","seed"],d);const c=r(e,["aspectRatio"]);t!==void 0&&c!=null&&a(t,["parameters","aspectRatio"],c);const f=r(e,["resolution"]);t!==void 0&&f!=null&&a(t,["parameters","resolution"],f);const p=r(e,["personGeneration"]);t!==void 0&&p!=null&&a(t,["parameters","personGeneration"],p);const m=r(e,["pubsubTopic"]);t!==void 0&&m!=null&&a(t,["parameters","pubsubTopic"],m);const h=r(e,["negativePrompt"]);t!==void 0&&h!=null&&a(t,["parameters","negativePrompt"],h);const g=r(e,["enhancePrompt"]);return t!==void 0&&g!=null&&a(t,["parameters","enhancePrompt"],g),n}function ld(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["_url","model"],V(o,n));const i=r(e,["prompt"]);i!=null&&a(t,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(t,["instances[0]","image"],Dn(o,s));const l=r(e,["config"]);return l!=null&&a(t,["config"],ad(o,l,t)),t}function ud(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function cd(o,e){const t={},n=r(e,["data"]);n!=null&&a(t,["data"],n);const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function dd(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],ud(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],cd(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function fd(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>dd(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function pd(o,e){const t={},n=r(e,["citationSources"]);return n!=null&&a(t,["citations"],n),t}function md(o,e){const t={},n=r(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const i=r(e,["urlRetrievalStatus"]);return i!=null&&a(t,["urlRetrievalStatus"],i),t}function hd(o,e){const t={},n=r(e,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>md(o,s))),a(t,["urlMetadata"],i)}return t}function gd(o,e){const t={},n=r(e,["content"]);n!=null&&a(t,["content"],fd(o,n));const i=r(e,["citationMetadata"]);i!=null&&a(t,["citationMetadata"],pd(o,i));const s=r(e,["tokenCount"]);s!=null&&a(t,["tokenCount"],s);const l=r(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const u=r(e,["urlContextMetadata"]);u!=null&&a(t,["urlContextMetadata"],hd(o,u));const d=r(e,["avgLogprobs"]);d!=null&&a(t,["avgLogprobs"],d);const c=r(e,["groundingMetadata"]);c!=null&&a(t,["groundingMetadata"],c);const f=r(e,["index"]);f!=null&&a(t,["index"],f);const p=r(e,["logprobsResult"]);p!=null&&a(t,["logprobsResult"],p);const m=r(e,["safetyRatings"]);return m!=null&&a(t,["safetyRatings"],m),t}function fi(o,e){const t={},n=r(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>gd(o,d))),a(t,["candidates"],u)}const i=r(e,["modelVersion"]);i!=null&&a(t,["modelVersion"],i);const s=r(e,["promptFeedback"]);s!=null&&a(t,["promptFeedback"],s);const l=r(e,["usageMetadata"]);return l!=null&&a(t,["usageMetadata"],l),t}function yd(o,e){const t={},n=r(e,["values"]);return n!=null&&a(t,["values"],n),t}function vd(){return{}}function Cd(o,e){const t={},n=r(e,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>yd(o,l))),a(t,["embeddings"],s)}return r(e,["metadata"])!=null&&a(t,["metadata"],vd()),t}function Td(o,e){const t={},n=r(e,["bytesBase64Encoded"]);n!=null&&a(t,["imageBytes"],Ce(o,n));const i=r(e,["mimeType"]);return i!=null&&a(t,["mimeType"],i),t}function as(o,e){const t={},n=r(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const i=r(e,["safetyAttributes","scores"]);i!=null&&a(t,["scores"],i);const s=r(e,["contentType"]);return s!=null&&a(t,["contentType"],s),t}function _d(o,e){const t={},n=r(e,["_self"]);n!=null&&a(t,["image"],Td(o,n));const i=r(e,["raiFilteredReason"]);i!=null&&a(t,["raiFilteredReason"],i);const s=r(e,["_self"]);return s!=null&&a(t,["safetyAttributes"],as(o,s)),t}function Ed(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>_d(o,l))),a(t,["generatedImages"],s)}const i=r(e,["positivePromptSafetyAttributes"]);return i!=null&&a(t,["positivePromptSafetyAttributes"],as(o,i)),t}function xd(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["updateTime"]);return s!=null&&a(t,["updateTime"],s),t}function vn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);s!=null&&a(t,["description"],s);const l=r(e,["version"]);l!=null&&a(t,["version"],l);const u=r(e,["_self"]);u!=null&&a(t,["tunedModelInfo"],xd(o,u));const d=r(e,["inputTokenLimit"]);d!=null&&a(t,["inputTokenLimit"],d);const c=r(e,["outputTokenLimit"]);c!=null&&a(t,["outputTokenLimit"],c);const f=r(e,["supportedGenerationMethods"]);return f!=null&&a(t,["supportedActions"],f),t}function Sd(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["_self"]);if(i!=null){let s=Qi(o,i);Array.isArray(s)&&(s=s.map(l=>vn(o,l))),a(t,["models"],s)}return t}function Id(){return{}}function Ad(o,e){const t={},n=r(e,["totalTokens"]);n!=null&&a(t,["totalTokens"],n);const i=r(e,["cachedContentTokenCount"]);return i!=null&&a(t,["cachedContentTokenCount"],i),t}function wd(o,e){const t={},n=r(e,["video","uri"]);n!=null&&a(t,["uri"],n);const i=r(e,["video","encodedVideo"]);i!=null&&a(t,["videoBytes"],Ce(o,i));const s=r(e,["encoding"]);return s!=null&&a(t,["mimeType"],s),t}function Md(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],wd(o,n)),t}function Rd(o,e){const t={},n=r(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Md(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function kd(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response","generateVideoResponse"]);return u!=null&&a(t,["response"],Rd(o,u)),t}function Nd(o,e){const t={},n=r(e,["fps"]);n!=null&&a(t,["fps"],n);const i=r(e,["endOffset"]);i!=null&&a(t,["endOffset"],i);const s=r(e,["startOffset"]);return s!=null&&a(t,["startOffset"],s),t}function Pd(o,e){const t={},n=r(e,["displayName"]);n!=null&&a(t,["displayName"],n);const i=r(e,["data"]);i!=null&&a(t,["data"],i);const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function bd(o,e){const t={},n=r(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Nd(o,n));const i=r(e,["thought"]);i!=null&&a(t,["thought"],i);const s=r(e,["inlineData"]);s!=null&&a(t,["inlineData"],Pd(o,s));const l=r(e,["codeExecutionResult"]);l!=null&&a(t,["codeExecutionResult"],l);const u=r(e,["executableCode"]);u!=null&&a(t,["executableCode"],u);const d=r(e,["fileData"]);d!=null&&a(t,["fileData"],d);const c=r(e,["functionCall"]);c!=null&&a(t,["functionCall"],c);const f=r(e,["functionResponse"]);f!=null&&a(t,["functionResponse"],f);const p=r(e,["text"]);return p!=null&&a(t,["text"],p),t}function Dd(o,e){const t={},n=r(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>bd(o,l))),a(t,["parts"],s)}const i=r(e,["role"]);return i!=null&&a(t,["role"],i),t}function Ld(o,e){const t={},n=r(e,["citations"]);return n!=null&&a(t,["citations"],n),t}function Vd(o,e){const t={},n=r(e,["content"]);n!=null&&a(t,["content"],Dd(o,n));const i=r(e,["citationMetadata"]);i!=null&&a(t,["citationMetadata"],Ld(o,i));const s=r(e,["finishMessage"]);s!=null&&a(t,["finishMessage"],s);const l=r(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const u=r(e,["avgLogprobs"]);u!=null&&a(t,["avgLogprobs"],u);const d=r(e,["groundingMetadata"]);d!=null&&a(t,["groundingMetadata"],d);const c=r(e,["index"]);c!=null&&a(t,["index"],c);const f=r(e,["logprobsResult"]);f!=null&&a(t,["logprobsResult"],f);const p=r(e,["safetyRatings"]);return p!=null&&a(t,["safetyRatings"],p),t}function pi(o,e){const t={},n=r(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>Vd(o,f))),a(t,["candidates"],c)}const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["responseId"]);s!=null&&a(t,["responseId"],s);const l=r(e,["modelVersion"]);l!=null&&a(t,["modelVersion"],l);const u=r(e,["promptFeedback"]);u!=null&&a(t,["promptFeedback"],u);const d=r(e,["usageMetadata"]);return d!=null&&a(t,["usageMetadata"],d),t}function Fd(o,e){const t={},n=r(e,["truncated"]);n!=null&&a(t,["truncated"],n);const i=r(e,["token_count"]);return i!=null&&a(t,["tokenCount"],i),t}function Ud(o,e){const t={},n=r(e,["values"]);n!=null&&a(t,["values"],n);const i=r(e,["statistics"]);return i!=null&&a(t,["statistics"],Fd(o,i)),t}function Bd(o,e){const t={},n=r(e,["billableCharacterCount"]);return n!=null&&a(t,["billableCharacterCount"],n),t}function Gd(o,e){const t={},n=r(e,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ud(o,l))),a(t,["embeddings"],s)}const i=r(e,["metadata"]);return i!=null&&a(t,["metadata"],Bd(o,i)),t}function Od(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["imageBytes"],Ce(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function ls(o,e){const t={},n=r(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const i=r(e,["safetyAttributes","scores"]);i!=null&&a(t,["scores"],i);const s=r(e,["contentType"]);return s!=null&&a(t,["contentType"],s),t}function Ln(o,e){const t={},n=r(e,["_self"]);n!=null&&a(t,["image"],Od(o,n));const i=r(e,["raiFilteredReason"]);i!=null&&a(t,["raiFilteredReason"],i);const s=r(e,["_self"]);s!=null&&a(t,["safetyAttributes"],ls(o,s));const l=r(e,["prompt"]);return l!=null&&a(t,["enhancedPrompt"],l),t}function qd(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ln(o,l))),a(t,["generatedImages"],s)}const i=r(e,["positivePromptSafetyAttributes"]);return i!=null&&a(t,["positivePromptSafetyAttributes"],ls(o,i)),t}function Hd(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ln(o,s))),a(t,["generatedImages"],i)}return t}function $d(o,e){const t={},n=r(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ln(o,s))),a(t,["generatedImages"],i)}return t}function Jd(o,e){const t={},n=r(e,["endpoint"]);n!=null&&a(t,["name"],n);const i=r(e,["deployedModelId"]);return i!=null&&a(t,["deployedModelId"],i),t}function zd(o,e){const t={},n=r(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["createTime"]);i!=null&&a(t,["createTime"],i);const s=r(e,["updateTime"]);return s!=null&&a(t,["updateTime"],s),t}function Yd(o,e){const t={},n=r(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const i=r(e,["epoch"]);i!=null&&a(t,["epoch"],i);const s=r(e,["step"]);return s!=null&&a(t,["step"],s),t}function Cn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["displayName"]);i!=null&&a(t,["displayName"],i);const s=r(e,["description"]);s!=null&&a(t,["description"],s);const l=r(e,["versionId"]);l!=null&&a(t,["version"],l);const u=r(e,["deployedModels"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(h=>Jd(o,h))),a(t,["endpoints"],m)}const d=r(e,["labels"]);d!=null&&a(t,["labels"],d);const c=r(e,["_self"]);c!=null&&a(t,["tunedModelInfo"],zd(o,c));const f=r(e,["defaultCheckpointId"]);f!=null&&a(t,["defaultCheckpointId"],f);const p=r(e,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Yd(o,h))),a(t,["checkpoints"],m)}return t}function Kd(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["_self"]);if(i!=null){let s=Qi(o,i);Array.isArray(s)&&(s=s.map(l=>Cn(o,l))),a(t,["models"],s)}return t}function Wd(){return{}}function Zd(o,e){const t={},n=r(e,["totalTokens"]);return n!=null&&a(t,["totalTokens"],n),t}function Xd(o,e){const t={},n=r(e,["tokensInfo"]);return n!=null&&a(t,["tokensInfo"],n),t}function Qd(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["videoBytes"],Ce(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function jd(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],Qd(o,n)),t}function ef(o,e){const t={},n=r(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>jd(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function tf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],ef(o,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nf="Content-Type",of="X-Server-Timeout",sf="User-Agent",Tn="x-goog-api-client",rf="0.15.0",af=`google-genai-sdk/${rf}`,lf="v1beta1",uf="v1beta",mi=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class us extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class _n extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class cf{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:lf,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:uf,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?n[i]=Object.assign(Object.assign({},n[i]),s):s!==void 0&&(n[i]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const i=new AbortController,s=i.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>i.abort(),t.timeout),n&&n.addEventListener("abort",()=>{i.abort()}),e.signal=s}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await hi(i),new mn(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await hi(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return je(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield F(i.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=s.decode(d);try{const p=JSON.parse(c);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,g=m.code,y=`got status: ${h}. ${JSON.stringify(p)}`;if(g>=400&&g<500)throw new us(y);if(g>=500&&g<600)throw new _n(y)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}l+=c;let f=l.match(mi);for(;f;){const p=f[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield F(new mn(m)),l=l.slice(f[0].length),f=l.match(mi)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=af+" "+this.clientOptions.userAgentExtra;return e[sf]=t,e[Tn]=t,e[nf]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,i]of Object.entries(e.headers))t.append(n,i);e.timeout&&e.timeout>0&&t.append(of,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);i.sizeBytes=String(l.size);const u=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d=await this.fetchUploadUrl(i,t);return s.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var n;let i={};t!=null&&t.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},l=await this.request({path:A("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=l==null?void 0:l.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function hi(o){var e;if(o===void 0)throw new _n("response is undefined");if(!o.ok){const t=o.status,n=o.statusText;let i;!((e=o.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await o.json():i={error:{message:await o.text(),code:o.status,status:o.statusText}};const s=`got status: ${t} ${n}. ${JSON.stringify(i)}`;throw t>=400&&t<500?new us(s):t>=500&&t<600?new _n(s):new Error(s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const df="mcp_used/unknown";function En(o){for(const e of o)if(Vn(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function xn(o){var e;o[Tn]=(((e=o[Tn])!==null&&e!==void 0?e:"")+` ${df}`).trimStart()}function ff(o){var e,t,n;return(n=(t=(e=o.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Vn(i)))!==null&&n!==void 0?n:!1}function pf(o){var e,t,n;return(n=(t=(e=o.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>!Vn(i)))!==null&&n!==void 0?n:!1}function Vn(o){return o!==null&&typeof o=="object"&&"tool"in o&&"callTool"in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function mf(o,e,t){const n=new Sr,i=JSON.parse(t.data),s=bu(o,i);Object.assign(n,s),e(n)}class hf{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=vf(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(I=>{c=I}),p=e.callbacks,m=function(){c({})},h=this.apiClient,g={onopen:m,onmessage:I=>{mf(h,p.onmessage,I)},onerror:(t=p==null?void 0:p.onerror)!==null&&t!==void 0?t:function(I){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(I){}},y=this.webSocketFactory.create(d,yf(l),g);y.connect(),await f;const C=V(this.apiClient,e.model),x=os(this.apiClient,{model:C}),S=yn(this.apiClient,{setup:x});return y.send(JSON.stringify(S)),new gf(y,this.apiClient)}}class gf{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Wl(this.apiClient,e),n=is(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Zl(this.apiClient,e),n=yn(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const t=yn(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Re.PLAY)}pause(){this.sendPlaybackControl(Re.PAUSE)}stop(){this.sendPlaybackControl(Re.STOP)}resetContext(){this.sendPlaybackControl(Re.RESET_CONTEXT)}close(){this.conn.close()}}function yf(o){const e={};return o.forEach((t,n)=>{e[n]=t}),e}function vf(o){const e=new Headers;for(const[t,n]of Object.entries(o))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cf="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Tf(o,e,t){const n=new xr;let i;if(t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),o.isVertexAI()){const s=Su(o,i);Object.assign(n,s)}else{const s=xu(o,i);Object.assign(n,s)}e(n)}class _f{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new hf(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,s,l,u;const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&En(e.config.tools)&&xn(p);const m=If(p);if(this.apiClient.isVertexAI())f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const P=this.apiClient.getApiKey();f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateContent?key=${P}`}let h=()=>{};const g=new Promise(P=>{h=P}),y=e.callbacks,C=function(){var P;(P=y==null?void 0:y.onopen)===null||P===void 0||P.call(y),h({})},x=this.apiClient,S={onopen:C,onmessage:P=>{Tf(x,y.onmessage,P)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(P){}},I=this.webSocketFactory.create(f,Sf(m),S);I.connect(),await g;let k=V(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&k.startsWith("publishers/")){const P=this.apiClient.getProject(),L=this.apiClient.getLocation();k=`projects/${P}/locations/${L}/`+k}let D={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Rt.AUDIO]}:e.config.responseModalities=[Rt.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const q=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],H=[];for(const P of q)if(this.isCallableTool(P)){const L=P;H.push(await L.tool())}else H.push(P);H.length>0&&(e.config.tools=H);const j={model:k,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?D=ql(this.apiClient,j):D=Ol(this.apiClient,j),delete D.config,I.send(JSON.stringify(D)),new xf(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Ef={turnComplete:!0};class xf{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=te(e,t.turns),e.isVertexAI()?n=n.map(i=>ze(e,i)):n=n.map(i=>Jt(e,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(Cf)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Ef),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Kl(this.apiClient,e)}:t={realtimeInput:Yl(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Sf(o){const e={};return o.forEach((t,n)=>{e[n]=t}),e}function If(o){const e=new Headers;for(const[t,n]of Object.entries(o))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gi=10;function yi(o){var e,t,n;if(!((e=o==null?void 0:o.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=o==null?void 0:o.tools)!==null&&t!==void 0?t:[])if(yt(l)){i=!0;break}if(!i)return!0;const s=(n=o==null?void 0:o.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function yt(o){return"callTool"in o&&typeof o.callTool=="function"}function vi(o){var e;return!(!((e=o==null?void 0:o.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Af extends rt{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,i,s,l,u;if(t.config&&t.config.tools&&En(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),xn(t.config.httpOptions.headers)),!ff(t)||yi(t.config))return await this.generateContentInternal(t);if(pf(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const d=await this.transformCallableTools(t);let c,f;const p=te(this.apiClient,d.contents),m=(s=(i=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:gi;let h=0;for(;h<m&&(c=await this.generateContentInternal(d),!(!c.functionCalls||c.functionCalls.length===0));){const g=c.candidates[0].content,y=[];for(const C of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(yt(C)){const S=await C.callTool(c.functionCalls);y.push(...S)}h++,f={role:"user",parts:y},d.contents=te(this.apiClient,d.contents),d.contents.push(g),d.contents.push(f),vi(d.config)&&(p.push(g),p.push(f))}return vi(d.config)&&(c.automaticFunctionCallingHistory=p),c},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&En(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),xn(t.config.httpOptions.headers)),yi(t.config)){const n=await this.transformCallableTools(t);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let s;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:l.push(d);let u;return s?u={generatedImages:l,positivePromptSafetyAttributes:s}:u={generatedImages:l},u}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new $t(Je.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(i)}}async transformCallableTools(e){var t;const n=(t=e.config)===null||t===void 0?void 0:t.tools;if(!n)return e;const i=await Promise.all(n.map(async l=>yt(l)?await l.tool():l)),s={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};return s.config.tools=i,s}async initAfcToolsMap(e){var t,n,i;const s=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(yt(l)){const u=l,d=await u.tool();for(const c of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,u)}}return s}async processAfcStream(e){var t,n,i;const s=(i=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:gi;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return function(c,f,p){var m,h;return je(this,arguments,function*(){for(var g,y,C,x;u<s;){l&&(u++,l=!1);const D=yield F(c.transformCallableTools(p)),q=yield F(c.generateContentStreamInternal(D)),H=[],j=[];try{for(var S=!0,I=(y=void 0,gt(q)),k;k=yield F(I.next()),g=k.done,!g;S=!0){x=k.value,S=!1;const P=x;if(yield yield F(P),P.candidates&&(!((m=P.candidates[0])===null||m===void 0)&&m.content)){j.push(P.candidates[0].content);for(const L of(h=P.candidates[0].content.parts)!==null&&h!==void 0?h:[])if(u<s&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(L.functionCall.name)){const ne=yield F(f.get(L.functionCall.name).callTool([L.functionCall]));H.push(...ne)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(P){y={error:P}}finally{try{!S&&!g&&(C=I.return)&&(yield F(C.call(I)))}finally{if(y)throw y.error}}if(H.length>0){l=!0;const P=new Ye;P.candidates=[{content:{role:"user",parts:H}}],yield yield F(P);const L=[];L.push(...j),L.push({role:"user",parts:H});const ne=te(c.apiClient,p.contents).concat(L);p.contents=ne}else break}})}(this,d,e)}async generateContentInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=di(this.apiClient,e);return u=A("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=pi(this.apiClient,f),m=new Ye;return Object.assign(m,p),m})}else{const c=ci(this.apiClient,e);return u=A("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=fi(this.apiClient,f),m=new Ye;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=di(this.apiClient,e);u=A("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(p){return je(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,x=gt(p),S;S=yield F(x.next()),m=S.done,!m;C=!0){y=S.value,C=!1;const k=pi(f,yield F(y.json())),D=new Ye;Object.assign(D,k),yield yield F(D)}}catch(I){h={error:I}}finally{try{!C&&!m&&(g=x.return)&&(yield F(g.call(x)))}finally{if(h)throw h.error}}})})}else{const c=ci(this.apiClient,e);u=A("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(p){return je(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,x=gt(p),S;S=yield F(x.next()),m=S.done,!m;C=!0){y=S.value,C=!1;const k=fi(f,yield F(y.json())),D=new Ye;Object.assign(D,k),yield yield F(D)}}catch(I){h={error:I}}finally{try{!C&&!m&&(g=x.return)&&(yield F(g.call(x)))}finally{if(h)throw h.error}}})})}}async embedContent(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Gc(this.apiClient,e);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Gd(this.apiClient,f),m=new $o;return Object.assign(m,p),m})}else{const c=nc(this.apiClient,e);return u=A("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Cd(this.apiClient,f),m=new $o;return Object.assign(m,p),m})}}async generateImagesInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=qc(this.apiClient,e);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=qd(this.apiClient,f),m=new Jo;return Object.assign(m,p),m})}else{const c=ic(this.apiClient,e);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Ed(this.apiClient,f),m=new Jo;return Object.assign(m,p),m})}}async editImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Wc(this.apiClient,e);return s=A("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Hd(this.apiClient,d),f=new yr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Xc(this.apiClient,e);return s=A("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=$d(this.apiClient,d),f=new vr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Qc(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>Cn(this.apiClient,f))}else{const c=sc(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>vn(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ed(this.apiClient,e);return u=A("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Kd(this.apiClient,f),m=new zo;return Object.assign(m,p),m})}else{const c=ac(this.apiClient,e);return u=A("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Sd(this.apiClient,f),m=new zo;return Object.assign(m,p),m})}}async update(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=nd(this.apiClient,e);return u=A("{model}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>Cn(this.apiClient,f))}else{const c=uc(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>vn(this.apiClient,f))}}async delete(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=od(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Wd(),p=new Yo;return Object.assign(p,f),p})}else{const c=cc(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Id(),p=new Yo;return Object.assign(p,f),p})}}async countTokens(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=sd(this.apiClient,e);return u=A("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Zd(this.apiClient,f),m=new Ko;return Object.assign(m,p),m})}else{const c=fc(this.apiClient,e);return u=A("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Ad(this.apiClient,f),m=new Ko;return Object.assign(m,p),m})}}async computeTokens(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=rd(this.apiClient,e);return s=A("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Xd(this.apiClient,d),f=new Cr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ld(this.apiClient,e);return u=A("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>tf(this.apiClient,f))}else{const c=hc(this.apiClient,e);return u=A("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>kd(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wf(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Mf(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Rf(o,e){const t={},n=r(e,["operationName"]);n!=null&&a(t,["operationName"],n);const i=r(e,["resourceName"]);i!=null&&a(t,["_url","resourceName"],i);const s=r(e,["config"]);return s!=null&&a(t,["config"],s),t}function kf(o,e){const t={},n=r(e,["video","uri"]);n!=null&&a(t,["uri"],n);const i=r(e,["video","encodedVideo"]);i!=null&&a(t,["videoBytes"],Ce(o,i));const s=r(e,["encoding"]);return s!=null&&a(t,["mimeType"],s),t}function Nf(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],kf(o,n)),t}function Pf(o,e){const t={},n=r(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Nf(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function bf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response","generateVideoResponse"]);return u!=null&&a(t,["response"],Pf(o,u)),t}function Df(o,e){const t={},n=r(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const i=r(e,["bytesBase64Encoded"]);i!=null&&a(t,["videoBytes"],Ce(o,i));const s=r(e,["mimeType"]);return s!=null&&a(t,["mimeType"],s),t}function Lf(o,e){const t={},n=r(e,["_self"]);return n!=null&&a(t,["video"],Df(o,n)),t}function Vf(o,e){const t={},n=r(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Lf(o,u))),a(t,["generatedVideos"],l)}const i=r(e,["raiMediaFilteredCount"]);i!=null&&a(t,["raiMediaFilteredCount"],i);const s=r(e,["raiMediaFilteredReasons"]);return s!=null&&a(t,["raiMediaFilteredReasons"],s),t}function Ci(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);l!=null&&a(t,["error"],l);const u=r(e,["response"]);return u!=null&&a(t,["response"],Vf(o,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ff extends rt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;return n&&"httpOptions"in n&&(s=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Mf(this.apiClient,e);return u=A("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>Ci(this.apiClient,f))}else{const c=wf(this.apiClient,e);return u=A("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>bf(this.apiClient,f))}}async fetchPredictVideosOperationInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Rf(this.apiClient,e);return s=A("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Ci(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function Bf(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function Gf(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],Bf(o,n,t)),t}function Of(o,e){const t={},n=r(e,["textInput"]);n!=null&&a(t,["textInput"],n);const i=r(e,["output"]);return i!=null&&a(t,["output"],i),t}function qf(o,e){const t={};if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(e,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Of(o,s))),a(t,["examples","examples"],i)}return t}function Hf(o,e,t){const n={};if(r(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&a(t,["displayName"],i),r(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=r(e,["epochCount"]);t!==void 0&&s!=null&&a(t,["tuningTask","hyperparameters","epochCount"],s);const l=r(e,["learningRateMultiplier"]);if(l!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),r(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=r(e,["batchSize"]);t!==void 0&&u!=null&&a(t,["tuningTask","hyperparameters","batchSize"],u);const d=r(e,["learningRate"]);return t!==void 0&&d!=null&&a(t,["tuningTask","hyperparameters","learningRate"],d),n}function $f(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["trainingDataset"]);i!=null&&a(t,["tuningTask","trainingData"],qf(o,i));const s=r(e,["config"]);return s!=null&&a(t,["config"],Hf(o,s,t)),t}function Jf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["_url","name"],n);const i=r(e,["config"]);return i!=null&&a(t,["config"],i),t}function zf(o,e,t){const n={},i=r(e,["pageSize"]);t!==void 0&&i!=null&&a(t,["_query","pageSize"],i);const s=r(e,["pageToken"]);t!==void 0&&s!=null&&a(t,["_query","pageToken"],s);const l=r(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function Yf(o,e){const t={},n=r(e,["config"]);return n!=null&&a(t,["config"],zf(o,n,t)),t}function Kf(o,e,t){const n={},i=r(e,["gcsUri"]);if(t!==void 0&&i!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],i),r(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Wf(o,e){const t={},n=r(e,["gcsUri"]);return n!=null&&a(t,["validationDatasetUri"],n),t}function Zf(o,e,t){const n={},i=r(e,["validationDataset"]);t!==void 0&&i!=null&&a(t,["supervisedTuningSpec"],Wf(o,i));const s=r(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&a(t,["tunedModelDisplayName"],s);const l=r(e,["description"]);t!==void 0&&l!=null&&a(t,["description"],l);const u=r(e,["epochCount"]);t!==void 0&&u!=null&&a(t,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=r(e,["learningRateMultiplier"]);t!==void 0&&d!=null&&a(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const c=r(e,["exportLastCheckpointOnly"]);t!==void 0&&c!=null&&a(t,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const f=r(e,["adapterSize"]);if(t!==void 0&&f!=null&&a(t,["supervisedTuningSpec","hyperParameters","adapterSize"],f),r(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Xf(o,e){const t={},n=r(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const i=r(e,["trainingDataset"]);i!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],Kf(o,i,t));const s=r(e,["config"]);return s!=null&&a(t,["config"],Zf(o,s,t)),t}function Qf(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["model"],n);const i=r(e,["name"]);return i!=null&&a(t,["endpoint"],i),t}function cs(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["state"]);i!=null&&a(t,["state"],Wi(o,i));const s=r(e,["createTime"]);s!=null&&a(t,["createTime"],s);const l=r(e,["tuningTask","startTime"]);l!=null&&a(t,["startTime"],l);const u=r(e,["tuningTask","completeTime"]);u!=null&&a(t,["endTime"],u);const d=r(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const c=r(e,["description"]);c!=null&&a(t,["description"],c);const f=r(e,["baseModel"]);f!=null&&a(t,["baseModel"],f);const p=r(e,["_self"]);p!=null&&a(t,["tunedModel"],Qf(o,p));const m=r(e,["distillationSpec"]);m!=null&&a(t,["distillationSpec"],m);const h=r(e,["experiment"]);h!=null&&a(t,["experiment"],h);const g=r(e,["labels"]);g!=null&&a(t,["labels"],g);const y=r(e,["pipelineJob"]);y!=null&&a(t,["pipelineJob"],y);const C=r(e,["tunedModelDisplayName"]);return C!=null&&a(t,["tunedModelDisplayName"],C),t}function jf(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>cs(o,l))),a(t,["tuningJobs"],s)}return t}function ep(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["metadata"]);i!=null&&a(t,["metadata"],i);const s=r(e,["done"]);s!=null&&a(t,["done"],s);const l=r(e,["error"]);return l!=null&&a(t,["error"],l),t}function tp(o,e){const t={},n=r(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const i=r(e,["epoch"]);i!=null&&a(t,["epoch"],i);const s=r(e,["step"]);s!=null&&a(t,["step"],s);const l=r(e,["endpoint"]);return l!=null&&a(t,["endpoint"],l),t}function np(o,e){const t={},n=r(e,["model"]);n!=null&&a(t,["model"],n);const i=r(e,["endpoint"]);i!=null&&a(t,["endpoint"],i);const s=r(e,["checkpoints"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>tp(o,u))),a(t,["checkpoints"],l)}return t}function Sn(o,e){const t={},n=r(e,["name"]);n!=null&&a(t,["name"],n);const i=r(e,["state"]);i!=null&&a(t,["state"],Wi(o,i));const s=r(e,["createTime"]);s!=null&&a(t,["createTime"],s);const l=r(e,["startTime"]);l!=null&&a(t,["startTime"],l);const u=r(e,["endTime"]);u!=null&&a(t,["endTime"],u);const d=r(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const c=r(e,["error"]);c!=null&&a(t,["error"],c);const f=r(e,["description"]);f!=null&&a(t,["description"],f);const p=r(e,["baseModel"]);p!=null&&a(t,["baseModel"],p);const m=r(e,["tunedModel"]);m!=null&&a(t,["tunedModel"],np(o,m));const h=r(e,["supervisedTuningSpec"]);h!=null&&a(t,["supervisedTuningSpec"],h);const g=r(e,["tuningDataStats"]);g!=null&&a(t,["tuningDataStats"],g);const y=r(e,["encryptionSpec"]);y!=null&&a(t,["encryptionSpec"],y);const C=r(e,["partnerModelTuningSpec"]);C!=null&&a(t,["partnerModelTuningSpec"],C);const x=r(e,["distillationSpec"]);x!=null&&a(t,["distillationSpec"],x);const S=r(e,["experiment"]);S!=null&&a(t,["experiment"],S);const I=r(e,["labels"]);I!=null&&a(t,["labels"],I);const k=r(e,["pipelineJob"]);k!=null&&a(t,["pipelineJob"],k);const D=r(e,["tunedModelDisplayName"]);return D!=null&&a(t,["tunedModelDisplayName"],D),t}function op(o,e){const t={},n=r(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const i=r(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>Sn(o,l))),a(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ip extends rt{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new $t(Je.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const n=await this.tuneMldevInternal(t);let i="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?i=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:pn.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Jf(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>Sn(this.apiClient,f))}else{const c=Uf(this.apiClient,e);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>cs(this.apiClient,f))}}async listInternal(e){var t,n,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Yf(this.apiClient,e);return u=A("tuningJobs",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=op(this.apiClient,f),m=new Wo;return Object.assign(m,p),m})}else{const c=Gf(this.apiClient,e);return u=A("tunedModels",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const p=jf(this.apiClient,f),m=new Wo;return Object.assign(m,p),m})}}async tuneInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Xf(this.apiClient,e);return s=A("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Sn(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=$f(this.apiClient,e);return s=A("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>ep(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sp{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const rp=1024*1024*8,ap=3,lp=1e3,up=2,Wt="x-goog-upload-status";async function cp(o,e,t){var n,i,s;let l=0,u=0,d=new mn(new Response),c="upload";for(l=o.size;u<l;){const p=Math.min(rp,l-u),m=o.slice(u,u+p);u+p>=l&&(c+=", finalize");let h=0,g=lp;for(;h<ap&&(d=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((n=d==null?void 0:d.headers)===null||n===void 0)&&n[Wt]));)h++,await fp(g),g=g*up;if(u+=p,((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[Wt])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[Wt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function dp(o){return{size:o.size,type:o.type}}function fp(o){return new Promise(e=>setTimeout(e,o))}class pp{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cp(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dp(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mp{create(e,t,n){return new hp(e,t,n)}}class hp{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ti="x-goog-api-key";class gp{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(Ti)===null&&e.append(Ti,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yp="gl-node/";class ds{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=gr(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const i=new gp(this.apiKey);this.apiClient=new cf({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:yp+"web",uploader:new pp,downloader:new sp}),this.models=new Af(this.apiClient),this.live=new _f(this.apiClient,i,new mp),this.chats=new La(this.models,this.apiClient),this.caches=new Pa(this.apiClient),this.files=new Ka(this.apiClient),this.operations=new Ff(this.apiClient),this.tunings=new ip(this.apiClient)}}const vp={low:"Identify only the most essential and defining grammar patterns of the sentence. Focus on major conjunctions, verb conjugations (tense/politeness), and sentence-ending particles. Avoid breaking down common compound words or very simple phrases.",medium:"Provide a balanced analysis. Identify all major grammar patterns, common set phrases, and important vocabulary usage. This is the standard level of detail suitable for most learners.",high:"Perform an exhaustive analysis. Identify every possible grammatical pattern, nuance, idiomatic expression, and compound word structure, no matter how small or common. Deconstruct everything for a very detailed view for advanced study."};function Cp(o){return`You are an advanced linguistic analysis model, acting as a patient, insightful teacher of the Japanese language.
Your primary task is to take a single Japanese sentence and produce a detailed, structured analysis according to the specified JSON schema. Your explanations should be clear enough for a language learner.

Detailed Task Breakdown:
1.  **Sentence Analysis**: Deconstruct the input sentence into its smallest meaningful components (words, particles, etc.).
    For each component in the 'analysis' array:
    *   **Grammatical Category**: Assign a highly specific category. Use the format \`BASE_TYPE-FORM-TENSE-POLARITY\`.
        *   Examples: \`VERB_GODAN-TE-PAST-AFFIRMATIVE\`, \`ADJECTIVE_I-PLAIN-PRESENT-NEGATIVE\`, \`NOUN_COMMON\`.
        *   Available Categories: NOUN_COMMON, NOUN_PROPER, NOUN_PRONOUN, NOUN_COUNTER, VERB_ICHIDAN, VERB_GODAN, VERB_IRREGULAR, VERB_SURU, ADJECTIVE_I, ADJECTIVE_NA, ADVERB, PARTICLE, AUXILIARY_VERB, GRAMMATICAL_AUXILIARY, CONJUNCTION, INTERJECTION, SUFFIX, PREFIX, PUNCTUATION.
    *   **Reading**: Provide the reading in Hiragana or Katakana.
    *   **English Equivalent**: Provide a concise English meaning.
    *   **Pitch Accent**: THIS IS A CRITICAL, MANDATORY FIELD.
        *   Provide the standard Tokyo-dialect pitch accent as a string of 'H' (High) and 'L' (Low).
        *   **RULE: The length of the 'pitch_accent' string MUST EXACTLY match the character length of the 'reading' string.**
        *   Example: If 'reading' is 'ねこ' (2 chars), 'pitch_accent' MUST be 'LH' (2 chars).
        *   Example: If 'reading' is 'ともだち' (4 chars), 'pitch_accent' (heiban) MUST be 'LHHH' (4 chars).
        *   For particles or single-mora words with no accent drop, use the appropriate single letter ('H' or 'L').
        *   If pitch is truly not applicable (like punctuation), provide an empty string "". DO NOT OMIT THE FIELD. Avoid common pitfalls like providing a pattern shorter than the reading.

2.  **Full Translation**: Provide a natural, fluent English translation of the entire sentence.

3.  **Grammar & Phrase Explanations**: In the 'grammar_patterns' array, identify and explain all notable grammar points, set phrases, or nuanced vocabulary.
    *   **Analysis Thoroughness Level: ${o.toUpperCase()}**
    *   **Instruction: ${vp[o]}**
    *   For each pattern, provide its name, a clear explanation for a learner, and the 'constituent_indices' that form the pattern in the 'analysis' array. This section must be comprehensive according to the specified thoroughness level.

Input is a single Japanese sentence. You must respond ONLY with the JSON object defined in the schema. Do not add any conversational text or markdown fences.`}function Tp(){return`You are a Japanese language teaching assistant.
Your task is to provide 2-3 simple, distinct, and pedagogically useful example sentences for the Japanese grammar pattern provided as the user input.

For each example sentence, you MUST provide:
1.  'japanese': The full sentence in Japanese, using Kanji where appropriate.
2.  'reading': The complete furigana reading of the sentence in Hiragana.
3.  'english': A natural and accurate English translation.
4.  'highlight_indices': A two-element array \`[startIndex, endIndex]\` indicating the exact location of the grammar pattern within the 'japanese' string. 'startIndex' is the zero-based index of the first character of the pattern, and 'endIndex' is the zero-based index of the character immediately AFTER the last character of the pattern.

Example for pattern "〜について":
If the user input is "〜について" and a sentence is "日本の文化について話します。", the pattern "について" starts at index 5 and ends at index 9. So, 'highlight_indices' would be [5, 9].

Respond ONLY with a JSON object that adheres to the provided schema. Do not add any extra text or markdown fences.`}const _p={type:"OBJECT",properties:{original_japanese_sentence:{type:"STRING",description:"The original Japanese sentence provided by the user."},analysis:{type:"ARRAY",description:"An array of objects, each representing a segmented component of the Japanese sentence.",items:{type:"OBJECT",properties:{japanese_segment:{type:"STRING",description:"The individual Japanese segment (word, particle, etc.)."},reading:{type:"STRING",description:"The reading of the Japanese segment in Hiragana or Katakana."},category:{type:"STRING",description:"A highly specific grammatical category label for the segment (e.g., 'NOUN_COMMON', 'VERB_ICHIDAN-TE-PAST-AFFIRMATIVE')."},english_equivalent:{type:"STRING",description:"A direct, concise English equivalent of the segment."},pitch_accent:{type:"STRING",description:`CRITICAL: A string representing the pitch accent pattern using 'H' for high and 'L' for low. This string's length MUST exactly match the character length of the 'reading' field. For heiban words, use 'L' followed by all 'H's (e.g., reading 'ともだち' -> pitch 'LHHH'). For non-applicable segments like punctuation, this MUST be an empty string "". Do not omit this field.`}},required:["japanese_segment","reading","category","english_equivalent","pitch_accent"]}},grammar_patterns:{type:"ARRAY",description:"A comprehensive array of identified grammatical patterns, idiomatic phrases, or nuanced vocabulary in the sentence.",items:{type:"OBJECT",properties:{pattern_name:{type:"STRING",description:"The name of the grammatical pattern or the phrase being explained (e.g., '〜なければならない', 'よろしくお願いします')."},explanation:{type:"STRING",description:"A detailed explanation of the pattern's meaning, usage, and nuance for a language learner."},constituent_indices:{type:"ARRAY",description:"An array of zero-based indices from the 'analysis' array that form this pattern.",items:{type:"NUMBER"}}},required:["pattern_name","explanation","constituent_indices"]}},english_translation:{type:"STRING",description:"The complete, natural-sounding English translation of the entire Japanese sentence."}},required:["original_japanese_sentence","analysis","grammar_patterns","english_translation"]},Ep={type:"ARRAY",description:"An array of 2-3 simple example sentences for the given grammar pattern.",items:{type:"OBJECT",properties:{japanese:{type:"STRING",description:"The full example sentence in Japanese, including Kanji."},reading:{type:"STRING",description:"The complete reading of the Japanese sentence in Hiragana."},english:{type:"STRING",description:"The natural English translation of the sentence."},highlight_indices:{type:"ARRAY",description:"A two-element array [startIndex, endIndex] indicating the character position of the grammar pattern within the 'japanese' string. startIndex is inclusive, endIndex is exclusive.",items:{type:"NUMBER"},minItems:2,maxItems:2}},required:["japanese","reading","english","highlight_indices"]}};async function fs(o,e=3,t=1e3){let n=0,i=t;for(;;)try{return await o()}catch(s){const l=(s.message||"").toLowerCase();if((l.includes("429")||l.includes("resource_exhausted"))&&n<e){n++;const d=Math.random()*500;console.warn(`Rate limit hit. Retrying in ${Math.round(i+d)}ms... (Attempt ${n}/${e})`),await new Promise(c=>setTimeout(c,i+d)),i*=2}else throw s}}async function xp(o,e,t){return fs(async()=>{var f;const i=new ds({apiKey:o}),s=Cp(t),u=(await i.models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:e,config:{systemInstruction:s,responseMimeType:"application/json",responseSchema:_p,temperature:.1,seed:42}})).text,d=((f=u.trim().match(/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s))==null?void 0:f[1])||u.trim(),c=JSON.parse(d);return Array.isArray(c)?c[0]:c})}async function Sp(o,e){const t=async()=>{var u;const n=new ds({apiKey:o}),i=Tp(),s=await n.models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:e,config:{systemInstruction:i,responseMimeType:"application/json",responseSchema:Ep,temperature:.01,seed:42}});let l=((u=s.text.trim().match(/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s))==null?void 0:u[1])||s.text.trim();return JSON.parse(l)};try{return await fs(t)}catch(n){throw console.error(`Failed to get examples for "${e}":`,n),new Error(`Could not generate examples for ${e}.`)}}function at(o,e="main",t){const n=Fi(o,t);e==="analysis"?G.innerHTML=n:(Bt.classList.remove("hidden"),U.classList.add("hidden"),Y.innerHTML=n,G.innerHTML="")}function ps(){if(!$){const o=document.createElement("button");o.className="fixed bottom-5 right-5 w-12 h-12 bg-accent text-primary-text rounded-full shadow-lg flex items-center justify-center text-2xl font-bold opacity-0 invisible transform translate-y-5 transition-all duration-300 hover:bg-accent/90 z-50",o.innerHTML="&#8679;",o.title="Back to analyzed sentence",document.body.appendChild(o),Cs(o)}}function _i(){const o=Y.querySelector(".clickable-sentence.selected");if(!o)return;ps(),$&&($.onclick=()=>o.scrollIntoView({behavior:"smooth",block:"center"}),$.title="Back to analyzed sentence"),Ee&&Ee.disconnect();const e=new IntersectionObserver(([t])=>{$==null||$.classList.toggle("opacity-0",t.isIntersecting),$==null||$.classList.toggle("invisible",t.isIntersecting),$==null||$.classList.toggle("translate-y-5",t.isIntersecting)},{root:null,threshold:.1});e.observe(Y),xi(e)}function ue(){try{W.sort((o,e)=>e.updatedAt-o.updatedAt),localStorage.setItem(ys,JSON.stringify(W))}catch(o){console.error("Failed to save history to localStorage",o)}}function Ip(){try{const o=localStorage.getItem(ys);o&&en(JSON.parse(o))}catch(o){console.error("Failed to load or parse history from localStorage",o),en([])}Be()}function Ap(){const o=()=>{on.classList.remove("translate-x-full"),dt.classList.remove("invisible","opacity-0")},e=()=>{on.classList.add("translate-x-full"),dt.classList.add("invisible","opacity-0")};wi.addEventListener("click",o),Mi.addEventListener("click",e),dt.addEventListener("click",e),kn.addEventListener("click",()=>{W.length!==0&&sn("Are you sure you want to delete all your saved texts? This cannot be undone.",()=>{Es(),ue(),Be(),B&&Et()},{confirmText:"Delete All"})}),_t.addEventListener("click",t=>{const i=t.target.closest("[data-action]");if(!i)return;const{action:s,entryId:l}=i.dataset;if(!s||!l)return;const u=J(l);if(u)switch(s){case"load":e(),localStorage.removeItem("japanese-analyzer-unsaved-title"),localStorage.removeItem("japanese-analyzer-unsaved-text"),Fn(l);break;case"delete":sn(`Are you sure you want to delete "${u.title}"?`,()=>{const d=B===l;_s(l),ue(),Be(),d&&Et()},{confirmText:"Delete"});break}})}function wp(){Ip(),Ap()}const Zt=new Set;async function zt(o,e,t){var i;const n=(i=o.analyzedSentences[e])==null?void 0:i[t];if(n)return n;if(!Pe)throw new Error("API Key is not configured. Please add one in the settings menu.");try{const s=await xp(Pe,e.trim(),t);return Ts(e,s,t),ue(),Be(),s}catch(s){throw console.error(`Analysis failed for: "${e}"`,s),s}}async function Mp(o,e){var i;const t=o.text.split(`
`).flatMap(s=>{var l;return((l=s.match(/[^。？！\s]+[。？！]?/g))==null?void 0:l.filter(u=>u==null?void 0:u.trim()))||[]}),n=e+1;if(n<t.length){const s=t[n];(i=o.analyzedSentences[s])!=null&&i[ee]||(console.log(`Prefetching analysis for: "${s}"`),zt(o,s,ee).catch(l=>{console.warn(`Prefetch failed for sentence ${n+1}:`,l.message)}))}}async function et(o,e){var l;const t=o.text.split(`
`).flatMap(u=>{var d;return((d=u.match(/[^。？！\s]+[。？！]?/g))==null?void 0:d.filter(c=>c==null?void 0:c.trim()))||[]});if(e<0||e>=t.length||t.length===0){Fn(o.id);return}const n=t[e];Ds();const i=(l=o.analyzedSentences[n])==null?void 0:l[ee];i?Jn(o,e,i):bs(o,e),window.scrollTo({top:0,behavior:"auto"}),X(),Ee&&Ee.disconnect(),tt&&window.removeEventListener("scroll",tt),ps();const s=$;if(s){s.onclick=()=>window.scrollTo({top:0,behavior:"smooth"}),s.title="Scroll to top",s.classList.add("opacity-0","invisible","translate-y-5");const u=()=>{if(U.classList.contains("hidden"))return;const d=window.scrollY>window.innerHeight/2;s.classList.toggle("opacity-0",!d),s.classList.toggle("invisible",!d),s.classList.toggle("translate-y-5",!d)};window.addEventListener("scroll",u),Si(u)}if(!i){if(Zt.has(n)){console.log(`Analysis for "${n}" is already in progress.`);return}try{Zt.add(n);const u=await zt(o,n,ee),d=U.querySelector("#reading-mode-sentence-input");if(d&&parseInt(d.value,10)===e+1){const c=U.querySelector("#reading-mode-content-wrapper");if(c){c.style.transition="opacity 0.2s ease-in-out",c.style.opacity="0",await new Promise(m=>setTimeout(m,200)),Ue(c,u,{stickyTopClass:"top-14"});const f=t.length,p=U.querySelector("#reading-nav-next");p&&(p.disabled=e>=f-1),X(),c.style.opacity="1",setTimeout(()=>{c.style.transition=""},250)}else Jn(o,e,u),X()}}catch(u){const d=u instanceof Error?u:new Error("An unknown error occurred during analysis."),{main:c,detail:f}=Pn(d),p=U.querySelector("#reading-mode-content-wrapper");p?p.innerHTML=Fi(c,f):at(c,"main",f)}finally{Zt.delete(n)}}await Mp(o,e)}function Fn(o){const e=J(o);e&&(Bi(),be.classList.add("hidden"),_e.value=e.title,me.value=e.text,An(o),Ot(e),G.innerHTML='<p class="text-center p-8 text-slate-500">Select a sentence to analyze, or start reading mode.</p>',st())}const ms=[{label:"XX-Small",value:"0.75"},{label:"X-Small",value:"0.85"},{label:"Small",value:"1.0"},{label:"Medium",value:"1.15"},{label:"Large",value:"1.3"},{label:"X-Large",value:"1.5"}],Ei=2;function hs(){const o=localStorage.getItem(Lt)||"light";document.documentElement.classList.toggle("dark",o==="dark"),Xe.checked=o==="dark";const e=localStorage.getItem(Vt)==="true";De.checked=!e;const t=localStorage.getItem(Ft)!=="false";Le.checked=!t;const n=localStorage.getItem(Ut)!=="false";nt.checked=!n,X();const i=localStorage.getItem(Dt),s=i&&Xt.includes(i)?i:"medium";Ii(s);const l=Xt.indexOf(s);Ct.value=String(l),wn.textContent=s.charAt(0).toUpperCase()+s.slice(1);const u=ms,d=localStorage.getItem(vs),c=d?parseInt(d,10):Ei,f=c>=0&&c<u.length?c:Ei;if(f>=0&&f<u.length){const h=u[f];document.documentElement.style.setProperty("--font-size-multiplier",h.value),Tt.value=String(f),Mn.textContent=h.label}const p=localStorage.getItem(In);jt(p||void 0||null),ke.value="",p?(ke.placeholder="API key saved",pe.textContent="Using key from local storage.",pe.classList.remove("text-warning-text","font-semibold")):(pe.textContent="No API key found. Please add one.",pe.classList.add("text-warning-text","font-semibold")),st()}function Rp(){Xe.addEventListener("change",()=>{var t;const o=Xe.checked?"dark":"light";document.documentElement.classList.toggle("dark",Xe.checked),localStorage.setItem(Lt,o);const e=Y.querySelector(".clickable-sentence.selected");if(e!=null&&e.dataset.sentence&&B){const n=J(B),i=(t=n==null?void 0:n.analyzedSentences[e.dataset.sentence])==null?void 0:t[ee];i&&(Ue(G,i),X())}})}function kp(){De.addEventListener("change",()=>{const o=!De.checked;localStorage.setItem(Vt,String(o)),X()}),Le.addEventListener("change",()=>{const o=!Le.checked;localStorage.setItem(Ft,String(o)),X()}),nt.addEventListener("change",()=>{const o=!nt.checked;localStorage.setItem(Ut,String(o)),X()})}function Np(){Ct.addEventListener("input",()=>{const o=Xt[parseInt(Ct.value,10)];if(wn.textContent=o.charAt(0).toUpperCase()+o.slice(1),Ii(o),localStorage.setItem(Dt,o),B){const e=J(B);if(!e)return;if(Ot(e),!U.classList.contains("hidden")){et(e,e.readingProgress);return}const t=Y.querySelector(".clickable-sentence.selected");if(t!=null&&t.dataset.sentence){const n=t.dataset.sentence;G.innerHTML=`<p class="text-center p-8 text-text-muted">Analyzing with new '${o}' setting...</p>`,zt(e,n,o).then(i=>{Ue(G,i),X()}).catch(i=>{const s=i instanceof Error?i:new Error(String(i)),{main:l,detail:u}=Pn(s);at(l,"analysis",u)})}}})}function Pp(){const o=ms;Tt.addEventListener("input",()=>{const e=parseInt(Tt.value,10);if(e>=0&&e<o.length){const t=o[e];document.documentElement.style.setProperty("--font-size-multiplier",t.value),Mn.textContent=t.label,localStorage.setItem(vs,String(e))}})}function bp(){Ni.addEventListener("click",()=>{const o=ke.value.trim();o?(localStorage.setItem(In,o),jt(o),ke.value="",ke.placeholder="API key saved",pe.textContent="✅ Key saved and is now active.",pe.classList.remove("text-warning-text","font-semibold")):(localStorage.removeItem(In),jt(null),pe.textContent="User-defined key removed. Falling back to built-in key if available."),st()})}function Dp(){ki.addEventListener("click",()=>{const o={version:"1.0",exportedAt:Date.now(),history:W,settings:{[Lt]:localStorage.getItem(Lt),[Vt]:localStorage.getItem(Vt),[Ft]:localStorage.getItem(Ft),[Ut]:localStorage.getItem(Ut),[Dt]:localStorage.getItem(Dt)}},e=JSON.stringify(o,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n;const s=new Date().toISOString().split("T")[0];i.download=`japanese-analyzer-backup-${s}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}),ft.addEventListener("change",()=>{var t;const o=(t=ft.files)==null?void 0:t[0];if(!o)return;const e=new FileReader;e.onload=n=>{var i;try{const s=JSON.parse((i=n.target)==null?void 0:i.result);if(!s.history||!s.settings)throw new Error("Invalid backup file structure.");sn("Importing will overwrite your current history and settings. Are you sure you want to continue?",()=>{Object.keys(s.settings).forEach(l=>{const u=s.settings[l];u!=null?localStorage.setItem(l,u):localStorage.removeItem(l)}),en(s.history),ue(),hs(),Be(),Et(),Hn("Import successful! Your data and settings have been updated.")},{confirmText:"Import",confirmClass:"bg-accent hover:bg-accent/90"})}catch(s){Hn(`Import failed: ${s instanceof Error?s.message:"Could not read file."}`)}finally{ft.value=""}},e.readAsText(o)})}function Lp(){nn.addEventListener("click",o=>{o.stopPropagation(),Ke.classList.toggle("hidden")}),document.addEventListener("click",o=>{Ke.classList.contains("hidden")||!Ke.contains(o.target)&&!nn.contains(o.target)&&Ke.classList.add("hidden")})}function Vp(){hs(),Lp(),Rp(),kp(),Np(),Pp(),bp(),Dp()}function gs(o){var i;const e=(i=o.closest(".p-4.rounded-lg"))==null?void 0:i.querySelector("#translation-content");if(!e)return;const t=e.classList.contains("hidden");e.classList.toggle("hidden"),o.setAttribute("aria-expanded",String(!t));const n=o.querySelector(".button-text");n&&(n.textContent=t?"Hide":"Show")}function Fp(){Me.addEventListener("click",async()=>{const o=me.value;if(!o.trim()){at("Input Required","main","Please enter some Japanese text to process.");return}const e=_e.value.trim()||o.substring(0,40)+"...";let t=B;if(t){const i=J(t);if(i){const s=f=>new Set(f.split(`
`).flatMap(p=>{var m;return((m=p.match(/[^。？！\s]+[。？！]?/g))==null?void 0:m.filter(h=>h==null?void 0:h.trim()))||[]})),l=s(i.text),u=s(o),d=i.analyzedSentences,c={};for(const f of u)l.has(f)&&d[f]&&(c[f]=d[f]);i.title=e,i.text=o,i.analyzedSentences=c,i.updatedAt=Date.now(),i.readingProgress=0,vt(i)}else t=null}if(!t){const i=Date.now().toString(),s={id:i,title:e,text:o,createdAt:Date.now(),updatedAt:Date.now(),analyzedSentences:{},readingProgress:0};vt(s),An(i)}ue(),Be(),localStorage.setItem(Pt,e),localStorage.setItem(bt,o);const n=J(B);Ot(n),be.classList.add("hidden"),G.innerHTML='<p class="text-center p-8 text-text-muted">Select a sentence to analyze, or start reading mode.</p>'})}function Up(){ce.addEventListener("click",async o=>{var l,u;if(!U.classList.contains("hidden"))return;const e=o.target;if(e.closest("#re-analyze-button")){const d=Y.querySelector(".clickable-sentence.selected"),c=d==null?void 0:d.dataset.sentence;if(!c||!B)return;const f=J(B);f.analyzedSentences[c]&&delete f.analyzedSentences[c][ee],d.click();return}const n=e.closest("#toggle-translation-button");if(n){gs(n);return}if(e.closest("#start-reading-button")){if(B){const d=J(B);d&&await et(d,d.readingProgress)}return}if(e.closest("#edit-text-button")){be.classList.remove("hidden"),Y.innerHTML="",G.innerHTML="",be.scrollIntoView({behavior:"smooth",block:"start"});return}const i=e.closest(".clickable-sentence");if(i&&Y.contains(i)){const d=i.dataset.sentence;if(!d||!B)return;const c=J(B);if(c){const h=c.text.split(`
`).flatMap(g=>{var y;return((y=g.match(/[^。？！\s]+[。？！]?/g))==null?void 0:y.filter(C=>C==null?void 0:C.trim()))||[]}).indexOf(d);h!==-1&&(tn(c.id,h),ue())}Fe(),Y.querySelectorAll(".clickable-sentence").forEach(m=>m.classList.remove("selected","bg-accent-selected-bg/60","dark:bg-accent-selected-bg/30","font-semibold")),i.classList.add("selected","bg-accent-selected-bg/60","dark:bg-accent-selected-bg/30","font-semibold");const f=J(B),p=(l=f.analyzedSentences[d])==null?void 0:l[ee];if(p)Ue(G,p),_i(),G.scrollIntoView({behavior:"smooth",block:"start"});else{Ui(G,d),G.scrollIntoView({behavior:"smooth",block:"start"});try{const m=await zt(f,d,ee),h=G;h.style.transition="opacity 0.2s ease-in-out",h.style.opacity="0",await new Promise(g=>setTimeout(g,200)),Ue(G,m),_i(),Ot(f),(u=Y.querySelector(`.clickable-sentence[data-sentence="${CSS.escape(d)}"]`))==null||u.classList.add("selected","bg-accent-selected-bg/60","dark:bg-accent-selected-bg/30","font-semibold"),h.style.opacity="1",setTimeout(()=>{h.style.transition=""},250)}catch(m){const h=m instanceof Error?m:new Error(String(m)),{main:g,detail:y}=Pn(h);at(g,"analysis",y),G.scrollIntoView({behavior:"smooth",block:"start"})}}X();return}if(e.closest("a.underline")){o.stopPropagation();return}const s=e.closest(".segment");if(s&&G.contains(s)){if(o.stopPropagation(),G.querySelector(".is-focused"))return;ws(s)?Fe():As(s)}})}function Bp(){ce.addEventListener("click",o=>{if(U.classList.contains("hidden"))return;const e=o.target;if(e.closest("#re-analyze-button")){if(!B)return;const u=J(B);if(!u)return;const d=u.readingProgress,f=u.text.split(`
`).flatMap(p=>{var m;return((m=p.match(/[^。？！\s]+[。？！]?/g))==null?void 0:m.filter(h=>h==null?void 0:h.trim()))||[]})[d];u.analyzedSentences[f]&&delete u.analyzedSentences[f][ee],ue(),et(u,d);return}const n=e.closest("#toggle-translation-button");if(n){gs(n);return}const i=B;if(!i)return;const s=J(i);if(!s)return;let l=s.readingProgress;if(e.closest("#reading-mode-exit")){Fn(i);return}if(e.closest("#reading-nav-next"))l++;else if(e.closest("#reading-nav-prev"))l--;else return;tn(i,l),ue(),et(s,l)}),ce.addEventListener("change",o=>{if(U.classList.contains("hidden"))return;const e=o.target;if(e.id!=="reading-mode-sentence-input")return;const t=B;if(!t)return;const n=J(t);if(!n)return;const s=n.text.split(`
`).flatMap(u=>{var d;return((d=u.match(/[^。？！\s]+[。？！]?/g))==null?void 0:d.filter(c=>c==null?void 0:c.trim()))||[]}).length;let l=parseInt(e.value,10)-1;if(isNaN(l)||l<0||l>=s){e.value=String(n.readingProgress+1);return}l!==n.readingProgress&&(tn(t,l),ue(),et(n,l))})}function Gp(){ce.addEventListener("click",o=>{const e=o.target.closest("[data-pattern-id]");if(!e)return;const t=e.closest("#analysis-view, #reading-mode-view");if(!t)return;const{patternId:n}=e.dataset;if(!n)return;const i=e.classList.contains("is-focused");t.querySelectorAll("[data-pattern-id]").forEach(s=>s.classList.remove("is-focused","ring-2","ring-focus-ring","bg-surface-soft")),t.querySelectorAll(".segment").forEach(s=>s.classList.remove("opacity-30")),i||(e.classList.add("is-focused","ring-2","ring-focus-ring","bg-surface-soft"),t.querySelectorAll(`.segment:not(.${n})`).forEach(l=>l.classList.add("opacity-30")))})}function Op(){ce.addEventListener("click",async o=>{const e=o.target.closest(".show-examples-button");if(!e||e.disabled)return;if(o.preventDefault(),!Pe){at("API Key Not Found","analysis","Please add your Gemini API key in the settings menu to generate examples.");return}const{patternName:t}=e.dataset,n=e.querySelector(".button-text");if(!n)return;const i=e.nextElementSibling;if(i&&i.classList.contains("examples-container")){i.classList.toggle("hidden"),n.textContent=i.classList.contains("hidden")?"Examples":"Hide";return}e.disabled=!0;const s=e.innerHTML;e.innerHTML='<span class="animate-spin rounded-full h-4 w-4 border-b-2 border-current"></span><span class="button-text">Loading...</span>';try{const l=await Sp(Pe,t);e.innerHTML=s;const u=e.querySelector(".button-text");if((l==null?void 0:l.length)>0){const d=document.createElement("div");d.className="examples-container mt-4 pt-4 border-t border-dashed border-border-subtle";const c=document.createElement("dl");c.className="flex flex-col gap-4",l.forEach(f=>{const p=document.createElement("dt"),m=document.createElement("dd"),h=Vi(f.japanese,f.reading,!1);p.innerHTML=`<span class="text-lg font-jp">${h}</span>`,m.className="text-sm text-text-muted -mt-1",m.textContent=f.english,c.append(p,m)}),d.appendChild(c),e.insertAdjacentElement("afterend",d),u.textContent="Hide"}else u.textContent="No examples"}catch(l){console.error(l),e.innerHTML=s,e.querySelector(".button-text").textContent="Error"}finally{e.disabled=!1,X()}})}function qp(){Ai.addEventListener("click",()=>{localStorage.removeItem(Pt),localStorage.removeItem(bt),Et()})}function Hp(){_e.value=localStorage.getItem(Pt)||"",me.value=localStorage.getItem(bt)||"",_e.addEventListener("input",()=>{localStorage.setItem(Pt,_e.value)}),me.addEventListener("input",()=>{localStorage.setItem(bt,me.value),st()})}function $p(){document.addEventListener("keydown",o=>{var l,u,d;const e=o.target;if(["INPUT","TEXTAREA"].includes(e.tagName)||e.isContentEditable)return;o.key.toLowerCase()==="f"&&(o.preventDefault(),De.click()),o.key.toLowerCase()==="c"&&(o.preventDefault(),Le.click());const t=!U.classList.contains("hidden"),n=t?U:G.innerHTML.trim()?G:null;if(t&&(o.key==="ArrowRight"?(o.preventDefault(),(l=document.getElementById("reading-nav-next"))==null||l.click()):o.key==="ArrowLeft"&&(o.preventDefault(),(u=document.getElementById("reading-nav-prev"))==null||u.click())),!n)return;if(o.key.toLowerCase()==="t"){const c=n.querySelector("#toggle-translation-button");if(c){o.preventDefault(),c.click();const f=(d=c.closest(".p-4.rounded-lg"))==null?void 0:d.querySelector("#translation-content");f&&!f.classList.contains("hidden")&&f.scrollIntoView({behavior:"smooth",block:"center"})}}if(o.key.toLowerCase()==="s"){const c=n.querySelector(".tts-button");c&&(o.preventDefault(),c.click())}const i=n.querySelector(".is-focused");o.key==="Escape"&&i&&(o.preventDefault(),i.classList.remove("is-focused","ring-2","ring-focus-ring","bg-surface-soft"),n.querySelectorAll(".segment").forEach(c=>c.classList.remove("opacity-30")));const s=Array.from(n.querySelectorAll("[data-pattern-id]"));if(s.length>0){const c=s.findIndex(f=>f.classList.contains("is-focused"));if(o.key.toLowerCase()==="j"||o.key.toLowerCase()==="k"){o.preventDefault();let f=c===-1?0:o.key==="j"?c+1:c-1;f>=s.length&&(f=0),f<0&&(f=s.length-1);const p=s[f];if(!p)return;p.click();const m=n.querySelector(".sticky"),h=m?m.getBoundingClientRect().bottom:0,g=p.getBoundingClientRect(),C=window.innerHeight-h;let x;g.height>C?x=h+20:x=h+C/2-g.height/2;const I=g.top-x;window.scrollBy({top:I,left:0,behavior:"smooth"})}if(o.key.toLowerCase()==="e"&&i){o.preventDefault();const f=i.querySelector(".show-examples-button");f==null||f.click()}}})}function Jp(){Hp(),Fp(),Up(),Bp(),Gp(),Op(),qp(),$p()}const ys="japanese-analyzer-history-v2",Pt="japanese-analyzer-unsaved-title",bt="japanese-analyzer-unsaved-text",Dt="japanese-analyzer-analysis-depth",In="japanese-analyzer-api-key",Lt="theme",Vt="furigana-hidden",Ft="color-coding-hidden",Ut="pitch-accent-hidden",vs="japanese-analyzer-font-size";function zp(){Vp(),wp(),Jp(),xs(),Ms(),ks(),X()}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/zp();

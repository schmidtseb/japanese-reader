import{r as h,j as n,R as _e,u as Oe,a as ke,b as Me,V as Le}from"./index.prod-Dcqqmj7B.js";import{F as Y,T as De,P as Ke}from"./PitchAccentVisualizer-CYmosM0i.js";const Ue=[0,4,8,24,48,168,336,720,2880],Pe=1,ze=.5,He=2.5,Fe=.15,$e=.15,Ge=.2;function G(e,t){const s={...e};let a=e.srsStage,r=e.intervalModifier??Pe;if(t===1){s.incorrectAnswerCount=(e.incorrectAnswerCount||0)+1;const i=Math.ceil(s.incorrectAnswerCount/2),o=e.srsStage>=5?2:1,c=i*o;a=Math.max(1,e.srsStage-c),r-=Ge}else s.incorrectAnswerCount=0,t===2?r-=$e:(t===3||(r+=Fe),a=e.srsStage+1);if(s.intervalModifier=Math.max(ze,Math.min(r,He)),a>=9)s.srsStage=9,s.nextReviewDate=new Date("9999-12-31").getTime();else{s.srsStage=a;const o=Ue[s.srsStage]*s.intervalModifier,c=new Date;s.nextReviewDate=new Date(c.getTime()+o*60*60*1e3).getTime()}return s}function O(e){return e===null?"null":e!==Object(e)?typeof e:{}.toString.call(e).slice(8,-1).toLowerCase()}function k(e){return O(e)!=="string"?!0:!e.length}function Q(e="",t,s){if(k(e))return!1;const a=e.charCodeAt(0);return t<=a&&a<=s}const ne={HIRAGANA:"toHiragana",KATAKANA:"toKatakana"},de={HEPBURN:"hepburn"},Ve={useObsoleteKana:!1,passRomaji:!1,convertLongVowelMark:!0,upcaseKatakana:!1,IMEMode:!1,romanization:de.HEPBURN},We=65,Be=90,Je=65345,Ye=65370,Qe=65313,qe=65338,xe=12353,Ze=12438,Xe=12449,et=12540,tt=12539,nt=[65296,65305],st=[Qe,qe],rt=[Je,Ye],at=[65281,65295],it=[65306,65311],ot=[65339,65343],ct=[65371,65376],lt=[65504,65518],ut=[12352,12447],dt=[12448,12543],xt=[65382,65439],ft=[12539,12540],fe=[65377,65381],mt=[12288,12351],ht=[19968,40959],pt=[13312,19903],gt=[ut,dt,fe,xt],bt=[mt,fe,ft,at,it,ot,ct,lt],jt=[...gt,...bt,st,rt,nt,ht,pt];function Nt(e=""){return jt.some(([t,s])=>Q(e,t,s))}function F(e="",t){const s=O(t)==="regexp";return k(e)?!1:[...e].every(a=>{const r=Nt(a);return s?r||t.test(a):r})}var se=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function wt(e,t){return!!(e===t||se(e)&&se(t))}function vt(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(!wt(e[s],t[s]))return!1;return!0}function me(e,t){t===void 0&&(t=vt);var s=null;function a(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(s&&s.lastThis===this&&t(r,s.lastArgs))return s.lastResult;var o=e.apply(this,r);return s={lastResult:o,lastArgs:r,lastThis:this},o}return a.clear=function(){s=null},a}var re=Object.prototype.hasOwnProperty;function ae(e,t,s){for(s of e.keys())if(_(s,t))return s}function _(e,t){var s,a,r;if(e===t)return!0;if(e&&t&&(s=e.constructor)===t.constructor){if(s===Date)return e.getTime()===t.getTime();if(s===RegExp)return e.toString()===t.toString();if(s===Array){if((a=e.length)===t.length)for(;a--&&_(e[a],t[a]););return a===-1}if(s===Set){if(e.size!==t.size)return!1;for(a of e)if(r=a,r&&typeof r=="object"&&(r=ae(t,r),!r)||!t.has(r))return!1;return!0}if(s===Map){if(e.size!==t.size)return!1;for(a of e)if(r=a[0],r&&typeof r=="object"&&(r=ae(t,r),!r)||!_(a[1],t.get(r)))return!1;return!0}if(s===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(s===DataView){if((a=e.byteLength)===t.byteLength)for(;a--&&e.getInt8(a)===t.getInt8(a););return a===-1}if(ArrayBuffer.isView(e)){if((a=e.byteLength)===t.byteLength)for(;a--&&e[a]===t[a];);return a===-1}if(!s||typeof e=="object"){a=0;for(s in e)if(re.call(e,s)&&++a&&!re.call(t,s)||!(s in t)||!_(e[s],t[s]))return!1;return Object.keys(t).length===a}}return e!==e&&t!==t}const he=(e={})=>Object.assign({},Ve,e);function yt(e,t,s){const a=t;function r(c,l){if(c[l]!==void 0)return Object.assign({"":c[""]+l},c[l])}function i(c,l){const u=c.charAt(0);return o(Object.assign({"":u},a[u]),c.slice(1),l,l+1)}function o(c,l,u,d){if(!l)return s||Object.keys(c).length===1?c[""]?[[u,d,c[""]]]:[]:[[u,d,null]];if(Object.keys(c).length===1)return[[u,d,c[""]]].concat(i(l,d));const x=r(c,l.charAt(0));return x===void 0?[[u,d,c[""]]].concat(i(l,d)):o(x,l.slice(1),u,d+1)}return i(e,0)}function q(e){return Object.entries(e).reduce((t,[s,a])=>{const r=O(a)==="string";return t[s]=r?{"":a}:q(a),t},{})}function pe(e,t){return t.split("").reduce((s,a)=>(s[a]===void 0&&(s[a]={}),s[a]),e)}function ge(e={}){const t={};return O(e)==="object"&&Object.entries(e).forEach(([s,a])=>{let r=t;s.split("").forEach(i=>{r[i]===void 0&&(r[i]={}),r=r[i]}),r[""]=a}),function(a){const r=JSON.parse(JSON.stringify(a));function i(o,c){return o===void 0||O(o)==="string"?c:Object.entries(c).reduce((l,[u,d])=>(l[u]=i(o[u],d),l),o)}return i(r,t)}}function be(e,t){return t?O(t)==="function"?t(e):ge(t)(e):e}const Et={a:"あ",i:"い",u:"う",e:"え",o:"お",k:{a:"か",i:"き",u:"く",e:"け",o:"こ"},s:{a:"さ",i:"し",u:"す",e:"せ",o:"そ"},t:{a:"た",i:"ち",u:"つ",e:"て",o:"と"},n:{a:"な",i:"に",u:"ぬ",e:"ね",o:"の"},h:{a:"は",i:"ひ",u:"ふ",e:"へ",o:"ほ"},m:{a:"ま",i:"み",u:"む",e:"め",o:"も"},y:{a:"や",u:"ゆ",o:"よ"},r:{a:"ら",i:"り",u:"る",e:"れ",o:"ろ"},w:{a:"わ",i:"ゐ",e:"ゑ",o:"を"},g:{a:"が",i:"ぎ",u:"ぐ",e:"げ",o:"ご"},z:{a:"ざ",i:"じ",u:"ず",e:"ぜ",o:"ぞ"},d:{a:"だ",i:"ぢ",u:"づ",e:"で",o:"ど"},b:{a:"ば",i:"び",u:"ぶ",e:"べ",o:"ぼ"},p:{a:"ぱ",i:"ぴ",u:"ぷ",e:"ぺ",o:"ぽ"},v:{a:"ゔぁ",i:"ゔぃ",u:"ゔ",e:"ゔぇ",o:"ゔぉ"}},At={".":"。",",":"、",":":"：","/":"・","!":"！","?":"？","~":"〜","-":"ー","‘":"「","’":"」","“":"『","”":"』","[":"［","]":"］","(":"（",")":"）","{":"｛","}":"｝"},ie={k:"き",s:"し",t:"ち",n:"に",h:"ひ",m:"み",r:"り",g:"ぎ",z:"じ",d:"ぢ",b:"び",p:"ぴ",v:"ゔ",q:"く",f:"ふ"},je={ya:"ゃ",yi:"ぃ",yu:"ゅ",ye:"ぇ",yo:"ょ"},Ne={a:"ぁ",i:"ぃ",u:"ぅ",e:"ぇ",o:"ぉ"},oe={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},St=Object.assign({tu:"っ",wa:"ゎ",ka:"ヵ",ke:"ヶ"},Ne,je),Ct={yi:"い",wu:"う",ye:"いぇ",wi:"うぃ",we:"うぇ",kwa:"くぁ",whu:"う",tha:"てゃ",thu:"てゅ",tho:"てょ",dha:"でゃ",dhu:"でゅ",dho:"でょ"},It={wh:"う",kw:"く",qw:"く",q:"く",gw:"ぐ",sw:"す",ts:"つ",th:"て",tw:"と",dh:"で",dw:"ど",fw:"ふ",f:"ふ"};function Tt(){const e=q(Et),t=r=>pe(e,r);Object.entries(ie).forEach(([r,i])=>{Object.entries(je).forEach(([o,c])=>{t(r+o)[""]=i+c})}),Object.entries(At).forEach(([r,i])=>{t(r)[""]=i}),Object.entries(It).forEach(([r,i])=>{Object.entries(Ne).forEach(([o,c])=>{const l=t(r+o);l[""]=i+c})}),["n","n'","xn"].forEach(r=>{t(r)[""]="ん"}),e.c=JSON.parse(JSON.stringify(e.k)),Object.entries(oe).forEach(([r,i])=>{const o=r.slice(0,r.length-1),c=r.charAt(r.length-1),l=t(o);l[c]=JSON.parse(JSON.stringify(t(i)))});function s(r){return[...Object.entries(oe),["c","k"]].reduce((i,[o,c])=>r.startsWith(c)?i.concat(r.replace(c,o)):i,[])}Object.entries(St).forEach(([r,i])=>{const o=x=>x.charAt(x.length-1),c=x=>x.slice(0,x.length-1),l=`x${r}`,u=t(l);u[""]=i;const d=t(`l${c(r)}`);d[o(r)]=u,s(r).forEach(x=>{["l","x"].forEach(w=>{const M=t(w+c(x));M[o(x)]=t(w+r)})})}),Object.entries(Ct).forEach(([r,i])=>{t(r)[""]=i});function a(r){return Object.entries(r).reduce((i,[o,c])=>(o?i[o]=a(c):i[o]=`っ${c}`,i),{})}return[...Object.keys(ie),"c","y","w","j"].forEach(r=>{const i=e[r];i[r]=a(i)}),delete e.n.n,Object.freeze(JSON.parse(JSON.stringify(e)))}let V=null;function Rt(){return V==null&&(V=Tt()),V}const _t=ge({wi:"ゐ",we:"ゑ"});function Ot(e){const t=JSON.parse(JSON.stringify(e));return t.n.n={"":"ん"},t.n[" "]={"":"ん"},t}function kt(e=""){return k(e)?!1:Q(e,We,Be)}function we(e=""){return k(e)?!1:e.charCodeAt(0)===et}function Mt(e=""){return k(e)?!1:e.charCodeAt(0)===tt}function Lt(e=""){return k(e)?!1:we(e)?!0:Q(e,xe,Ze)}function Dt(e=""){const t=[];return e.split("").forEach(s=>{if(we(s)||Mt(s))t.push(s);else if(Lt(s)){const a=s.charCodeAt(0)+(Xe-xe),r=String.fromCharCode(a);t.push(r)}else t.push(s)}),t.join("")}const Z=me((e,t,s)=>{let a=Rt();return a=e?Ot(a):a,a=t?_t(a):a,s&&(a=be(a,s)),a},_);function Kt(e="",t={},s){let a;return s?a=t:(a=he(t),s=Z(a.IMEMode,a.useObsoleteKana,a.customKanaMapping)),Ut(e,a,s).map(r=>{const[i,o,c]=r;if(c===null)return e.slice(i);const l=a.IMEMode===ne.HIRAGANA,u=a.IMEMode===ne.KATAKANA||[...e.slice(i,o)].every(kt);return l||!u?c:Dt(c)}).join("")}function Ut(e="",t={},s){const{IMEMode:a,useObsoleteKana:r,customKanaMapping:i}=t;return s||(s=Z(a,r,i)),yt(e.toLowerCase(),s,!a)}let K=[];function Pt(e){let t;const s=Object.assign({},he(e),{IMEMode:e.IMEMode||!0}),a=Z(s.IMEMode,s.useObsoleteKana,s.customKanaMapping),r=[...Object.keys(a),...Object.keys(a).map(i=>i.toUpperCase())];return function({target:o}){o.value!==t&&o.dataset.ignoreComposition!=="true"&&zt(o,s,a,r)}}function zt(e,t,s,a,r){const[i,o,c]=Gt(e.value,e.selectionEnd,a),l=Kt(o,t,s);if(o!==l){const d=i.length+l.length,x=i+l+c;e.value=x,c.length?setTimeout(()=>e.setSelectionRange(d,d),1):e.setSelectionRange(d,d)}else e.value}function W({type:e,target:t,data:s}){/Mac/.test(window.navigator&&window.navigator.platform)&&(e==="compositionupdate"&&F(s)&&(t.dataset.ignoreComposition="true"),e==="compositionend"&&(t.dataset.ignoreComposition="false"))}function Ht(e,t,s){K=K.concat({id:e,inputHandler:t,compositionHandler:s})}function Ft({id:e}){K=K.filter(({id:t})=>t!==e)}function $t(e){return e&&K.find(({id:t})=>t===e.getAttribute("data-wanakana-id"))}function Gt(e="",t=0,s=[]){let a,r,i;return t===0&&s.includes(e[0])?[a,r,i]=Vt(e,s):t>0?[a,r,i]=Wt(e,t):([a,r]=H(e,o=>!s.includes(o)),[r,i]=H(r,o=>!F(o))),[a,r,i]}function Vt(e,t){return["",...H(e,s=>t.includes(s)||!F(s,/[0-9]/))]}function Wt(e="",t=0){const[s,a]=H([...e.slice(0,t)].reverse(),r=>!F(r));return[a.reverse().join(""),s.split("").reverse().join(""),e.slice(t)]}function H(e={},t=s=>!!s){const s=[],{length:a}=e;let r=0;for(;r<a&&t(e[r],r);)s.push(e[r]),r+=1;return[s.join(""),e.slice(r)]}const Bt=({target:{value:e,selectionStart:t,selectionEnd:s}})=>console.log("input:",{value:e,selectionStart:t,selectionEnd:s}),Jt=()=>console.log("compositionstart"),Yt=({target:{value:e,selectionStart:t,selectionEnd:s},data:a})=>console.log("compositionupdate",{data:a,value:e,selectionStart:t,selectionEnd:s}),Qt=()=>console.log("compositionend"),ve={input:Bt,compositionstart:Jt,compositionupdate:Yt,compositionend:Qt},qt=e=>{Object.entries(ve).forEach(([t,s])=>e.addEventListener(t,s))},Zt=e=>{Object.entries(ve).forEach(([t,s])=>e.removeEventListener(t,s))},Xt=["TEXTAREA","INPUT"];let ce=0;const en=()=>(ce+=1,`${Date.now()}${ce}`);function tn(e={},t={},s=!1){if(!Xt.includes(e.nodeName))throw new Error(`Element provided to Wanakana bind() was not a valid input or textarea element.
 Received: (${JSON.stringify(e)})`);if(e.hasAttribute("data-wanakana-id"))return;const a=Pt(t),r=en(),i=[{name:"data-wanakana-id",value:r},{name:"lang",value:"ja"},{name:"autoCapitalize",value:"none"},{name:"autoCorrect",value:"off"},{name:"autoComplete",value:"off"},{name:"spellCheck",value:"false"}],o={};i.forEach(c=>{o[c.name]=e.getAttribute(c.name),e.setAttribute(c.name,c.value)}),e.dataset.previousAttributes=JSON.stringify(o),e.addEventListener("input",a),e.addEventListener("compositionupdate",W),e.addEventListener("compositionend",W),Ht(r,a,W),s===!0&&qt(e)}function nn(e,t=!1){const s=$t(e);if(s==null)throw new Error(`Element provided to Wanakana unbind() had no listener registered.
 Received: ${JSON.stringify(e)}`);const{inputHandler:a,compositionHandler:r}=s,i=JSON.parse(e.dataset.previousAttributes);Object.keys(i).forEach(o=>{i[o]?e.setAttribute(o,i[o]):e.removeAttribute(o)}),e.removeAttribute("data-previous-attributes"),e.removeAttribute("data-ignore-composition"),e.removeEventListener("input",a),e.removeEventListener("compositionstart",r),e.removeEventListener("compositionupdate",r),e.removeEventListener("compositionend",r),Ft(s),t===!0&&Zt(e)}let B=null;const sn={あ:"a",い:"i",う:"u",え:"e",お:"o",か:"ka",き:"ki",く:"ku",け:"ke",こ:"ko",さ:"sa",し:"shi",す:"su",せ:"se",そ:"so",た:"ta",ち:"chi",つ:"tsu",て:"te",と:"to",な:"na",に:"ni",ぬ:"nu",ね:"ne",の:"no",は:"ha",ひ:"hi",ふ:"fu",へ:"he",ほ:"ho",ま:"ma",み:"mi",む:"mu",め:"me",も:"mo",ら:"ra",り:"ri",る:"ru",れ:"re",ろ:"ro",や:"ya",ゆ:"yu",よ:"yo",わ:"wa",ゐ:"wi",ゑ:"we",を:"wo",ん:"n",が:"ga",ぎ:"gi",ぐ:"gu",げ:"ge",ご:"go",ざ:"za",じ:"ji",ず:"zu",ぜ:"ze",ぞ:"zo",だ:"da",ぢ:"ji",づ:"zu",で:"de",ど:"do",ば:"ba",び:"bi",ぶ:"bu",べ:"be",ぼ:"bo",ぱ:"pa",ぴ:"pi",ぷ:"pu",ぺ:"pe",ぽ:"po",ゔぁ:"va",ゔぃ:"vi",ゔ:"vu",ゔぇ:"ve",ゔぉ:"vo"},rn={"。":".","、":",","：":":","・":"/","！":"!","？":"?","〜":"~",ー:"-","「":"‘","」":"’","『":"“","』":"”","［":"[","］":"]","（":"(","）":")","｛":"{","｝":"}","　":" "},an=["あ","い","う","え","お","や","ゆ","よ"],J={ゃ:"ya",ゅ:"yu",ょ:"yo"},on={ぃ:"yi",ぇ:"ye"},cn={ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},ln=["き","に","ひ","み","り","ぎ","び","ぴ","ゔ","く","ふ"],un={し:"sh",ち:"ch",じ:"j",ぢ:"j"},dn={っ:"",ゃ:"ya",ゅ:"yu",ょ:"yo",ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},le={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function xn(){return B==null&&(B=mn()),B}function fn(e){switch(e){case de.HEPBURN:return xn();default:return{}}}function mn(){const e=q(sn),t=a=>pe(e,a),s=(a,r)=>{t(a)[""]=r};return Object.entries(rn).forEach(([a,r])=>{t(a)[""]=r}),[...Object.entries(J),...Object.entries(cn)].forEach(([a,r])=>{s(a,r)}),ln.forEach(a=>{const r=t(a)[""][0];Object.entries(J).forEach(([i,o])=>{s(a+i,r+o)}),Object.entries(on).forEach(([i,o])=>{s(a+i,r+o)})}),Object.entries(un).forEach(([a,r])=>{Object.entries(J).forEach(([i,o])=>{s(a+i,r+o[1])}),s(`${a}ぃ`,`${r}yi`),s(`${a}ぇ`,`${r}e`)}),e.っ=ye(e),Object.entries(dn).forEach(([a,r])=>{s(a,r)}),an.forEach(a=>{s(`ん${a}`,`n'${t(a)[""]}`)}),Object.freeze(JSON.parse(JSON.stringify(e)))}function ye(e){return Object.entries(e).reduce((t,[s,a])=>{if(s)t[s]=ye(a);else{const r=a.charAt(0);t[s]=Object.keys(le).includes(r)?le[r]+a:a}return t},{})}me((e,t)=>{let s=fn(e);return t&&(s=be(s,t)),s},_);function hn(e,t){const s=e?e.length:0,a=t?t.length:0;if(s===0)return a;if(a===0)return s;const r=Array.from({length:s+1},()=>Array(a+1).fill(0));for(let i=0;i<=s;i++)r[i][0]=i;for(let i=0;i<=a;i++)r[0][i]=i;for(let i=1;i<=s;i++)for(let o=1;o<=a;o++){const c=e[i-1]===t[o-1]?0:1;r[i][o]=Math.min(r[i-1][o]+1,r[i][o-1]+1,r[i-1][o-1]+c)}return r[s][a]}function pn(e,t){const s=e.trim().toLowerCase(),a=t.trim().toLowerCase();if(s===a)return!0;const r=a.split("/").map(i=>i.trim());return r.some(i=>s===i)?!0:r.some(i=>{const o=hn(s,i),c=Math.max(s.length,i.length);return c<=4?o<=1:c<=10?o<=2:o<=Math.floor(c*.2)})}const gn={"jp-en":{questionLabel:"Translate to English",answerPlaceholder:"Meaning",inputLang:"en",inputMode:"text",colorClass:"border-review-jp-en"},"kanji-read":{questionLabel:"What is the reading?",answerPlaceholder:"ひらがな",inputLang:"ja",inputMode:"text",colorClass:"border-review-kanji-read"}},Ee=({item:e,quizType:t,onComplete:s})=>{const[a,r]=h.useState(""),[i,o]=h.useState(!1),[c,l]=h.useState(!1),u=h.useRef(null),d=h.useRef(null);h.useEffect(()=>{const g=u.current;if(g&&(g.focus(),t==="kanji-read"))return tn(g,{IMEMode:"toHiragana"}),()=>{nn(g)}},[t]),h.useEffect(()=>{var g;i&&((g=d.current)==null||g.focus())},[i]);const{content:x}=e,{questionLabel:w,answerPlaceholder:M,inputLang:T,colorClass:A}=gn[t],U=h.useMemo(()=>n.jsx("span",{className:"font-japanese",children:x.japanese_segment}),[x]),L=()=>{var C;const g=((C=u.current)==null?void 0:C.value)||"";if(!g.trim())return;r(g);let E=!1;switch(t){case"jp-en":E=pn(g,x.english_equivalent);break;case"kanji-read":E=x.reading.split("/").map(y=>y.trim()).includes(g.trim());break}l(E),o(!0)},S=g=>{g.key==="Enter"&&(g.preventDefault(),i?s(c):setTimeout(L,0))},P=g=>{g.key==="Enter"&&(g.preventDefault(),s(c))},z=c?"bg-accent-subtle-bg":"bg-destructive-subtle-bg",R=c?"border-accent":"border-destructive",D=c?"text-accent-text":"text-destructive-subtle-text";return n.jsxs("div",{className:`relative w-full flex flex-col justify-center items-center p-6 bg-surface-soft rounded-2xl shadow-lg border-t-4 ${A}`,children:[n.jsx("div",{className:"absolute top-3 left-3 text-xs font-bold uppercase tracking-wider opacity-60",style:{color:`var(--color-review-${t}-rgb)`},children:w}),n.jsx("div",{className:"text-5xl md:text-7xl font-semibold text-center text-text-primary p-4 mb-4",children:U}),i?n.jsxs("div",{className:`w-full text-center p-4 rounded-lg border-2 animate-fade-in ${z} ${R}`,children:[n.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[c?n.jsx("i",{className:"bi bi-check-circle-fill text-2xl text-accent-text"}):n.jsx("i",{className:"bi bi-x-circle-fill text-2xl text-destructive-subtle-text"}),n.jsx("p",{className:`text-xl font-bold ${D}`,children:c?"Correct!":"Incorrect"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"text-2xl font-japanese font-semibold",children:[n.jsx(Y,{base:x.japanese_segment,reading:x.reading}),n.jsx(De,{text:x.japanese_segment})]}),n.jsx("p",{className:"text-text-secondary text-lg",children:x.english_equivalent})]}),!c&&n.jsxs("p",{className:"mt-2",children:["Your answer: ",n.jsx("span",{className:"font-semibold",children:a})]}),n.jsx("button",{ref:d,onKeyDown:P,onClick:()=>s(c),className:"mt-6 w-full btn-primary text-lg",children:"Continue"})]}):n.jsxs("div",{className:"w-full max-w-sm flex flex-col items-center gap-4",children:[n.jsx("input",{ref:u,type:"text",lang:T,value:a,onChange:g=>r(g.target.value),onKeyDown:S,placeholder:M,className:"w-full text-center text-xl p-3 rounded-lg border-2 border-border bg-surface focus:border-primary focus:ring-primary transition",autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:"false"}),n.jsx("button",{onClick:L,className:"btn-secondary px-8 py-2 text-base",children:"Check"})]})]})},bn=({onExit:e})=>n.jsx("div",{className:"w-full flex justify-end mb-4",children:n.jsx("button",{"data-action":"review-exit",onClick:e,title:"Exit Review Session",className:"btn-ghost",children:n.jsx("i",{className:"bi bi-x-lg text-2xl"})})}),jn=({item:e,onReview:t,cardKey:s})=>{const{content:a}=e,[r,i]=h.useState(!1);h.useEffect(()=>{i(!1)},[e,s]);const{original_sentence:o,constituent_text:c,pattern_name:l,explanation:u}=a,d=o&&c?o.replace(c,`<span class="bg-accent-subtle-bg text-accent-text px-2 py-1 rounded">${c}</span>`):l,x=n.jsx("div",{className:"text-2xl md:text-3xl font-japanese font-medium text-center text-text-primary p-8 leading-relaxed",dangerouslySetInnerHTML:{__html:d}}),w=n.jsxs("div",{className:"text-center space-y-6",children:[n.jsx("div",{className:"text-xl md:text-2xl font-japanese font-medium text-text-primary leading-relaxed p-4 bg-surface rounded-xl border border-border-subtle",dangerouslySetInnerHTML:{__html:d}}),n.jsxs("div",{children:[n.jsx("div",{className:"text-3xl font-japanese font-semibold mb-2 text-accent",children:l}),n.jsx("p",{className:"text-lg text-text-secondary",children:u})]})]});return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"relative w-full min-h-[20rem] flex flex-col justify-center items-center p-6 bg-surface-soft rounded-2xl shadow-lg",children:r?w:x}),r?n.jsx("div",{className:"mt-8 w-full",children:n.jsxs("div",{children:[n.jsx("p",{className:"text-center text-text-muted mb-4 text-sm",children:"How well did you remember?"}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4",children:[n.jsxs("button",{onClick:()=>t(1),"data-action":"review-quality-1",className:"text-lg font-bold py-4 px-4 rounded-xl bg-destructive-subtle-bg text-destructive-subtle-text hover:bg-destructive-subtle-bg/80 focus-ring transition",children:["Again ",n.jsx("span",{className:"text-xs font-normal",children:"(1)"})]}),n.jsxs("button",{onClick:()=>t(2),"data-action":"review-quality-2",className:"text-lg font-bold py-4 px-4 rounded-xl bg-pos-auxiliary-bg text-pos-auxiliary-text hover:opacity-80 focus-ring transition",children:["Hard ",n.jsx("span",{className:"text-xs font-normal",children:"(2)"})]}),n.jsxs("button",{onClick:()=>t(3),"data-action":"review-quality-3",className:"text-lg font-bold py-4 px-4 rounded-xl bg-surface-hover text-text-secondary hover:bg-surface-hover/80 focus-ring transition",children:["Good ",n.jsx("span",{className:"text-xs font-normal",children:"(3)"})]}),n.jsxs("button",{onClick:()=>t(4),"data-action":"review-quality-4",className:"text-lg font-bold py-4 px-4 rounded-xl bg-accent-subtle-bg text-accent-text hover:bg-accent-subtle-bg/80 focus-ring transition",children:["Easy ",n.jsx("span",{className:"text-xs font-normal",children:"(4)"})]})]})]})}):n.jsx("div",{className:"mt-8 w-full flex items-center",children:n.jsxs("button",{onClick:()=>i(!0),"data-action":"review-show-answer",className:"w-full max-w-xs mx-auto btn-primary text-lg",children:["Show Answer ",n.jsx("span",{className:"text-sm font-normal text-primary-text/80 ml-2",children:"(Space)"})]})})]})},Nn=({item:e,quizType:t,onReview:s,onExit:a,cardKey:r})=>n.jsxs("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center px-4",children:[n.jsx(bn,{onExit:a}),e.type==="word"&&t?n.jsx(Ee,{item:e,quizType:t,onComplete:i=>s(i)},r):n.jsx(jn,{item:e,onReview:i=>s(i),cardKey:r},r)]}),wn=e=>{if(e===null||!isFinite(e))return"";const t=Date.now(),s=e-t;if(s<=0)return"soon";const a=s/(1e3*60),r=a/60,i=r/24;return i>=2?`in ${Math.round(i)} days`:i>=1?"tomorrow":r>=2?`in ${Math.round(r)} hours`:r>=1?"in an hour":a>=2?`in ${Math.round(a)} minutes`:"in a minute"},vn=({learnedCount:e,reviewedCount:t,onManage:s,onExit:a,onRestart:r,hasMoreItems:i,nextReviewTimestamp:o})=>{const l=e+t>0,u=wn(o),d=i?"Round Complete!":l?"Session Complete!":"All Caught Up!",x=l?n.jsxs("div",{className:"mt-2 text-text-secondary space-y-1",children:[n.jsxs("p",{children:["Great work! You learned ",n.jsx("strong",{className:"text-primary",children:e})," new items and reviewed ",n.jsx("strong",{className:"text-accent",children:t})," items."]}),i&&n.jsx("p",{children:"There are more items ready for your next round."}),!i&&u&&n.jsxs("p",{children:["Your next review is due ",u,"."]})]}):n.jsxs("p",{className:"mt-2 text-text-secondary",children:["There are no new words or reviews due right now.",!i&&u&&` Your next review is due ${u}.`]});return n.jsxs("div",{className:"text-center py-16 px-6 max-w-lg mx-auto",children:[n.jsx("i",{className:"bi bi-check-circle text-6xl text-accent mx-auto mb-6","aria-hidden":"true"}),n.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:d}),x,n.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row items-center justify-center gap-4",children:[i?n.jsx("button",{onClick:r,className:"btn-primary",children:"Start Next Round"}):n.jsx("button",{onClick:a,className:"btn-secondary",children:"Back to Analyzer"}),n.jsx("button",{onClick:s,className:"btn-ghost",children:"Manage Deck"})]})]})},yn=({onManage:e,onExit:t})=>n.jsxs("div",{className:"text-center py-16 px-6 max-w-lg mx-auto",children:[n.jsx("i",{className:"bi bi-journal-bookmark text-6xl text-text-muted/50 mx-auto mb-6","aria-hidden":"true"}),n.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Review Deck is Empty"}),n.jsx("p",{className:"mt-2 text-text-secondary",children:'Add items by clicking the "Add to Deck" button on words or grammar patterns.'}),n.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row items-center justify-center gap-4",children:[n.jsx("button",{onClick:t,className:"btn-secondary",children:"Back to Analyzer"}),n.jsx("button",{onClick:e,className:"btn-ghost",children:"Manage Deck"})]})]}),En=({item:e,onDelete:t})=>{const[s,a]=_e.useState(!1);let r,i;if(e.type==="word"){const{japanese_segment:o,english_equivalent:c,reading:l,category:u,pitch_accent:d}=e.content;r=n.jsxs(n.Fragment,{children:[n.jsx("strong",{className:"font-japanese text-lg",children:o})," ",n.jsxs("span",{className:"text-text-muted",children:["- ",c]})]}),i=n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative inline-block text-xl font-japanese font-semibold p-2 bg-surface-subtle rounded-lg",style:{paddingTop:"22px"},children:[n.jsx(Ke,{reading:l,pitchAccent:d}),n.jsx(Y,{base:o,reading:l,interactiveKanji:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3 text-sm mt-2",children:[n.jsxs("div",{children:[n.jsx("strong",{className:"font-medium text-text-secondary block",children:"Meaning"}),n.jsx("p",{className:"text-text-primary",children:c})]}),n.jsxs("div",{children:[n.jsx("strong",{className:"font-medium text-text-secondary block",children:"Category"}),n.jsx("p",{className:"text-text-primary capitalize",children:u.replace(/_/g," ").toLowerCase()})]}),n.jsxs("div",{className:"sm:col-span-2",children:[n.jsx("strong",{className:"font-medium text-text-secondary block",children:"Reading"}),n.jsx("p",{className:"text-text-primary font-japanese",children:l})]})]})]})}else{const{pattern_name:o,constituent_text:c,explanation:l}=e.content;c?r=n.jsxs(n.Fragment,{children:[n.jsx("strong",{className:"font-japanese text-lg",children:c})," ",n.jsxs("span",{className:"text-text-muted",children:["- ",o]})]}):r=n.jsx("strong",{className:"font-japanese text-lg",children:o}),i=n.jsx("p",{className:"text-sm text-text-secondary",children:l})}return n.jsxs("li",{className:"deck-item bg-surface-soft rounded-lg shadow-sm transition-shadow hover:shadow-md",children:[n.jsxs("div",{className:"p-4 flex justify-between items-center cursor-pointer",onClick:()=>a(!s),children:[n.jsx("div",{className:"flex-grow pr-2",children:r}),n.jsxs("div",{className:"flex items-center flex-shrink-0 ml-4",children:[n.jsx("button",{onClick:o=>{o.stopPropagation(),t(e.id)},title:"Delete Item",className:"btn-ghost p-2 text-destructive/70 hover:bg-destructive-subtle-bg hover:text-destructive",children:n.jsx("i",{className:"bi bi-trash3 text-xl"})}),n.jsx("i",{className:`bi bi-chevron-down text-xl text-text-muted transition-transform ${s?"rotate-180":""}`})]})]}),s&&n.jsx("div",{className:"p-4 border-t border-border-subtle bg-surface",children:i})]})},An=({items:e,onDelete:t,onExit:s,title:a})=>n.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 md:p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-text-primary truncate pr-4",title:a,children:[a," (",e.length," items)"]}),n.jsx("button",{onClick:s,title:"Back to Analyzer",className:"btn-secondary flex-shrink-0",children:"Back"})]}),e.length===0?n.jsx("p",{className:"text-center text-text-muted p-8",children:"Your deck is empty."}):n.jsx("ul",{className:"space-y-3",children:e.map(r=>n.jsx(En,{item:r,onDelete:t},r.id))})]}),Sn=({item:e})=>{if(e.type==="word")return n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-japanese font-semibold mb-4 pb-4 border-b border-border-subtle",children:n.jsx(Y,{base:e.content.japanese_segment,reading:e.content.reading||""})}),n.jsx("div",{className:"text-lg text-text-secondary mb-6",children:e.content.english_equivalent}),n.jsxs("div",{className:"text-sm space-y-2 text-text-muted",children:[n.jsxs("p",{children:[n.jsx("strong",{className:"font-medium text-text-secondary",children:"Category:"})," ",e.content.category.replace(/_/g," ").replace(/-/g,", ")]}),n.jsxs("p",{children:[n.jsx("strong",{className:"font-medium text-text-secondary",children:"Reading:"})," ",e.content.reading]})]})]});const{original_sentence:t,constituent_text:s,pattern_name:a,explanation:r}=e.content,i=t&&s?t.replace(s,`<span class="bg-accent-subtle-bg text-accent-text px-2 py-1 rounded">${s}</span>`):a;return n.jsxs("div",{className:"text-center",children:[(t||s)&&n.jsx("div",{className:"text-xl md:text-2xl font-japanese font-medium text-center text-text-primary p-2 leading-relaxed mb-6 pb-6 border-b border-border-subtle",dangerouslySetInnerHTML:{__html:i}}),n.jsx("div",{className:"text-3xl font-japanese font-semibold mb-4 text-accent",children:a}),n.jsx("p",{className:"text-lg text-text-secondary",children:r})]})},Cn=({item:e,onExit:t,currentIndex:s,totalInChunk:a,onNext:r,onPrev:i,onStartQuiz:o})=>{const c=s===0,l=s===a-1;return n.jsxs("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center px-4",children:[n.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[n.jsxs("span",{className:"text-sm font-semibold text-text-muted px-3 py-1 bg-surface rounded-full",children:[s+1," / ",a]}),n.jsx("button",{onClick:t,title:"Exit Review Session",className:"btn-ghost",children:n.jsx("i",{className:"bi bi-x-lg text-2xl"})})]}),n.jsx("div",{className:"relative w-full min-h-[20rem] flex flex-col justify-center items-center p-6 bg-surface-soft rounded-2xl shadow-lg",children:n.jsx(Sn,{item:e})}),n.jsxs("div",{className:"mt-8 w-full flex items-center justify-center gap-4",children:[n.jsx("button",{onClick:i,disabled:c,className:"p-4 rounded-full bg-surface-hover text-text-secondary disabled:opacity-50 transition",children:n.jsx("i",{className:"bi bi-arrow-left text-2xl"})}),l?n.jsx("button",{onClick:o,className:"btn-primary text-xl px-10 py-4",children:"Start Quiz!"}):n.jsx("button",{onClick:r,className:"p-4 rounded-full bg-surface-hover text-text-secondary transition",children:n.jsx("i",{className:"bi bi-arrow-right text-2xl"})})]})]})},In=({item:e,onAnswer:t,cardKey:s})=>{const[a,r]=h.useState(!1);h.useEffect(()=>{r(!1)},[e,s]);const{content:i}=e,{original_sentence:o,constituent_text:c,pattern_name:l,explanation:u}=i,d=o&&c?o.replace(c,`<strong class="text-accent-text">${c}</strong>`):l,x=n.jsxs("div",{className:"text-xl md:text-2xl font-japanese font-medium text-center text-text-primary p-4 leading-relaxed",children:[n.jsx("p",{className:"mb-2 text-sm text-text-muted",children:"In sentence:"}),n.jsx("div",{dangerouslySetInnerHTML:{__html:d}}),n.jsxs("p",{className:"mt-6 text-base text-text-secondary",children:["What does ",n.jsx("strong",{className:"text-accent-text",children:l})," mean?"]})]}),w=n.jsxs("div",{className:"text-center space-y-4",children:[n.jsx("div",{className:"text-lg font-japanese text-text-primary p-4 leading-relaxed bg-surface rounded-md border border-border-subtle",dangerouslySetInnerHTML:{__html:d}}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-japanese font-semibold mb-2 text-accent",children:l}),n.jsx("p",{className:"text-base text-text-secondary",children:u})]})]});return n.jsxs("div",{className:"w-full flex flex-col items-center",children:[n.jsx("div",{className:"relative w-full min-h-[15rem] flex flex-col justify-center items-center p-6 bg-surface-soft rounded-2xl shadow-lg border-t-4 border-pos-conjunction-bg/50",children:a?w:x}),n.jsx("div",{className:"mt-6 w-full max-w-sm",children:a?n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx("button",{onClick:()=>t(!1),className:"text-lg font-bold py-3 px-4 rounded-xl bg-destructive-subtle-bg text-destructive-subtle-text hover:bg-destructive-subtle-bg/80 focus-ring transition",children:"Forgot"}),n.jsx("button",{onClick:()=>t(!0),className:"text-lg font-bold py-3 px-4 rounded-xl bg-accent-subtle-bg text-accent-text hover:bg-accent-subtle-bg/80 focus-ring transition",children:"Remembered"})]}):n.jsx("button",{onClick:()=>r(!0),className:"w-full btn-primary text-lg",children:"Show Answer"})})]})},Tn=({quizQuestion:e,onExit:t,onAnswer:s,remainingCount:a,cardKey:r})=>{const{item:i,quizType:o}=e;return n.jsxs("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center px-4",children:[n.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[n.jsxs("span",{className:"text-sm font-semibold text-text-muted px-3 py-1 bg-surface rounded-full",children:[a," to go"]}),n.jsx("button",{onClick:t,title:"Exit Review Session",className:"btn-ghost",children:n.jsx("i",{className:"bi bi-x-lg text-2xl"})})]}),o?n.jsx(Ee,{item:i,quizType:o,onComplete:c=>s(e,c)},r):n.jsx(In,{item:i,onAnswer:c=>s(e,c),cardKey:r},r)]})},Rn=({onContinue:e,onExit:t,hasMoreChunks:s,hasReviews:a})=>{const r=!s&&!a,i=r?"Session Complete!":"Chunk Complete!",o=r?"You've finished all learning and review items for now.":"Great work! You've learned this set of items.",c=r?"See Summary":"Continue";return n.jsxs("div",{className:"text-center py-16 px-6 max-w-lg mx-auto flex flex-col h-full justify-center",children:[n.jsx("i",{className:"bi bi-patch-check-fill text-6xl text-accent mx-auto mb-6","aria-hidden":"true"}),n.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:i}),n.jsx("p",{className:"mt-2 text-text-secondary",children:o}),n.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row items-center justify-center gap-4",children:[n.jsx("button",{onClick:t,className:"btn-secondary",children:"Finish for Now"}),n.jsx("button",{onClick:e,className:`btn-primary text-lg ${r?"px-8 py-3":""}`,children:c})]})]})},_n=({newCount:e,reviewCount:t,onStartLearning:s,onStartReviewing:a,onExit:r})=>{const i=e>0,o=t>0;return n.jsxs("div",{className:"text-center py-6 px-6 max-w-lg mx-auto flex flex-col h-full",children:[n.jsx("div",{className:"w-full flex justify-end mb-4",children:n.jsx("button",{"data-action":"review-exit",onClick:r,title:"Exit Review Session",className:"btn-ghost",children:n.jsx("i",{className:"bi bi-x-lg text-2xl"})})}),n.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center",children:[n.jsx("i",{className:"bi bi-play-circle text-6xl text-accent mx-auto mb-6","aria-hidden":"true"}),n.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Ready for your session?"}),n.jsxs("div",{className:"mt-8 flex flex-col gap-4 w-full max-w-xs",children:[i&&n.jsxs("button",{onClick:s,className:"btn-primary text-lg font-semibold px-8 py-3",children:["Learn ",e," new item",e>1?"s":""]}),o&&n.jsxs("button",{onClick:a,className:`${i?"btn-secondary":"btn-primary"} text-lg font-semibold px-8 py-3`,children:["Review ",t," due item",t>1?"s":""]})]})]})]})},ue=5,Mn=()=>{const{state:e,dispatch:t}=Oe(),{state:s}=ke(),{showConfirmation:a}=Me(),[r,i]=h.useState(0),[o,c]=h.useState("LOADING"),[l,u]=h.useState("STUDY"),[d,x]=h.useState({newItemsForSession:[],allDueReviewItems:[]}),[w,M]=h.useState([]),[T,A]=h.useState([]),[U,L]=h.useState(new Set),[S,P]=h.useState(0),[z,R]=h.useState(0),[D,g]=h.useState([]),[E,C]=h.useState({learned:0,reviewed:0}),X=h.useMemo(()=>{const m=e.reviewDeck.filter(b=>e.currentTextEntryId?b.textEntryId===e.currentTextEntryId||!b.textEntryId:!0).filter(b=>b.srsStage>0&&b.srsStage<9);if(m.length===0)return null;const p=m.map(b=>b.nextReviewDate);return Math.min(...p)},[e.reviewDeck,e.currentTextEntryId]),y=h.useCallback(()=>{const f=Date.now(),m=e.reviewDeck.filter(N=>e.currentTextEntryId?N.textEntryId===e.currentTextEntryId||!N.textEntryId:!0),p=m.filter(N=>N.srsStage===0).sort((N,$)=>N.addedAt-$.addedAt),b=m.filter(N=>N.srsStage>0&&N.nextReviewDate<=f).sort((N,$)=>N.nextReviewDate-$.nextReviewDate),j=p.slice(0,s.newWordsPerDay);x({newItemsForSession:j,allDueReviewItems:b});const v=[];for(let N=0;N<j.length;N+=ue)v.push(j.slice(N,N+ue));M(v),m.length===0?c("EMPTY"):j.length===0&&b.length===0?c("COMPLETE"):c("START")},[e.reviewDeck,e.currentTextEntryId,s.newWordsPerDay]);h.useEffect(()=>{(o==="LOADING"||o!=="LEARNING"&&o!=="REVIEW"&&o!=="MANAGE")&&(P(0),R(0),g([]),A([]),i(0),C({learned:0,reviewed:0}),u("STUDY"),y())},[o,y]),h.useEffect(()=>{o==="REVIEW"&&T.length===0&&E.reviewed>0&&y()},[T,o,E.reviewed,y]);const I=()=>{e.currentTextEntryId?t({type:"SET_VIEW",payload:Le.Reader}):t({type:"RESET_VIEW"})},Ae=()=>{w.length>0?c("LEARNING"):y()},ee=()=>{if(d.allDueReviewItems.length>0){L(new Set);const f=d.allDueReviewItems.map(m=>{let p;if(m.type==="word"){const b=["jp-en"];/[一-龯]/.test(m.content.japanese_segment)&&b.push("kanji-read"),p=b[Math.floor(Math.random()*b.length)]}return{item:m,quizType:p}});A(f),c("REVIEW")}else y()},Se=()=>{const f=w[S];if(f){const m=[];f.forEach(p=>{p.type==="word"?(m.push({item:p,quizType:"jp-en"}),/[一-龯]/.test(p.content.japanese_segment)&&m.push({item:p,quizType:"kanji-read"})):p.type==="grammar"&&m.push({item:p})}),g(m.sort(()=>.5-Math.random())),u("QUIZ")}},Ce=(f,m)=>{const p=[...D],b=p.shift();if(m||p.push(b),p.length===0){const j=w[S];j.forEach(v=>{const N=G(v,3);t({type:"ADD_OR_UPDATE_REVIEW_ITEM",payload:N})}),C(v=>({...v,learned:v.learned+j.length})),u("CHUNK_COMPLETE")}else g(p);i(j=>j+1)},Ie=()=>{S<w.length-1?(P(f=>f+1),R(0),u("STUDY")):d.allDueReviewItems.length>0?ee():y()},Te=f=>{const m=T[0];if(!m)return;const{item:p}=m;let b;if(typeof f=="boolean"?b=f?3:1:b=f,b===1){if(!U.has(p.id)){const j=G(p,b);t({type:"ADD_OR_UPDATE_REVIEW_ITEM",payload:j}),L(v=>new Set(v).add(p.id))}A(j=>[...j.slice(1),m])}else if(U.has(p.id))C(j=>({...j,reviewed:j.reviewed+1})),A(j=>j.slice(1));else{const j=G(p,b);t({type:"ADD_OR_UPDATE_REVIEW_ITEM",payload:j}),C(v=>({...v,reviewed:v.reviewed+1})),A(v=>v.slice(1))}i(j=>j+1)},Re=f=>{a("Are you sure you want to delete this item?",()=>{t({type:"REMOVE_REVIEW_ITEM",payload:f})},{confirmText:"Delete"})},te=h.useMemo(()=>e.history.find(f=>f.id===e.currentTextEntryId),[e.history,e.currentTextEntryId]);switch(o){case"LOADING":return n.jsx("div",{className:"p-6 text-center text-text-muted",children:"Loading review session..."});case"START":return n.jsx(_n,{newCount:d.newItemsForSession.length,reviewCount:d.allDueReviewItems.length,onStartLearning:Ae,onStartReviewing:ee,onExit:I});case"LEARNING":{const f=w[S];if(!f)return y(),null;switch(l){case"STUDY":return n.jsx(Cn,{item:f[z],onExit:I,currentIndex:z,totalInChunk:f.length,onNext:()=>R(m=>m+1),onPrev:()=>R(m=>m-1),onStartQuiz:Se});case"QUIZ":{const m=D[0];return m?n.jsx(Tn,{quizQuestion:m,onExit:I,onAnswer:Ce,remainingCount:D.length,cardKey:r}):null}case"CHUNK_COMPLETE":return n.jsx(Rn,{onContinue:Ie,onExit:I,hasMoreChunks:S<w.length-1,hasReviews:d.allDueReviewItems.length>0})}}case"REVIEW":{const f=T[0];return f?n.jsx(Nn,{item:f.item,quizType:f.quizType,onReview:Te,onExit:I,cardKey:r}):n.jsx("div",{className:"p-6 text-center text-text-muted",children:"Loading next review..."})}case"COMPLETE":{const f=d.newItemsForSession.length>0||d.allDueReviewItems.length>0;return n.jsx(vn,{learnedCount:E.learned,reviewedCount:E.reviewed,onManage:()=>c("MANAGE"),onExit:I,nextReviewTimestamp:X,hasMoreItems:f,onRestart:y})}case"EMPTY":return n.jsx(yn,{onManage:()=>c("MANAGE"),onExit:I});case"MANAGE":{const f=e.reviewDeck.filter(p=>e.currentTextEntryId?p.textEntryId===e.currentTextEntryId||!p.textEntryId:!0),m=e.currentTextEntryId&&te?`Deck for "${te.title}"`:"Full Review Deck";return n.jsx("div",{className:"flex-grow min-h-0 overflow-y-auto no-scrollbar",children:n.jsx(An,{items:f,onDelete:Re,onExit:y,title:m})})}default:return n.jsx("div",{className:"p-6 text-center text-text-muted",children:"An unexpected error occurred."})}};export{Mn as default};
